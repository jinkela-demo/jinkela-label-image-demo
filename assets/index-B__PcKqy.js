(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();/**
* @vue/shared v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Co(t){const e=Object.create(null);for(const i of t.split(","))e[i]=1;return i=>i in e}const se={},ni=[],Xe=()=>{},uc=()=>!1,ns=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Po=t=>t.startsWith("onUpdate:"),Te=Object.assign,To=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},Bu=Object.prototype.hasOwnProperty,ne=(t,e)=>Bu.call(t,e),Ht=Array.isArray,ri=t=>rs(t)==="[object Map]",Uu=t=>rs(t)==="[object Set]",qt=t=>typeof t=="function",ve=t=>typeof t=="string",nr=t=>typeof t=="symbol",fe=t=>t!==null&&typeof t=="object",hc=t=>(fe(t)||qt(t))&&qt(t.then)&&qt(t.catch),Ku=Object.prototype.toString,rs=t=>Ku.call(t),ju=t=>rs(t).slice(8,-1),Vu=t=>rs(t)==="[object Object]",Eo=t=>ve(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ii=Co(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),is=t=>{const e=Object.create(null);return(i=>e[i]||(e[i]=t(i)))},qu=/-\w/g,Pn=is(t=>t.replace(qu,e=>e.slice(1).toUpperCase())),Hu=/\B([A-Z])/g,Gn=is(t=>t.replace(Hu,"-$1").toLowerCase()),fc=is(t=>t.charAt(0).toUpperCase()+t.slice(1)),Vs=is(t=>t?`on${fc(t)}`:""),Cn=(t,e)=>!Object.is(t,e),qs=(t,...e)=>{for(let i=0;i<t.length;i++)t[i](...e)},dc=(t,e,i,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:i})},Wu=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Oa;const ss=()=>Oa||(Oa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ao(t){if(Ht(t)){const e={};for(let i=0;i<t.length;i++){const s=t[i],a=ve(s)?Qu(s):Ao(s);if(a)for(const o in a)e[o]=a[o]}return e}else if(ve(t)||fe(t))return t}const zu=/;(?![^(]*\))/g,Yu=/:([^]+)/,Xu=/\/\*[^]*?\*\//g;function Qu(t){const e={};return t.replace(Xu,"").split(zu).forEach(i=>{if(i){const s=i.split(Yu);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Ro(t){let e="";if(ve(t))e=t;else if(Ht(t))for(let i=0;i<t.length;i++){const s=Ro(t[i]);s&&(e+=s+" ")}else if(fe(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const Ju="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",$u=Co(Ju);function gc(t){return!!t||t===""}/**
* @vue/reactivity v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Fe;class Zu{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Fe,!e&&Fe&&(this.index=(Fe.scopes||(Fe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].pause();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].resume();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].resume()}}run(e){if(this._active){const i=Fe;try{return Fe=this,e()}finally{Fe=i}}}on(){++this._on===1&&(this.prevScope=Fe,Fe=this)}off(){this._on>0&&--this._on===0&&(Fe=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(this.effects.length=0,i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0}}}function th(){return Fe}let ie;const Hs=new WeakSet;class pc{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Fe&&Fe.active&&Fe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Hs.has(this)&&(Hs.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||yc(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ma(this),vc(this);const e=ie,i=Ue;ie=this,Ue=!0;try{return this.fn()}finally{_c(this),ie=e,Ue=i,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Mo(e);this.deps=this.depsTail=void 0,Ma(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Hs.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){co(this)&&this.run()}get dirty(){return co(this)}}let mc=0,si,oi;function yc(t,e=!1){if(t.flags|=8,e){t.next=oi,oi=t;return}t.next=si,si=t}function ko(){mc++}function Oo(){if(--mc>0)return;if(oi){let e=oi;for(oi=void 0;e;){const i=e.next;e.next=void 0,e.flags&=-9,e=i}}let t;for(;si;){let e=si;for(si=void 0;e;){const i=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=i}}if(t)throw t}function vc(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function _c(t){let e,i=t.depsTail,s=i;for(;s;){const a=s.prevDep;s.version===-1?(s===i&&(i=a),Mo(s),eh(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=a}t.deps=e,t.depsTail=i}function co(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(bc(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function bc(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ui)||(t.globalVersion=ui,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!co(t))))return;t.flags|=2;const e=t.dep,i=ie,s=Ue;ie=t,Ue=!0;try{vc(t);const a=t.fn(t._value);(e.version===0||Cn(a,t._value))&&(t.flags|=128,t._value=a,e.version++)}catch(a){throw e.version++,a}finally{ie=i,Ue=s,_c(t),t.flags&=-3}}function Mo(t,e=!1){const{dep:i,prevSub:s,nextSub:a}=t;if(s&&(s.nextSub=a,t.prevSub=void 0),a&&(a.prevSub=s,t.nextSub=void 0),i.subs===t&&(i.subs=s,!s&&i.computed)){i.computed.flags&=-5;for(let o=i.computed.deps;o;o=o.nextDep)Mo(o,!0)}!e&&!--i.sc&&i.map&&i.map.delete(i.key)}function eh(t){const{prevDep:e,nextDep:i}=t;e&&(e.nextDep=i,t.prevDep=void 0),i&&(i.prevDep=e,t.nextDep=void 0)}let Ue=!0;const wc=[];function on(){wc.push(Ue),Ue=!1}function an(){const t=wc.pop();Ue=t===void 0?!0:t}function Ma(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const i=ie;ie=void 0;try{e()}finally{ie=i}}}let ui=0;class nh{constructor(e,i){this.sub=e,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Fo{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ie||!Ue||ie===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==ie)i=this.activeLink=new nh(ie,this),ie.deps?(i.prevDep=ie.depsTail,ie.depsTail.nextDep=i,ie.depsTail=i):ie.deps=ie.depsTail=i,Sc(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const s=i.nextDep;s.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=s),i.prevDep=ie.depsTail,i.nextDep=void 0,ie.depsTail.nextDep=i,ie.depsTail=i,ie.deps===i&&(ie.deps=s)}return i}trigger(e){this.version++,ui++,this.notify(e)}notify(e){ko();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{Oo()}}}function Sc(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Sc(s)}const i=t.dep.subs;i!==t&&(t.prevSub=i,i&&(i.nextSub=t)),t.dep.subs=t}}const uo=new WeakMap,Ln=Symbol(""),ho=Symbol(""),hi=Symbol("");function Ce(t,e,i){if(Ue&&ie){let s=uo.get(t);s||uo.set(t,s=new Map);let a=s.get(i);a||(s.set(i,a=new Fo),a.map=s,a.key=i),a.track()}}function sn(t,e,i,s,a,o){const c=uo.get(t);if(!c){ui++;return}const l=h=>{h&&h.trigger()};if(ko(),e==="clear")c.forEach(l);else{const h=Ht(t),g=h&&Eo(i);if(h&&i==="length"){const d=Number(s);c.forEach((b,_)=>{(_==="length"||_===hi||!nr(_)&&_>=d)&&l(b)})}else switch((i!==void 0||c.has(void 0))&&l(c.get(i)),g&&l(c.get(hi)),e){case"add":h?g&&l(c.get("length")):(l(c.get(Ln)),ri(t)&&l(c.get(ho)));break;case"delete":h||(l(c.get(Ln)),ri(t)&&l(c.get(ho)));break;case"set":ri(t)&&l(c.get(Ln));break}}Oo()}function zn(t){const e=ee(t);return e===t?e:(Ce(e,"iterate",hi),Ke(t)?e:e.map(ln))}function Io(t){return Ce(t=ee(t),"iterate",hi),t}function _n(t,e){return Tn(t)?Jn(t)?fi(ln(e)):fi(e):ln(e)}const rh={__proto__:null,[Symbol.iterator](){return Ws(this,Symbol.iterator,t=>_n(this,t))},concat(...t){return zn(this).concat(...t.map(e=>Ht(e)?zn(e):e))},entries(){return Ws(this,"entries",t=>(t[1]=_n(this,t[1]),t))},every(t,e){return Ze(this,"every",t,e,void 0,arguments)},filter(t,e){return Ze(this,"filter",t,e,i=>i.map(s=>_n(this,s)),arguments)},find(t,e){return Ze(this,"find",t,e,i=>_n(this,i),arguments)},findIndex(t,e){return Ze(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ze(this,"findLast",t,e,i=>_n(this,i),arguments)},findLastIndex(t,e){return Ze(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ze(this,"forEach",t,e,void 0,arguments)},includes(...t){return zs(this,"includes",t)},indexOf(...t){return zs(this,"indexOf",t)},join(t){return zn(this).join(t)},lastIndexOf(...t){return zs(this,"lastIndexOf",t)},map(t,e){return Ze(this,"map",t,e,void 0,arguments)},pop(){return fr(this,"pop")},push(...t){return fr(this,"push",t)},reduce(t,...e){return Fa(this,"reduce",t,e)},reduceRight(t,...e){return Fa(this,"reduceRight",t,e)},shift(){return fr(this,"shift")},some(t,e){return Ze(this,"some",t,e,void 0,arguments)},splice(...t){return fr(this,"splice",t)},toReversed(){return zn(this).toReversed()},toSorted(t){return zn(this).toSorted(t)},toSpliced(...t){return zn(this).toSpliced(...t)},unshift(...t){return fr(this,"unshift",t)},values(){return Ws(this,"values",t=>_n(this,t))}};function Ws(t,e,i){const s=Io(t),a=s[e]();return s!==t&&!Ke(t)&&(a._next=a.next,a.next=()=>{const o=a._next();return o.done||(o.value=i(o.value)),o}),a}const ih=Array.prototype;function Ze(t,e,i,s,a,o){const c=Io(t),l=c!==t&&!Ke(t),h=c[e];if(h!==ih[e]){const b=h.apply(t,o);return l?ln(b):b}let g=i;c!==t&&(l?g=function(b,_){return i.call(this,_n(t,b),_,t)}:i.length>2&&(g=function(b,_){return i.call(this,b,_,t)}));const d=h.call(c,g,s);return l&&a?a(d):d}function Fa(t,e,i,s){const a=Io(t);let o=i;return a!==t&&(Ke(t)?i.length>3&&(o=function(c,l,h){return i.call(this,c,l,h,t)}):o=function(c,l,h){return i.call(this,c,_n(t,l),h,t)}),a[e](o,...s)}function zs(t,e,i){const s=ee(t);Ce(s,"iterate",hi);const a=s[e](...i);return(a===-1||a===!1)&&Go(i[0])?(i[0]=ee(i[0]),s[e](...i)):a}function fr(t,e,i=[]){on(),ko();const s=ee(t)[e].apply(t,i);return Oo(),an(),s}const sh=Co("__proto__,__v_isRef,__isVue"),xc=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(nr));function oh(t){nr(t)||(t=String(t));const e=ee(this);return Ce(e,"has",t),e.hasOwnProperty(t)}class Cc{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,s){if(i==="__v_skip")return e.__v_skip;const a=this._isReadonly,o=this._isShallow;if(i==="__v_isReactive")return!a;if(i==="__v_isReadonly")return a;if(i==="__v_isShallow")return o;if(i==="__v_raw")return s===(a?o?mh:Ac:o?Ec:Tc).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const c=Ht(e);if(!a){let h;if(c&&(h=rh[i]))return h;if(i==="hasOwnProperty")return oh}const l=Reflect.get(e,i,Pe(e)?e:s);if((nr(i)?xc.has(i):sh(i))||(a||Ce(e,"get",i),o))return l;if(Pe(l)){const h=c&&Eo(i)?l:l.value;return a&&fe(h)?go(h):h}return fe(l)?a?go(l):Do(l):l}}class Pc extends Cc{constructor(e=!1){super(!1,e)}set(e,i,s,a){let o=e[i];const c=Ht(e)&&Eo(i);if(!this._isShallow){const g=Tn(o);if(!Ke(s)&&!Tn(s)&&(o=ee(o),s=ee(s)),!c&&Pe(o)&&!Pe(s))return g||(o.value=s),!0}const l=c?Number(i)<e.length:ne(e,i),h=Reflect.set(e,i,s,Pe(e)?e:a);return e===ee(a)&&(l?Cn(s,o)&&sn(e,"set",i,s):sn(e,"add",i,s)),h}deleteProperty(e,i){const s=ne(e,i);e[i];const a=Reflect.deleteProperty(e,i);return a&&s&&sn(e,"delete",i,void 0),a}has(e,i){const s=Reflect.has(e,i);return(!nr(i)||!xc.has(i))&&Ce(e,"has",i),s}ownKeys(e){return Ce(e,"iterate",Ht(e)?"length":Ln),Reflect.ownKeys(e)}}class ah extends Cc{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const lh=new Pc,ch=new ah,uh=new Pc(!0);const fo=t=>t,Ki=t=>Reflect.getPrototypeOf(t);function hh(t,e,i){return function(...s){const a=this.__v_raw,o=ee(a),c=ri(o),l=t==="entries"||t===Symbol.iterator&&c,h=t==="keys"&&c,g=a[t](...s),d=i?fo:e?fi:ln;return!e&&Ce(o,"iterate",h?ho:Ln),{next(){const{value:b,done:_}=g.next();return _?{value:b,done:_}:{value:l?[d(b[0]),d(b[1])]:d(b),done:_}},[Symbol.iterator](){return this}}}}function ji(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function fh(t,e){const i={get(a){const o=this.__v_raw,c=ee(o),l=ee(a);t||(Cn(a,l)&&Ce(c,"get",a),Ce(c,"get",l));const{has:h}=Ki(c),g=e?fo:t?fi:ln;if(h.call(c,a))return g(o.get(a));if(h.call(c,l))return g(o.get(l));o!==c&&o.get(a)},get size(){const a=this.__v_raw;return!t&&Ce(ee(a),"iterate",Ln),a.size},has(a){const o=this.__v_raw,c=ee(o),l=ee(a);return t||(Cn(a,l)&&Ce(c,"has",a),Ce(c,"has",l)),a===l?o.has(a):o.has(a)||o.has(l)},forEach(a,o){const c=this,l=c.__v_raw,h=ee(l),g=e?fo:t?fi:ln;return!t&&Ce(h,"iterate",Ln),l.forEach((d,b)=>a.call(o,g(d),g(b),c))}};return Te(i,t?{add:ji("add"),set:ji("set"),delete:ji("delete"),clear:ji("clear")}:{add(a){!e&&!Ke(a)&&!Tn(a)&&(a=ee(a));const o=ee(this);return Ki(o).has.call(o,a)||(o.add(a),sn(o,"add",a,a)),this},set(a,o){!e&&!Ke(o)&&!Tn(o)&&(o=ee(o));const c=ee(this),{has:l,get:h}=Ki(c);let g=l.call(c,a);g||(a=ee(a),g=l.call(c,a));const d=h.call(c,a);return c.set(a,o),g?Cn(o,d)&&sn(c,"set",a,o):sn(c,"add",a,o),this},delete(a){const o=ee(this),{has:c,get:l}=Ki(o);let h=c.call(o,a);h||(a=ee(a),h=c.call(o,a)),l&&l.call(o,a);const g=o.delete(a);return h&&sn(o,"delete",a,void 0),g},clear(){const a=ee(this),o=a.size!==0,c=a.clear();return o&&sn(a,"clear",void 0,void 0),c}}),["keys","values","entries",Symbol.iterator].forEach(a=>{i[a]=hh(a,t,e)}),i}function No(t,e){const i=fh(t,e);return(s,a,o)=>a==="__v_isReactive"?!t:a==="__v_isReadonly"?t:a==="__v_raw"?s:Reflect.get(ne(i,a)&&a in s?i:s,a,o)}const dh={get:No(!1,!1)},gh={get:No(!1,!0)},ph={get:No(!0,!1)};const Tc=new WeakMap,Ec=new WeakMap,Ac=new WeakMap,mh=new WeakMap;function yh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function vh(t){return t.__v_skip||!Object.isExtensible(t)?0:yh(ju(t))}function Do(t){return Tn(t)?t:Lo(t,!1,lh,dh,Tc)}function _h(t){return Lo(t,!1,uh,gh,Ec)}function go(t){return Lo(t,!0,ch,ph,Ac)}function Lo(t,e,i,s,a){if(!fe(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const o=vh(t);if(o===0)return t;const c=a.get(t);if(c)return c;const l=new Proxy(t,o===2?s:i);return a.set(t,l),l}function Jn(t){return Tn(t)?Jn(t.__v_raw):!!(t&&t.__v_isReactive)}function Tn(t){return!!(t&&t.__v_isReadonly)}function Ke(t){return!!(t&&t.__v_isShallow)}function Go(t){return t?!!t.__v_raw:!1}function ee(t){const e=t&&t.__v_raw;return e?ee(e):t}function bh(t){return!ne(t,"__v_skip")&&Object.isExtensible(t)&&dc(t,"__v_skip",!0),t}const ln=t=>fe(t)?Do(t):t,fi=t=>fe(t)?go(t):t;function Pe(t){return t?t.__v_isRef===!0:!1}function be(t){return wh(t,!1)}function wh(t,e){return Pe(t)?t:new Sh(t,e)}class Sh{constructor(e,i){this.dep=new Fo,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?e:ee(e),this._value=i?e:ln(e),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(e){const i=this._rawValue,s=this.__v_isShallow||Ke(e)||Tn(e);e=s?e:ee(e),Cn(e,i)&&(this._rawValue=e,this._value=s?e:ln(e),this.dep.trigger())}}function xh(t){return Pe(t)?t.value:t}const Ch={get:(t,e,i)=>e==="__v_raw"?t:xh(Reflect.get(t,e,i)),set:(t,e,i,s)=>{const a=t[e];return Pe(a)&&!Pe(i)?(a.value=i,!0):Reflect.set(t,e,i,s)}};function Rc(t){return Jn(t)?t:new Proxy(t,Ch)}class Ph{constructor(e,i,s){this.fn=e,this.setter=i,this._value=void 0,this.dep=new Fo(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ui-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&ie!==this)return yc(this,!0),!0}get value(){const e=this.dep.track();return bc(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Th(t,e,i=!1){let s,a;return qt(t)?s=t:(s=t.get,a=t.set),new Ph(s,a,i)}const Vi={},Xi=new WeakMap;let Dn;function Eh(t,e=!1,i=Dn){if(i){let s=Xi.get(i);s||Xi.set(i,s=[]),s.push(t)}}function Ah(t,e,i=se){const{immediate:s,deep:a,once:o,scheduler:c,augmentJob:l,call:h}=i,g=w=>a?w:Ke(w)||a===!1||a===0?Sn(w,1):Sn(w);let d,b,_,p,v=!1,S=!1;if(Pe(t)?(b=()=>t.value,v=Ke(t)):Jn(t)?(b=()=>g(t),v=!0):Ht(t)?(S=!0,v=t.some(w=>Jn(w)||Ke(w)),b=()=>t.map(w=>{if(Pe(w))return w.value;if(Jn(w))return g(w);if(qt(w))return h?h(w,2):w()})):qt(t)?e?b=h?()=>h(t,2):t:b=()=>{if(_){on();try{_()}finally{an()}}const w=Dn;Dn=d;try{return h?h(t,3,[p]):t(p)}finally{Dn=w}}:b=Xe,e&&a){const w=b,P=a===!0?1/0:a;b=()=>Sn(w(),P)}const E=th(),O=()=>{d.stop(),E&&E.active&&To(E.effects,d)};if(o&&e){const w=e;e=(...P)=>{w(...P),O()}}let y=S?new Array(t.length).fill(Vi):Vi;const f=w=>{if(!(!(d.flags&1)||!d.dirty&&!w))if(e){const P=d.run();if(a||v||(S?P.some((I,q)=>Cn(I,y[q])):Cn(P,y))){_&&_();const I=Dn;Dn=d;try{const q=[P,y===Vi?void 0:S&&y[0]===Vi?[]:y,p];y=P,h?h(e,3,q):e(...q)}finally{Dn=I}}}else d.run()};return l&&l(f),d=new pc(b),d.scheduler=c?()=>c(f,!1):f,p=w=>Eh(w,!1,d),_=d.onStop=()=>{const w=Xi.get(d);if(w){if(h)h(w,4);else for(const P of w)P();Xi.delete(d)}},e?s?f(!0):y=d.run():c?c(f.bind(null,!0),!0):d.run(),O.pause=d.pause.bind(d),O.resume=d.resume.bind(d),O.stop=O,O}function Sn(t,e=1/0,i){if(e<=0||!fe(t)||t.__v_skip||(i=i||new Map,(i.get(t)||0)>=e))return t;if(i.set(t,e),e--,Pe(t))Sn(t.value,e,i);else if(Ht(t))for(let s=0;s<t.length;s++)Sn(t[s],e,i);else if(Uu(t)||ri(t))t.forEach(s=>{Sn(s,e,i)});else if(Vu(t)){for(const s in t)Sn(t[s],e,i);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Sn(t[s],e,i)}return t}/**
* @vue/runtime-core v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function pi(t,e,i,s){try{return s?t(...s):t()}catch(a){os(a,e,i)}}function Qe(t,e,i,s){if(qt(t)){const a=pi(t,e,i,s);return a&&hc(a)&&a.catch(o=>{os(o,e,i)}),a}if(Ht(t)){const a=[];for(let o=0;o<t.length;o++)a.push(Qe(t[o],e,i,s));return a}}function os(t,e,i,s=!0){const a=e?e.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:c}=e&&e.appContext.config||se;if(e){let l=e.parent;const h=e.proxy,g=`https://vuejs.org/error-reference/#runtime-${i}`;for(;l;){const d=l.ec;if(d){for(let b=0;b<d.length;b++)if(d[b](t,h,g)===!1)return}l=l.parent}if(o){on(),pi(o,null,10,[t,h,g]),an();return}}Rh(t,i,a,s,c)}function Rh(t,e,i,s=!0,a=!1){if(a)throw t;console.error(t)}const Re=[];let We=-1;const $n=[];let bn=null,Xn=0;const kc=Promise.resolve();let Qi=null;function kh(t){const e=Qi||kc;return t?e.then(this?t.bind(this):t):e}function Oh(t){let e=We+1,i=Re.length;for(;e<i;){const s=e+i>>>1,a=Re[s],o=di(a);o<t||o===t&&a.flags&2?e=s+1:i=s}return e}function Bo(t){if(!(t.flags&1)){const e=di(t),i=Re[Re.length-1];!i||!(t.flags&2)&&e>=di(i)?Re.push(t):Re.splice(Oh(e),0,t),t.flags|=1,Oc()}}function Oc(){Qi||(Qi=kc.then(Fc))}function Mh(t){Ht(t)?$n.push(...t):bn&&t.id===-1?bn.splice(Xn+1,0,t):t.flags&1||($n.push(t),t.flags|=1),Oc()}function Ia(t,e,i=We+1){for(;i<Re.length;i++){const s=Re[i];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Re.splice(i,1),i--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Mc(t){if($n.length){const e=[...new Set($n)].sort((i,s)=>di(i)-di(s));if($n.length=0,bn){bn.push(...e);return}for(bn=e,Xn=0;Xn<bn.length;Xn++){const i=bn[Xn];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}bn=null,Xn=0}}const di=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Fc(t){try{for(We=0;We<Re.length;We++){const e=Re[We];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),pi(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;We<Re.length;We++){const e=Re[We];e&&(e.flags&=-2)}We=-1,Re.length=0,Mc(),Qi=null,(Re.length||$n.length)&&Fc()}}let Ye=null,Ic=null;function Ji(t){const e=Ye;return Ye=t,Ic=t&&t.type.__scopeId||null,e}function Fh(t,e=Ye,i){if(!e||t._n)return t;const s=(...a)=>{s._d&&qa(-1);const o=Ji(e);let c;try{c=t(...a)}finally{Ji(o),s._d&&qa(1)}return c};return s._n=!0,s._c=!0,s._d=!0,s}function Fn(t,e,i,s){const a=t.dirs,o=e&&e.dirs;for(let c=0;c<a.length;c++){const l=a[c];o&&(l.oldValue=o[c].value);let h=l.dir[s];h&&(on(),Qe(h,i,8,[t.el,l,t,e]),an())}}const Ih=Symbol("_vte"),Nh=t=>t.__isTeleport,Dh=Symbol("_leaveCb");function Uo(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Uo(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Lh(t,e){return qt(t)?Te({name:t.name},e,{setup:t}):t}function Nc(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const $i=new WeakMap;function ai(t,e,i,s,a=!1){if(Ht(t)){t.forEach((v,S)=>ai(v,e&&(Ht(e)?e[S]:e),i,s,a));return}if(li(s)&&!a){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&ai(t,e,i,s.component.subTree);return}const o=s.shapeFlag&4?zo(s.component):s.el,c=a?null:o,{i:l,r:h}=t,g=e&&e.r,d=l.refs===se?l.refs={}:l.refs,b=l.setupState,_=ee(b),p=b===se?uc:v=>ne(_,v);if(g!=null&&g!==h){if(Na(e),ve(g))d[g]=null,p(g)&&(b[g]=null);else if(Pe(g)){g.value=null;const v=e;v.k&&(d[v.k]=null)}}if(qt(h))pi(h,l,12,[c,d]);else{const v=ve(h),S=Pe(h);if(v||S){const E=()=>{if(t.f){const O=v?p(h)?b[h]:d[h]:h.value;if(a)Ht(O)&&To(O,o);else if(Ht(O))O.includes(o)||O.push(o);else if(v)d[h]=[o],p(h)&&(b[h]=d[h]);else{const y=[o];h.value=y,t.k&&(d[t.k]=y)}}else v?(d[h]=c,p(h)&&(b[h]=c)):S&&(h.value=c,t.k&&(d[t.k]=c))};if(c){const O=()=>{E(),$i.delete(t)};O.id=-1,$i.set(t,O),Le(O,i)}else Na(t),E()}}}function Na(t){const e=$i.get(t);e&&(e.flags|=8,$i.delete(t))}ss().requestIdleCallback;ss().cancelIdleCallback;const li=t=>!!t.type.__asyncLoader,Dc=t=>t.type.__isKeepAlive;function Gh(t,e){Lc(t,"a",e)}function Bh(t,e){Lc(t,"da",e)}function Lc(t,e,i=ke){const s=t.__wdc||(t.__wdc=()=>{let a=i;for(;a;){if(a.isDeactivated)return;a=a.parent}return t()});if(as(e,s,i),i){let a=i.parent;for(;a&&a.parent;)Dc(a.parent.vnode)&&Uh(s,e,i,a),a=a.parent}}function Uh(t,e,i,s){const a=as(e,t,s,!0);Ko(()=>{To(s[e],a)},i)}function as(t,e,i=ke,s=!1){if(i){const a=i[t]||(i[t]=[]),o=e.__weh||(e.__weh=(...c)=>{on();const l=mi(i),h=Qe(e,i,t,c);return l(),an(),h});return s?a.unshift(o):a.push(o),o}}const cn=t=>(e,i=ke)=>{(!gi||t==="sp")&&as(t,(...s)=>e(...s),i)},Kh=cn("bm"),Gc=cn("m"),jh=cn("bu"),Vh=cn("u"),qh=cn("bum"),Ko=cn("um"),Hh=cn("sp"),Wh=cn("rtg"),zh=cn("rtc");function Yh(t,e=ke){as("ec",t,e)}const Xh=Symbol.for("v-ndc"),po=t=>t?iu(t)?zo(t):po(t.parent):null,ci=Te(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>po(t.parent),$root:t=>po(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Uc(t),$forceUpdate:t=>t.f||(t.f=()=>{Bo(t.update)}),$nextTick:t=>t.n||(t.n=kh.bind(t.proxy)),$watch:t=>cf.bind(t)}),Ys=(t,e)=>t!==se&&!t.__isScriptSetup&&ne(t,e),Qh={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:s,data:a,props:o,accessCache:c,type:l,appContext:h}=t;if(e[0]!=="$"){const _=c[e];if(_!==void 0)switch(_){case 1:return s[e];case 2:return a[e];case 4:return i[e];case 3:return o[e]}else{if(Ys(s,e))return c[e]=1,s[e];if(a!==se&&ne(a,e))return c[e]=2,a[e];if(ne(o,e))return c[e]=3,o[e];if(i!==se&&ne(i,e))return c[e]=4,i[e];mo&&(c[e]=0)}}const g=ci[e];let d,b;if(g)return e==="$attrs"&&Ce(t.attrs,"get",""),g(t);if((d=l.__cssModules)&&(d=d[e]))return d;if(i!==se&&ne(i,e))return c[e]=4,i[e];if(b=h.config.globalProperties,ne(b,e))return b[e]},set({_:t},e,i){const{data:s,setupState:a,ctx:o}=t;return Ys(a,e)?(a[e]=i,!0):s!==se&&ne(s,e)?(s[e]=i,!0):ne(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(o[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:s,appContext:a,props:o,type:c}},l){let h;return!!(i[l]||t!==se&&l[0]!=="$"&&ne(t,l)||Ys(e,l)||ne(o,l)||ne(s,l)||ne(ci,l)||ne(a.config.globalProperties,l)||(h=c.__cssModules)&&h[l])},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:ne(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};function Da(t){return Ht(t)?t.reduce((e,i)=>(e[i]=null,e),{}):t}let mo=!0;function Jh(t){const e=Uc(t),i=t.proxy,s=t.ctx;mo=!1,e.beforeCreate&&La(e.beforeCreate,t,"bc");const{data:a,computed:o,methods:c,watch:l,provide:h,inject:g,created:d,beforeMount:b,mounted:_,beforeUpdate:p,updated:v,activated:S,deactivated:E,beforeDestroy:O,beforeUnmount:y,destroyed:f,unmounted:w,render:P,renderTracked:I,renderTriggered:q,errorCaptured:A,serverPrefetch:k,expose:F,inheritAttrs:M,components:K,directives:W,filters:J}=e;if(g&&$h(g,s,null),c)for(const C in c){const R=c[C];qt(R)&&(s[C]=R.bind(i))}if(a){const C=a.call(i,i);fe(C)&&(t.data=Do(C))}if(mo=!0,o)for(const C in o){const R=o[C],G=qt(R)?R.bind(i,i):qt(R.get)?R.get.bind(i,i):Xe,L=!qt(R)&&qt(R.set)?R.set.bind(i):Xe,j=Kf({get:G,set:L});Object.defineProperty(s,C,{enumerable:!0,configurable:!0,get:()=>j.value,set:ct=>j.value=ct})}if(l)for(const C in l)Bc(l[C],s,i,C);if(h){const C=qt(h)?h.call(i):h;Reflect.ownKeys(C).forEach(R=>{sf(R,C[R])})}d&&La(d,t,"c");function ft(C,R){Ht(R)?R.forEach(G=>C(G.bind(i))):R&&C(R.bind(i))}if(ft(Kh,b),ft(Gc,_),ft(jh,p),ft(Vh,v),ft(Gh,S),ft(Bh,E),ft(Yh,A),ft(zh,I),ft(Wh,q),ft(qh,y),ft(Ko,w),ft(Hh,k),Ht(F))if(F.length){const C=t.exposed||(t.exposed={});F.forEach(R=>{Object.defineProperty(C,R,{get:()=>i[R],set:G=>i[R]=G,enumerable:!0})})}else t.exposed||(t.exposed={});P&&t.render===Xe&&(t.render=P),M!=null&&(t.inheritAttrs=M),K&&(t.components=K),W&&(t.directives=W),k&&Nc(t)}function $h(t,e,i=Xe){Ht(t)&&(t=yo(t));for(const s in t){const a=t[s];let o;fe(a)?"default"in a?o=qi(a.from||s,a.default,!0):o=qi(a.from||s):o=qi(a),Pe(o)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:c=>o.value=c}):e[s]=o}}function La(t,e,i){Qe(Ht(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,i)}function Bc(t,e,i,s){let a=s.includes(".")?jc(i,s):()=>i[s];if(ve(t)){const o=e[t];qt(o)&&Xs(a,o)}else if(qt(t))Xs(a,t.bind(i));else if(fe(t))if(Ht(t))t.forEach(o=>Bc(o,e,i,s));else{const o=qt(t.handler)?t.handler.bind(i):e[t.handler];qt(o)&&Xs(a,o,t)}}function Uc(t){const e=t.type,{mixins:i,extends:s}=e,{mixins:a,optionsCache:o,config:{optionMergeStrategies:c}}=t.appContext,l=o.get(e);let h;return l?h=l:!a.length&&!i&&!s?h=e:(h={},a.length&&a.forEach(g=>Zi(h,g,c,!0)),Zi(h,e,c)),fe(e)&&o.set(e,h),h}function Zi(t,e,i,s=!1){const{mixins:a,extends:o}=e;o&&Zi(t,o,i,!0),a&&a.forEach(c=>Zi(t,c,i,!0));for(const c in e)if(!(s&&c==="expose")){const l=Zh[c]||i&&i[c];t[c]=l?l(t[c],e[c]):e[c]}return t}const Zh={data:Ga,props:Ba,emits:Ba,methods:ei,computed:ei,beforeCreate:Ae,created:Ae,beforeMount:Ae,mounted:Ae,beforeUpdate:Ae,updated:Ae,beforeDestroy:Ae,beforeUnmount:Ae,destroyed:Ae,unmounted:Ae,activated:Ae,deactivated:Ae,errorCaptured:Ae,serverPrefetch:Ae,components:ei,directives:ei,watch:ef,provide:Ga,inject:tf};function Ga(t,e){return e?t?function(){return Te(qt(t)?t.call(this,this):t,qt(e)?e.call(this,this):e)}:e:t}function tf(t,e){return ei(yo(t),yo(e))}function yo(t){if(Ht(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function Ae(t,e){return t?[...new Set([].concat(t,e))]:e}function ei(t,e){return t?Te(Object.create(null),t,e):e}function Ba(t,e){return t?Ht(t)&&Ht(e)?[...new Set([...t,...e])]:Te(Object.create(null),Da(t),Da(e??{})):e}function ef(t,e){if(!t)return e;if(!e)return t;const i=Te(Object.create(null),t);for(const s in e)i[s]=Ae(t[s],e[s]);return i}function Kc(){return{app:null,config:{isNativeTag:uc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nf=0;function rf(t,e){return function(s,a=null){qt(s)||(s=Te({},s)),a!=null&&!fe(a)&&(a=null);const o=Kc(),c=new WeakSet,l=[];let h=!1;const g=o.app={_uid:nf++,_component:s,_props:a,_container:null,_context:o,_instance:null,version:jf,get config(){return o.config},set config(d){},use(d,...b){return c.has(d)||(d&&qt(d.install)?(c.add(d),d.install(g,...b)):qt(d)&&(c.add(d),d(g,...b))),g},mixin(d){return o.mixins.includes(d)||o.mixins.push(d),g},component(d,b){return b?(o.components[d]=b,g):o.components[d]},directive(d,b){return b?(o.directives[d]=b,g):o.directives[d]},mount(d,b,_){if(!h){const p=g._ceVNode||pe(s,a);return p.appContext=o,_===!0?_="svg":_===!1&&(_=void 0),t(p,d,_),h=!0,g._container=d,d.__vue_app__=g,zo(p.component)}},onUnmount(d){l.push(d)},unmount(){h&&(Qe(l,g._instance,16),t(null,g._container),delete g._container.__vue_app__)},provide(d,b){return o.provides[d]=b,g},runWithContext(d){const b=Zn;Zn=g;try{return d()}finally{Zn=b}}};return g}}let Zn=null;function sf(t,e){if(ke){let i=ke.provides;const s=ke.parent&&ke.parent.provides;s===i&&(i=ke.provides=Object.create(s)),i[t]=e}}function qi(t,e,i=!1){const s=Nf();if(s||Zn){let a=Zn?Zn._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(a&&t in a)return a[t];if(arguments.length>1)return i&&qt(e)?e.call(s&&s.proxy):e}}const of=Symbol.for("v-scx"),af=()=>qi(of);function lf(t,e){return jo(t,null,e)}function Xs(t,e,i){return jo(t,e,i)}function jo(t,e,i=se){const{immediate:s,deep:a,flush:o,once:c}=i,l=Te({},i),h=e&&s||!e&&o!=="post";let g;if(gi){if(o==="sync"){const p=af();g=p.__watcherHandles||(p.__watcherHandles=[])}else if(!h){const p=()=>{};return p.stop=Xe,p.resume=Xe,p.pause=Xe,p}}const d=ke;l.call=(p,v,S)=>Qe(p,d,v,S);let b=!1;o==="post"?l.scheduler=p=>{Le(p,d&&d.suspense)}:o!=="sync"&&(b=!0,l.scheduler=(p,v)=>{v?p():Bo(p)}),l.augmentJob=p=>{e&&(p.flags|=4),b&&(p.flags|=2,d&&(p.id=d.uid,p.i=d))};const _=Ah(t,e,l);return gi&&(g?g.push(_):h&&_()),_}function cf(t,e,i){const s=this.proxy,a=ve(t)?t.includes(".")?jc(s,t):()=>s[t]:t.bind(s,s);let o;qt(e)?o=e:(o=e.handler,i=e);const c=mi(this),l=jo(a,o.bind(s),i);return c(),l}function jc(t,e){const i=e.split(".");return()=>{let s=t;for(let a=0;a<i.length&&s;a++)s=s[i[a]];return s}}const uf=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Pn(e)}Modifiers`]||t[`${Gn(e)}Modifiers`];function hf(t,e,...i){if(t.isUnmounted)return;const s=t.vnode.props||se;let a=i;const o=e.startsWith("update:"),c=o&&uf(s,e.slice(7));c&&(c.trim&&(a=i.map(d=>ve(d)?d.trim():d)),c.number&&(a=i.map(Wu)));let l,h=s[l=Vs(e)]||s[l=Vs(Pn(e))];!h&&o&&(h=s[l=Vs(Gn(e))]),h&&Qe(h,t,6,a);const g=s[l+"Once"];if(g){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,Qe(g,t,6,a)}}const ff=new WeakMap;function Vc(t,e,i=!1){const s=i?ff:e.emitsCache,a=s.get(t);if(a!==void 0)return a;const o=t.emits;let c={},l=!1;if(!qt(t)){const h=g=>{const d=Vc(g,e,!0);d&&(l=!0,Te(c,d))};!i&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}return!o&&!l?(fe(t)&&s.set(t,null),null):(Ht(o)?o.forEach(h=>c[h]=null):Te(c,o),fe(t)&&s.set(t,c),c)}function ls(t,e){return!t||!ns(e)?!1:(e=e.slice(2).replace(/Once$/,""),ne(t,e[0].toLowerCase()+e.slice(1))||ne(t,Gn(e))||ne(t,e))}function Ua(t){const{type:e,vnode:i,proxy:s,withProxy:a,propsOptions:[o],slots:c,attrs:l,emit:h,render:g,renderCache:d,props:b,data:_,setupState:p,ctx:v,inheritAttrs:S}=t,E=Ji(t);let O,y;try{if(i.shapeFlag&4){const w=a||s,P=w;O=ze(g.call(P,w,d,b,p,_,v)),y=l}else{const w=e;O=ze(w.length>1?w(b,{attrs:l,slots:c,emit:h}):w(b,null)),y=e.props?l:df(l)}}catch(w){os(w,t,1),O=pe(tr)}let f=O;if(y&&S!==!1){const w=Object.keys(y),{shapeFlag:P}=f;w.length&&P&7&&(o&&w.some(Po)&&(y=gf(y,o)),f=er(f,y,!1,!0))}return i.dirs&&(f=er(f,null,!1,!0),f.dirs=f.dirs?f.dirs.concat(i.dirs):i.dirs),i.transition&&Uo(f,i.transition),O=f,Ji(E),O}const df=t=>{let e;for(const i in t)(i==="class"||i==="style"||ns(i))&&((e||(e={}))[i]=t[i]);return e},gf=(t,e)=>{const i={};for(const s in t)(!Po(s)||!(s.slice(9)in e))&&(i[s]=t[s]);return i};function pf(t,e,i){const{props:s,children:a,component:o}=t,{props:c,children:l,patchFlag:h}=e,g=o.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&h>=0){if(h&1024)return!0;if(h&16)return s?Ka(s,c,g):!!c;if(h&8){const d=e.dynamicProps;for(let b=0;b<d.length;b++){const _=d[b];if(c[_]!==s[_]&&!ls(g,_))return!0}}}else return(a||l)&&(!l||!l.$stable)?!0:s===c?!1:s?c?Ka(s,c,g):!0:!!c;return!1}function Ka(t,e,i){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let a=0;a<s.length;a++){const o=s[a];if(e[o]!==t[o]&&!ls(i,o))return!0}return!1}function mf({vnode:t,parent:e},i){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=i,e=e.parent;else break}}const qc={},Hc=()=>Object.create(qc),Wc=t=>Object.getPrototypeOf(t)===qc;function yf(t,e,i,s=!1){const a={},o=Hc();t.propsDefaults=Object.create(null),zc(t,e,a,o);for(const c in t.propsOptions[0])c in a||(a[c]=void 0);i?t.props=s?a:_h(a):t.type.props?t.props=a:t.props=o,t.attrs=o}function vf(t,e,i,s){const{props:a,attrs:o,vnode:{patchFlag:c}}=t,l=ee(a),[h]=t.propsOptions;let g=!1;if((s||c>0)&&!(c&16)){if(c&8){const d=t.vnode.dynamicProps;for(let b=0;b<d.length;b++){let _=d[b];if(ls(t.emitsOptions,_))continue;const p=e[_];if(h)if(ne(o,_))p!==o[_]&&(o[_]=p,g=!0);else{const v=Pn(_);a[v]=vo(h,l,v,p,t,!1)}else p!==o[_]&&(o[_]=p,g=!0)}}}else{zc(t,e,a,o)&&(g=!0);let d;for(const b in l)(!e||!ne(e,b)&&((d=Gn(b))===b||!ne(e,d)))&&(h?i&&(i[b]!==void 0||i[d]!==void 0)&&(a[b]=vo(h,l,b,void 0,t,!0)):delete a[b]);if(o!==l)for(const b in o)(!e||!ne(e,b))&&(delete o[b],g=!0)}g&&sn(t.attrs,"set","")}function zc(t,e,i,s){const[a,o]=t.propsOptions;let c=!1,l;if(e)for(let h in e){if(ii(h))continue;const g=e[h];let d;a&&ne(a,d=Pn(h))?!o||!o.includes(d)?i[d]=g:(l||(l={}))[d]=g:ls(t.emitsOptions,h)||(!(h in s)||g!==s[h])&&(s[h]=g,c=!0)}if(o){const h=ee(i),g=l||se;for(let d=0;d<o.length;d++){const b=o[d];i[b]=vo(a,h,b,g[b],t,!ne(g,b))}}return c}function vo(t,e,i,s,a,o){const c=t[i];if(c!=null){const l=ne(c,"default");if(l&&s===void 0){const h=c.default;if(c.type!==Function&&!c.skipFactory&&qt(h)){const{propsDefaults:g}=a;if(i in g)s=g[i];else{const d=mi(a);s=g[i]=h.call(null,e),d()}}else s=h;a.ce&&a.ce._setProp(i,s)}c[0]&&(o&&!l?s=!1:c[1]&&(s===""||s===Gn(i))&&(s=!0))}return s}const _f=new WeakMap;function Yc(t,e,i=!1){const s=i?_f:e.propsCache,a=s.get(t);if(a)return a;const o=t.props,c={},l=[];let h=!1;if(!qt(t)){const d=b=>{h=!0;const[_,p]=Yc(b,e,!0);Te(c,_),p&&l.push(...p)};!i&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!o&&!h)return fe(t)&&s.set(t,ni),ni;if(Ht(o))for(let d=0;d<o.length;d++){const b=Pn(o[d]);ja(b)&&(c[b]=se)}else if(o)for(const d in o){const b=Pn(d);if(ja(b)){const _=o[d],p=c[b]=Ht(_)||qt(_)?{type:_}:Te({},_),v=p.type;let S=!1,E=!0;if(Ht(v))for(let O=0;O<v.length;++O){const y=v[O],f=qt(y)&&y.name;if(f==="Boolean"){S=!0;break}else f==="String"&&(E=!1)}else S=qt(v)&&v.name==="Boolean";p[0]=S,p[1]=E,(S||ne(p,"default"))&&l.push(b)}}const g=[c,l];return fe(t)&&s.set(t,g),g}function ja(t){return t[0]!=="$"&&!ii(t)}const Vo=t=>t==="_"||t==="_ctx"||t==="$stable",qo=t=>Ht(t)?t.map(ze):[ze(t)],bf=(t,e,i)=>{if(e._n)return e;const s=Fh((...a)=>qo(e(...a)),i);return s._c=!1,s},Xc=(t,e,i)=>{const s=t._ctx;for(const a in t){if(Vo(a))continue;const o=t[a];if(qt(o))e[a]=bf(a,o,s);else if(o!=null){const c=qo(o);e[a]=()=>c}}},Qc=(t,e)=>{const i=qo(e);t.slots.default=()=>i},Jc=(t,e,i)=>{for(const s in e)(i||!Vo(s))&&(t[s]=e[s])},wf=(t,e,i)=>{const s=t.slots=Hc();if(t.vnode.shapeFlag&32){const a=e._;a?(Jc(s,e,i),i&&dc(s,"_",a,!0)):Xc(e,s)}else e&&Qc(t,e)},Sf=(t,e,i)=>{const{vnode:s,slots:a}=t;let o=!0,c=se;if(s.shapeFlag&32){const l=e._;l?i&&l===1?o=!1:Jc(a,e,i):(o=!e.$stable,Xc(e,a)),c=e}else e&&(Qc(t,e),c={default:1});if(o)for(const l in a)!Vo(l)&&c[l]==null&&delete a[l]},Le=Ef;function xf(t){return Cf(t)}function Cf(t,e){const i=ss();i.__VUE__=!0;const{insert:s,remove:a,patchProp:o,createElement:c,createText:l,createComment:h,setText:g,setElementText:d,parentNode:b,nextSibling:_,setScopeId:p=Xe,insertStaticContent:v}=t,S=(N,V,st,ut=null,pt=null,dt=null,bt=void 0,xt=null,_t=!!V.dynamicChildren)=>{if(N===V)return;N&&!dr(N,V)&&(ut=B(N),ct(N,pt,dt,!0),N=null),V.patchFlag===-2&&(_t=!1,V.dynamicChildren=null);const{type:mt,ref:kt,shapeFlag:Ct}=V;switch(mt){case cs:E(N,V,st,ut);break;case tr:O(N,V,st,ut);break;case Js:N==null&&y(V,st,ut,bt);break;case rn:K(N,V,st,ut,pt,dt,bt,xt,_t);break;default:Ct&1?P(N,V,st,ut,pt,dt,bt,xt,_t):Ct&6?W(N,V,st,ut,pt,dt,bt,xt,_t):(Ct&64||Ct&128)&&mt.process(N,V,st,ut,pt,dt,bt,xt,_t,At)}kt!=null&&pt?ai(kt,N&&N.ref,dt,V||N,!V):kt==null&&N&&N.ref!=null&&ai(N.ref,null,dt,N,!0)},E=(N,V,st,ut)=>{if(N==null)s(V.el=l(V.children),st,ut);else{const pt=V.el=N.el;V.children!==N.children&&g(pt,V.children)}},O=(N,V,st,ut)=>{N==null?s(V.el=h(V.children||""),st,ut):V.el=N.el},y=(N,V,st,ut)=>{[N.el,N.anchor]=v(N.children,V,st,ut,N.el,N.anchor)},f=({el:N,anchor:V},st,ut)=>{let pt;for(;N&&N!==V;)pt=_(N),s(N,st,ut),N=pt;s(V,st,ut)},w=({el:N,anchor:V})=>{let st;for(;N&&N!==V;)st=_(N),a(N),N=st;a(V)},P=(N,V,st,ut,pt,dt,bt,xt,_t)=>{if(V.type==="svg"?bt="svg":V.type==="math"&&(bt="mathml"),N==null)I(V,st,ut,pt,dt,bt,xt,_t);else{const mt=N.el&&N.el._isVueCE?N.el:null;try{mt&&mt._beginPatch(),k(N,V,pt,dt,bt,xt,_t)}finally{mt&&mt._endPatch()}}},I=(N,V,st,ut,pt,dt,bt,xt)=>{let _t,mt;const{props:kt,shapeFlag:Ct,transition:Nt,dirs:Lt}=N;if(_t=N.el=c(N.type,dt,kt&&kt.is,kt),Ct&8?d(_t,N.children):Ct&16&&A(N.children,_t,null,ut,pt,Qs(N,dt),bt,xt),Lt&&Fn(N,null,ut,"created"),q(_t,N,N.scopeId,bt,ut),kt){for(const Ut in kt)Ut!=="value"&&!ii(Ut)&&o(_t,Ut,null,kt[Ut],dt,ut);"value"in kt&&o(_t,"value",null,kt.value,dt),(mt=kt.onVnodeBeforeMount)&&He(mt,ut,N)}Lt&&Fn(N,null,ut,"beforeMount");const Gt=Pf(pt,Nt);Gt&&Nt.beforeEnter(_t),s(_t,V,st),((mt=kt&&kt.onVnodeMounted)||Gt||Lt)&&Le(()=>{mt&&He(mt,ut,N),Gt&&Nt.enter(_t),Lt&&Fn(N,null,ut,"mounted")},pt)},q=(N,V,st,ut,pt)=>{if(st&&p(N,st),ut)for(let dt=0;dt<ut.length;dt++)p(N,ut[dt]);if(pt){let dt=pt.subTree;if(V===dt||tu(dt.type)&&(dt.ssContent===V||dt.ssFallback===V)){const bt=pt.vnode;q(N,bt,bt.scopeId,bt.slotScopeIds,pt.parent)}}},A=(N,V,st,ut,pt,dt,bt,xt,_t=0)=>{for(let mt=_t;mt<N.length;mt++){const kt=N[mt]=xt?wn(N[mt]):ze(N[mt]);S(null,kt,V,st,ut,pt,dt,bt,xt)}},k=(N,V,st,ut,pt,dt,bt)=>{const xt=V.el=N.el;let{patchFlag:_t,dynamicChildren:mt,dirs:kt}=V;_t|=N.patchFlag&16;const Ct=N.props||se,Nt=V.props||se;let Lt;if(st&&In(st,!1),(Lt=Nt.onVnodeBeforeUpdate)&&He(Lt,st,V,N),kt&&Fn(V,N,st,"beforeUpdate"),st&&In(st,!0),(Ct.innerHTML&&Nt.innerHTML==null||Ct.textContent&&Nt.textContent==null)&&d(xt,""),mt?F(N.dynamicChildren,mt,xt,st,ut,Qs(V,pt),dt):bt||R(N,V,xt,null,st,ut,Qs(V,pt),dt,!1),_t>0){if(_t&16)M(xt,Ct,Nt,st,pt);else if(_t&2&&Ct.class!==Nt.class&&o(xt,"class",null,Nt.class,pt),_t&4&&o(xt,"style",Ct.style,Nt.style,pt),_t&8){const Gt=V.dynamicProps;for(let Ut=0;Ut<Gt.length;Ut++){const Bt=Gt[Ut],Zt=Ct[Bt],Jt=Nt[Bt];(Jt!==Zt||Bt==="value")&&o(xt,Bt,Zt,Jt,pt,st)}}_t&1&&N.children!==V.children&&d(xt,V.children)}else!bt&&mt==null&&M(xt,Ct,Nt,st,pt);((Lt=Nt.onVnodeUpdated)||kt)&&Le(()=>{Lt&&He(Lt,st,V,N),kt&&Fn(V,N,st,"updated")},ut)},F=(N,V,st,ut,pt,dt,bt)=>{for(let xt=0;xt<V.length;xt++){const _t=N[xt],mt=V[xt],kt=_t.el&&(_t.type===rn||!dr(_t,mt)||_t.shapeFlag&198)?b(_t.el):st;S(_t,mt,kt,null,ut,pt,dt,bt,!0)}},M=(N,V,st,ut,pt)=>{if(V!==st){if(V!==se)for(const dt in V)!ii(dt)&&!(dt in st)&&o(N,dt,V[dt],null,pt,ut);for(const dt in st){if(ii(dt))continue;const bt=st[dt],xt=V[dt];bt!==xt&&dt!=="value"&&o(N,dt,xt,bt,pt,ut)}"value"in st&&o(N,"value",V.value,st.value,pt)}},K=(N,V,st,ut,pt,dt,bt,xt,_t)=>{const mt=V.el=N?N.el:l(""),kt=V.anchor=N?N.anchor:l("");let{patchFlag:Ct,dynamicChildren:Nt,slotScopeIds:Lt}=V;Lt&&(xt=xt?xt.concat(Lt):Lt),N==null?(s(mt,st,ut),s(kt,st,ut),A(V.children||[],st,kt,pt,dt,bt,xt,_t)):Ct>0&&Ct&64&&Nt&&N.dynamicChildren?(F(N.dynamicChildren,Nt,st,pt,dt,bt,xt),(V.key!=null||pt&&V===pt.subTree)&&$c(N,V,!0)):R(N,V,st,kt,pt,dt,bt,xt,_t)},W=(N,V,st,ut,pt,dt,bt,xt,_t)=>{V.slotScopeIds=xt,N==null?V.shapeFlag&512?pt.ctx.activate(V,st,ut,bt,_t):J(V,st,ut,pt,dt,bt,_t):z(N,V,_t)},J=(N,V,st,ut,pt,dt,bt)=>{const xt=N.component=If(N,ut,pt);if(Dc(N)&&(xt.ctx.renderer=At),Df(xt,!1,bt),xt.asyncDep){if(pt&&pt.registerDep(xt,ft,bt),!N.el){const _t=xt.subTree=pe(tr);O(null,_t,V,st),N.placeholder=_t.el}}else ft(xt,N,V,st,pt,dt,bt)},z=(N,V,st)=>{const ut=V.component=N.component;if(pf(N,V,st))if(ut.asyncDep&&!ut.asyncResolved){C(ut,V,st);return}else ut.next=V,ut.update();else V.el=N.el,ut.vnode=V},ft=(N,V,st,ut,pt,dt,bt)=>{const xt=()=>{if(N.isMounted){let{next:Ct,bu:Nt,u:Lt,parent:Gt,vnode:Ut}=N;{const oe=Zc(N);if(oe){Ct&&(Ct.el=Ut.el,C(N,Ct,bt)),oe.asyncDep.then(()=>{N.isUnmounted||xt()});return}}let Bt=Ct,Zt;In(N,!1),Ct?(Ct.el=Ut.el,C(N,Ct,bt)):Ct=Ut,Nt&&qs(Nt),(Zt=Ct.props&&Ct.props.onVnodeBeforeUpdate)&&He(Zt,Gt,Ct,Ut),In(N,!0);const Jt=Ua(N),te=N.subTree;N.subTree=Jt,S(te,Jt,b(te.el),B(te),N,pt,dt),Ct.el=Jt.el,Bt===null&&mf(N,Jt.el),Lt&&Le(Lt,pt),(Zt=Ct.props&&Ct.props.onVnodeUpdated)&&Le(()=>He(Zt,Gt,Ct,Ut),pt)}else{let Ct;const{el:Nt,props:Lt}=V,{bm:Gt,m:Ut,parent:Bt,root:Zt,type:Jt}=N,te=li(V);In(N,!1),Gt&&qs(Gt),!te&&(Ct=Lt&&Lt.onVnodeBeforeMount)&&He(Ct,Bt,V),In(N,!0);{Zt.ce&&Zt.ce._def.shadowRoot!==!1&&Zt.ce._injectChildStyle(Jt);const oe=N.subTree=Ua(N);S(null,oe,st,ut,N,pt,dt),V.el=oe.el}if(Ut&&Le(Ut,pt),!te&&(Ct=Lt&&Lt.onVnodeMounted)){const oe=V;Le(()=>He(Ct,Bt,oe),pt)}(V.shapeFlag&256||Bt&&li(Bt.vnode)&&Bt.vnode.shapeFlag&256)&&N.a&&Le(N.a,pt),N.isMounted=!0,V=st=ut=null}};N.scope.on();const _t=N.effect=new pc(xt);N.scope.off();const mt=N.update=_t.run.bind(_t),kt=N.job=_t.runIfDirty.bind(_t);kt.i=N,kt.id=N.uid,_t.scheduler=()=>Bo(kt),In(N,!0),mt()},C=(N,V,st)=>{V.component=N;const ut=N.vnode.props;N.vnode=V,N.next=null,vf(N,V.props,ut,st),Sf(N,V.children,st),on(),Ia(N),an()},R=(N,V,st,ut,pt,dt,bt,xt,_t=!1)=>{const mt=N&&N.children,kt=N?N.shapeFlag:0,Ct=V.children,{patchFlag:Nt,shapeFlag:Lt}=V;if(Nt>0){if(Nt&128){L(mt,Ct,st,ut,pt,dt,bt,xt,_t);return}else if(Nt&256){G(mt,Ct,st,ut,pt,dt,bt,xt,_t);return}}Lt&8?(kt&16&&ot(mt,pt,dt),Ct!==mt&&d(st,Ct)):kt&16?Lt&16?L(mt,Ct,st,ut,pt,dt,bt,xt,_t):ot(mt,pt,dt,!0):(kt&8&&d(st,""),Lt&16&&A(Ct,st,ut,pt,dt,bt,xt,_t))},G=(N,V,st,ut,pt,dt,bt,xt,_t)=>{N=N||ni,V=V||ni;const mt=N.length,kt=V.length,Ct=Math.min(mt,kt);let Nt;for(Nt=0;Nt<Ct;Nt++){const Lt=V[Nt]=_t?wn(V[Nt]):ze(V[Nt]);S(N[Nt],Lt,st,null,pt,dt,bt,xt,_t)}mt>kt?ot(N,pt,dt,!0,!1,Ct):A(V,st,ut,pt,dt,bt,xt,_t,Ct)},L=(N,V,st,ut,pt,dt,bt,xt,_t)=>{let mt=0;const kt=V.length;let Ct=N.length-1,Nt=kt-1;for(;mt<=Ct&&mt<=Nt;){const Lt=N[mt],Gt=V[mt]=_t?wn(V[mt]):ze(V[mt]);if(dr(Lt,Gt))S(Lt,Gt,st,null,pt,dt,bt,xt,_t);else break;mt++}for(;mt<=Ct&&mt<=Nt;){const Lt=N[Ct],Gt=V[Nt]=_t?wn(V[Nt]):ze(V[Nt]);if(dr(Lt,Gt))S(Lt,Gt,st,null,pt,dt,bt,xt,_t);else break;Ct--,Nt--}if(mt>Ct){if(mt<=Nt){const Lt=Nt+1,Gt=Lt<kt?V[Lt].el:ut;for(;mt<=Nt;)S(null,V[mt]=_t?wn(V[mt]):ze(V[mt]),st,Gt,pt,dt,bt,xt,_t),mt++}}else if(mt>Nt)for(;mt<=Ct;)ct(N[mt],pt,dt,!0),mt++;else{const Lt=mt,Gt=mt,Ut=new Map;for(mt=Gt;mt<=Nt;mt++){const ae=V[mt]=_t?wn(V[mt]):ze(V[mt]);ae.key!=null&&Ut.set(ae.key,mt)}let Bt,Zt=0;const Jt=Nt-Gt+1;let te=!1,oe=0;const Ie=new Array(Jt);for(mt=0;mt<Jt;mt++)Ie[mt]=0;for(mt=Lt;mt<=Ct;mt++){const ae=N[mt];if(Zt>=Jt){ct(ae,pt,dt,!0);continue}let Ft;if(ae.key!=null)Ft=Ut.get(ae.key);else for(Bt=Gt;Bt<=Nt;Bt++)if(Ie[Bt-Gt]===0&&dr(ae,V[Bt])){Ft=Bt;break}Ft===void 0?ct(ae,pt,dt,!0):(Ie[Ft-Gt]=mt+1,Ft>=oe?oe=Ft:te=!0,S(ae,V[Ft],st,null,pt,dt,bt,xt,_t),Zt++)}const Be=te?Tf(Ie):ni;for(Bt=Be.length-1,mt=Jt-1;mt>=0;mt--){const ae=Gt+mt,Ft=V[ae],un=V[ae+1],je=ae+1<kt?un.el||un.placeholder:ut;Ie[mt]===0?S(null,Ft,st,je,pt,dt,bt,xt,_t):te&&(Bt<0||mt!==Be[Bt]?j(Ft,st,je,2):Bt--)}}},j=(N,V,st,ut,pt=null)=>{const{el:dt,type:bt,transition:xt,children:_t,shapeFlag:mt}=N;if(mt&6){j(N.component.subTree,V,st,ut);return}if(mt&128){N.suspense.move(V,st,ut);return}if(mt&64){bt.move(N,V,st,At);return}if(bt===rn){s(dt,V,st);for(let Ct=0;Ct<_t.length;Ct++)j(_t[Ct],V,st,ut);s(N.anchor,V,st);return}if(bt===Js){f(N,V,st);return}if(ut!==2&&mt&1&&xt)if(ut===0)xt.beforeEnter(dt),s(dt,V,st),Le(()=>xt.enter(dt),pt);else{const{leave:Ct,delayLeave:Nt,afterLeave:Lt}=xt,Gt=()=>{N.ctx.isUnmounted?a(dt):s(dt,V,st)},Ut=()=>{dt._isLeaving&&dt[Dh](!0),Ct(dt,()=>{Gt(),Lt&&Lt()})};Nt?Nt(dt,Gt,Ut):Ut()}else s(dt,V,st)},ct=(N,V,st,ut=!1,pt=!1)=>{const{type:dt,props:bt,ref:xt,children:_t,dynamicChildren:mt,shapeFlag:kt,patchFlag:Ct,dirs:Nt,cacheIndex:Lt}=N;if(Ct===-2&&(pt=!1),xt!=null&&(on(),ai(xt,null,st,N,!0),an()),Lt!=null&&(V.renderCache[Lt]=void 0),kt&256){V.ctx.deactivate(N);return}const Gt=kt&1&&Nt,Ut=!li(N);let Bt;if(Ut&&(Bt=bt&&bt.onVnodeBeforeUnmount)&&He(Bt,V,N),kt&6)St(N.component,st,ut);else{if(kt&128){N.suspense.unmount(st,ut);return}Gt&&Fn(N,null,V,"beforeUnmount"),kt&64?N.type.remove(N,V,st,At,ut):mt&&!mt.hasOnce&&(dt!==rn||Ct>0&&Ct&64)?ot(mt,V,st,!1,!0):(dt===rn&&Ct&384||!pt&&kt&16)&&ot(_t,V,st),ut&&$(N)}(Ut&&(Bt=bt&&bt.onVnodeUnmounted)||Gt)&&Le(()=>{Bt&&He(Bt,V,N),Gt&&Fn(N,null,V,"unmounted")},st)},$=N=>{const{type:V,el:st,anchor:ut,transition:pt}=N;if(V===rn){vt(st,ut);return}if(V===Js){w(N);return}const dt=()=>{a(st),pt&&!pt.persisted&&pt.afterLeave&&pt.afterLeave()};if(N.shapeFlag&1&&pt&&!pt.persisted){const{leave:bt,delayLeave:xt}=pt,_t=()=>bt(st,dt);xt?xt(N.el,dt,_t):_t()}else dt()},vt=(N,V)=>{let st;for(;N!==V;)st=_(N),a(N),N=st;a(V)},St=(N,V,st)=>{const{bum:ut,scope:pt,job:dt,subTree:bt,um:xt,m:_t,a:mt}=N;Va(_t),Va(mt),ut&&qs(ut),pt.stop(),dt&&(dt.flags|=8,ct(bt,N,V,st)),xt&&Le(xt,V),Le(()=>{N.isUnmounted=!0},V)},ot=(N,V,st,ut=!1,pt=!1,dt=0)=>{for(let bt=dt;bt<N.length;bt++)ct(N[bt],V,st,ut,pt)},B=N=>{if(N.shapeFlag&6)return B(N.component.subTree);if(N.shapeFlag&128)return N.suspense.next();const V=_(N.anchor||N.el),st=V&&V[Ih];return st?_(st):V};let at=!1;const ht=(N,V,st)=>{N==null?V._vnode&&ct(V._vnode,null,null,!0):S(V._vnode||null,N,V,null,null,null,st),V._vnode=N,at||(at=!0,Ia(),Mc(),at=!1)},At={p:S,um:ct,m:j,r:$,mt:J,mc:A,pc:R,pbc:F,n:B,o:t};return{render:ht,hydrate:void 0,createApp:rf(ht)}}function Qs({type:t,props:e},i){return i==="svg"&&t==="foreignObject"||i==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function In({effect:t,job:e},i){i?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Pf(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function $c(t,e,i=!1){const s=t.children,a=e.children;if(Ht(s)&&Ht(a))for(let o=0;o<s.length;o++){const c=s[o];let l=a[o];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=a[o]=wn(a[o]),l.el=c.el),!i&&l.patchFlag!==-2&&$c(c,l)),l.type===cs&&l.patchFlag!==-1&&(l.el=c.el),l.type===tr&&!l.el&&(l.el=c.el)}}function Tf(t){const e=t.slice(),i=[0];let s,a,o,c,l;const h=t.length;for(s=0;s<h;s++){const g=t[s];if(g!==0){if(a=i[i.length-1],t[a]<g){e[s]=a,i.push(s);continue}for(o=0,c=i.length-1;o<c;)l=o+c>>1,t[i[l]]<g?o=l+1:c=l;g<t[i[o]]&&(o>0&&(e[s]=i[o-1]),i[o]=s)}}for(o=i.length,c=i[o-1];o-- >0;)i[o]=c,c=e[c];return i}function Zc(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Zc(e)}function Va(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const tu=t=>t.__isSuspense;function Ef(t,e){e&&e.pendingBranch?Ht(t)?e.effects.push(...t):e.effects.push(t):Mh(t)}const rn=Symbol.for("v-fgt"),cs=Symbol.for("v-txt"),tr=Symbol.for("v-cmt"),Js=Symbol.for("v-stc");let xn=null,Ho=1;function qa(t,e=!1){Ho+=t,t<0&&xn&&e&&(xn.hasOnce=!0)}function eu(t){return t?t.__v_isVNode===!0:!1}function dr(t,e){return t.type===e.type&&t.key===e.key}const nu=({key:t})=>t??null,Hi=({ref:t,ref_key:e,ref_for:i})=>(typeof t=="number"&&(t=""+t),t!=null?ve(t)||Pe(t)||qt(t)?{i:Ye,r:t,k:e,f:!!i}:t:null);function Af(t,e=null,i=null,s=0,a=null,o=t===rn?0:1,c=!1,l=!1){const h={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&nu(e),ref:e&&Hi(e),scopeId:Ic,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:s,dynamicProps:a,dynamicChildren:null,appContext:null,ctx:Ye};return l?(Wo(h,i),o&128&&t.normalize(h)):i&&(h.shapeFlag|=ve(i)?8:16),Ho>0&&!c&&xn&&(h.patchFlag>0||o&6)&&h.patchFlag!==32&&xn.push(h),h}const pe=Rf;function Rf(t,e=null,i=null,s=0,a=null,o=!1){if((!t||t===Xh)&&(t=tr),eu(t)){const l=er(t,e,!0);return i&&Wo(l,i),Ho>0&&!o&&xn&&(l.shapeFlag&6?xn[xn.indexOf(t)]=l:xn.push(l)),l.patchFlag=-2,l}if(Uf(t)&&(t=t.__vccOpts),e){e=kf(e);let{class:l,style:h}=e;l&&!ve(l)&&(e.class=Ro(l)),fe(h)&&(Go(h)&&!Ht(h)&&(h=Te({},h)),e.style=Ao(h))}const c=ve(t)?1:tu(t)?128:Nh(t)?64:fe(t)?4:qt(t)?2:0;return Af(t,e,i,s,a,c,o,!0)}function kf(t){return t?Go(t)||Wc(t)?Te({},t):t:null}function er(t,e,i=!1,s=!1){const{props:a,ref:o,patchFlag:c,children:l,transition:h}=t,g=e?Of(a||{},e):a,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:g,key:g&&nu(g),ref:e&&e.ref?i&&o?Ht(o)?o.concat(Hi(e)):[o,Hi(e)]:Hi(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==rn?c===-1?16:c|16:c,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:h,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&er(t.ssContent),ssFallback:t.ssFallback&&er(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return h&&s&&Uo(d,h.clone(d)),d}function ru(t=" ",e=0){return pe(cs,null,t,e)}function ze(t){return t==null||typeof t=="boolean"?pe(tr):Ht(t)?pe(rn,null,t.slice()):eu(t)?wn(t):pe(cs,null,String(t))}function wn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:er(t)}function Wo(t,e){let i=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(Ht(e))i=16;else if(typeof e=="object")if(s&65){const a=e.default;a&&(a._c&&(a._d=!1),Wo(t,a()),a._c&&(a._d=!0));return}else{i=32;const a=e._;!a&&!Wc(e)?e._ctx=Ye:a===3&&Ye&&(Ye.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else qt(e)?(e={default:e,_ctx:Ye},i=32):(e=String(e),s&64?(i=16,e=[ru(e)]):i=8);t.children=e,t.shapeFlag|=i}function Of(...t){const e={};for(let i=0;i<t.length;i++){const s=t[i];for(const a in s)if(a==="class")e.class!==s.class&&(e.class=Ro([e.class,s.class]));else if(a==="style")e.style=Ao([e.style,s.style]);else if(ns(a)){const o=e[a],c=s[a];c&&o!==c&&!(Ht(o)&&o.includes(c))&&(e[a]=o?[].concat(o,c):c)}else a!==""&&(e[a]=s[a])}return e}function He(t,e,i,s=null){Qe(t,e,7,[i,s])}const Mf=Kc();let Ff=0;function If(t,e,i){const s=t.type,a=(e?e.appContext:t.appContext)||Mf,o={uid:Ff++,vnode:t,type:s,parent:e,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Zu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(a.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Yc(s,a),emitsOptions:Vc(s,a),emit:null,emitted:null,propsDefaults:se,inheritAttrs:s.inheritAttrs,ctx:se,data:se,props:se,attrs:se,slots:se,refs:se,setupState:se,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=e?e.root:o,o.emit=hf.bind(null,o),t.ce&&t.ce(o),o}let ke=null;const Nf=()=>ke||Ye;let ts,_o;{const t=ss(),e=(i,s)=>{let a;return(a=t[i])||(a=t[i]=[]),a.push(s),o=>{a.length>1?a.forEach(c=>c(o)):a[0](o)}};ts=e("__VUE_INSTANCE_SETTERS__",i=>ke=i),_o=e("__VUE_SSR_SETTERS__",i=>gi=i)}const mi=t=>{const e=ke;return ts(t),t.scope.on(),()=>{t.scope.off(),ts(e)}},Ha=()=>{ke&&ke.scope.off(),ts(null)};function iu(t){return t.vnode.shapeFlag&4}let gi=!1;function Df(t,e=!1,i=!1){e&&_o(e);const{props:s,children:a}=t.vnode,o=iu(t);yf(t,s,o,e),wf(t,a,i||e);const c=o?Lf(t,e):void 0;return e&&_o(!1),c}function Lf(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Qh);const{setup:s}=i;if(s){on();const a=t.setupContext=s.length>1?Bf(t):null,o=mi(t),c=pi(s,t,0,[t.props,a]),l=hc(c);if(an(),o(),(l||t.sp)&&!li(t)&&Nc(t),l){if(c.then(Ha,Ha),e)return c.then(h=>{Wa(t,h)}).catch(h=>{os(h,t,0)});t.asyncDep=c}else Wa(t,c)}else su(t)}function Wa(t,e,i){qt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:fe(e)&&(t.setupState=Rc(e)),su(t)}function su(t,e,i){const s=t.type;t.render||(t.render=s.render||Xe);{const a=mi(t);on();try{Jh(t)}finally{an(),a()}}}const Gf={get(t,e){return Ce(t,"get",""),t[e]}};function Bf(t){const e=i=>{t.exposed=i||{}};return{attrs:new Proxy(t.attrs,Gf),slots:t.slots,emit:t.emit,expose:e}}function zo(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Rc(bh(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in ci)return ci[i](t)},has(e,i){return i in e||i in ci}})):t.proxy}function Uf(t){return qt(t)&&"__vccOpts"in t}const Kf=(t,e)=>Th(t,e,gi),jf="3.5.25";/**
* @vue/runtime-dom v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bo;const za=typeof window<"u"&&window.trustedTypes;if(za)try{bo=za.createPolicy("vue",{createHTML:t=>t})}catch{}const ou=bo?t=>bo.createHTML(t):t=>t,Vf="http://www.w3.org/2000/svg",qf="http://www.w3.org/1998/Math/MathML",nn=typeof document<"u"?document:null,Ya=nn&&nn.createElement("template"),Hf={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,s)=>{const a=e==="svg"?nn.createElementNS(Vf,t):e==="mathml"?nn.createElementNS(qf,t):i?nn.createElement(t,{is:i}):nn.createElement(t);return t==="select"&&s&&s.multiple!=null&&a.setAttribute("multiple",s.multiple),a},createText:t=>nn.createTextNode(t),createComment:t=>nn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>nn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,s,a,o){const c=i?i.previousSibling:e.lastChild;if(a&&(a===o||a.nextSibling))for(;e.insertBefore(a.cloneNode(!0),i),!(a===o||!(a=a.nextSibling)););else{Ya.innerHTML=ou(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const l=Ya.content;if(s==="svg"||s==="mathml"){const h=l.firstChild;for(;h.firstChild;)l.appendChild(h.firstChild);l.removeChild(h)}e.insertBefore(l,i)}return[c?c.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},Wf=Symbol("_vtc");function zf(t,e,i){const s=t[Wf];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}const Xa=Symbol("_vod"),Yf=Symbol("_vsh"),Xf=Symbol(""),Qf=/(?:^|;)\s*display\s*:/;function Jf(t,e,i){const s=t.style,a=ve(i);let o=!1;if(i&&!a){if(e)if(ve(e))for(const c of e.split(";")){const l=c.slice(0,c.indexOf(":")).trim();i[l]==null&&Wi(s,l,"")}else for(const c in e)i[c]==null&&Wi(s,c,"");for(const c in i)c==="display"&&(o=!0),Wi(s,c,i[c])}else if(a){if(e!==i){const c=s[Xf];c&&(i+=";"+c),s.cssText=i,o=Qf.test(i)}}else e&&t.removeAttribute("style");Xa in t&&(t[Xa]=o?s.display:"",t[Yf]&&(s.display="none"))}const Qa=/\s*!important$/;function Wi(t,e,i){if(Ht(i))i.forEach(s=>Wi(t,e,s));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const s=$f(t,e);Qa.test(i)?t.setProperty(Gn(s),i.replace(Qa,""),"important"):t[s]=i}}const Ja=["Webkit","Moz","ms"],$s={};function $f(t,e){const i=$s[e];if(i)return i;let s=Pn(e);if(s!=="filter"&&s in t)return $s[e]=s;s=fc(s);for(let a=0;a<Ja.length;a++){const o=Ja[a]+s;if(o in t)return $s[e]=o}return e}const $a="http://www.w3.org/1999/xlink";function Za(t,e,i,s,a,o=$u(e)){s&&e.startsWith("xlink:")?i==null?t.removeAttributeNS($a,e.slice(6,e.length)):t.setAttributeNS($a,e,i):i==null||o&&!gc(i)?t.removeAttribute(e):t.setAttribute(e,o?"":nr(i)?String(i):i)}function tl(t,e,i,s,a){if(e==="innerHTML"||e==="textContent"){i!=null&&(t[e]=e==="innerHTML"?ou(i):i);return}const o=t.tagName;if(e==="value"&&o!=="PROGRESS"&&!o.includes("-")){const l=o==="OPTION"?t.getAttribute("value")||"":t.value,h=i==null?t.type==="checkbox"?"on":"":String(i);(l!==h||!("_value"in t))&&(t.value=h),i==null&&t.removeAttribute(e),t._value=i;return}let c=!1;if(i===""||i==null){const l=typeof t[e];l==="boolean"?i=gc(i):i==null&&l==="string"?(i="",c=!0):l==="number"&&(i=0,c=!0)}try{t[e]=i}catch{}c&&t.removeAttribute(a||e)}function Zf(t,e,i,s){t.addEventListener(e,i,s)}function td(t,e,i,s){t.removeEventListener(e,i,s)}const el=Symbol("_vei");function ed(t,e,i,s,a=null){const o=t[el]||(t[el]={}),c=o[e];if(s&&c)c.value=s;else{const[l,h]=nd(e);if(s){const g=o[e]=sd(s,a);Zf(t,l,g,h)}else c&&(td(t,l,c,h),o[e]=void 0)}}const nl=/(?:Once|Passive|Capture)$/;function nd(t){let e;if(nl.test(t)){e={};let s;for(;s=t.match(nl);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Gn(t.slice(2)),e]}let Zs=0;const rd=Promise.resolve(),id=()=>Zs||(rd.then(()=>Zs=0),Zs=Date.now());function sd(t,e){const i=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=i.attached)return;Qe(od(s,i.value),e,5,[s])};return i.value=t,i.attached=id(),i}function od(t,e){if(Ht(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(s=>a=>!a._stopped&&s&&s(a))}else return e}const rl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,ad=(t,e,i,s,a,o)=>{const c=a==="svg";e==="class"?zf(t,s,c):e==="style"?Jf(t,i,s):ns(e)?Po(e)||ed(t,e,i,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):ld(t,e,s,c))?(tl(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Za(t,e,s,c,o,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!ve(s))?tl(t,Pn(e),s,o,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Za(t,e,s,c))};function ld(t,e,i,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&rl(e)&&qt(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const a=t.tagName;if(a==="IMG"||a==="VIDEO"||a==="CANVAS"||a==="SOURCE")return!1}return rl(e)&&ve(i)?!1:e in t}const cd=Te({patchProp:ad},Hf);let il;function ud(){return il||(il=xf(cd))}const hd=((...t)=>{const e=ud().createApp(...t),{mount:i}=e;return e.mount=s=>{const a=dd(s);if(!a)return;const o=e._component;!qt(o)&&!o.render&&!o.template&&(o.template=a.innerHTML),a.nodeType===1&&(a.textContent="");const c=i(a,!1,fd(a));return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),c},e});function fd(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function dd(t){return ve(t)?document.querySelector(t):t}var wo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function au(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zi={exports:{}},gr={},to={},eo={},sl;function zt(){return sl||(sl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function i(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof wo<"u"?wo:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.22",isBrowser:i(),isUnminified:/param/.test((function(a){}).toString()),dblClickWindow:400,getAngle(a){return t.Konva.angleDeg?a*e:a},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var a;return(a=t.Konva.Transformer)===null||a===void 0?void 0:a.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(a){t.glob.Konva=a}};const s=a=>{t.Konva[a.prototype.getClassName()]=a};t._registerNode=s,t.Konva._injectGlobal(t.Konva)})(eo)),eo}var no={},ol;function ce(){return ol||(ol=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=zt();class i{constructor(w=[1,0,0,1,0,0]){this.dirty=!1,this.m=w&&w.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new i(this.m)}copyInto(w){w.m[0]=this.m[0],w.m[1]=this.m[1],w.m[2]=this.m[2],w.m[3]=this.m[3],w.m[4]=this.m[4],w.m[5]=this.m[5]}point(w){const P=this.m;return{x:P[0]*w.x+P[2]*w.y+P[4],y:P[1]*w.x+P[3]*w.y+P[5]}}translate(w,P){return this.m[4]+=this.m[0]*w+this.m[2]*P,this.m[5]+=this.m[1]*w+this.m[3]*P,this}scale(w,P){return this.m[0]*=w,this.m[1]*=w,this.m[2]*=P,this.m[3]*=P,this}rotate(w){const P=Math.cos(w),I=Math.sin(w),q=this.m[0]*P+this.m[2]*I,A=this.m[1]*P+this.m[3]*I,k=this.m[0]*-I+this.m[2]*P,F=this.m[1]*-I+this.m[3]*P;return this.m[0]=q,this.m[1]=A,this.m[2]=k,this.m[3]=F,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(w,P){const I=this.m[0]+this.m[2]*P,q=this.m[1]+this.m[3]*P,A=this.m[2]+this.m[0]*w,k=this.m[3]+this.m[1]*w;return this.m[0]=I,this.m[1]=q,this.m[2]=A,this.m[3]=k,this}multiply(w){const P=this.m[0]*w.m[0]+this.m[2]*w.m[1],I=this.m[1]*w.m[0]+this.m[3]*w.m[1],q=this.m[0]*w.m[2]+this.m[2]*w.m[3],A=this.m[1]*w.m[2]+this.m[3]*w.m[3],k=this.m[0]*w.m[4]+this.m[2]*w.m[5]+this.m[4],F=this.m[1]*w.m[4]+this.m[3]*w.m[5]+this.m[5];return this.m[0]=P,this.m[1]=I,this.m[2]=q,this.m[3]=A,this.m[4]=k,this.m[5]=F,this}invert(){const w=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),P=this.m[3]*w,I=-this.m[1]*w,q=-this.m[2]*w,A=this.m[0]*w,k=w*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),F=w*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=P,this.m[1]=I,this.m[2]=q,this.m[3]=A,this.m[4]=k,this.m[5]=F,this}getMatrix(){return this.m}decompose(){const w=this.m[0],P=this.m[1],I=this.m[2],q=this.m[3],A=this.m[4],k=this.m[5],F=w*q-P*I,M={x:A,y:k,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(w!=0||P!=0){const K=Math.sqrt(w*w+P*P);M.rotation=P>0?Math.acos(w/K):-Math.acos(w/K),M.scaleX=K,M.scaleY=F/K,M.skewX=(w*I+P*q)/F,M.skewY=0}else if(I!=0||q!=0){const K=Math.sqrt(I*I+q*q);M.rotation=Math.PI/2-(q>0?Math.acos(-I/K):-Math.acos(I/K)),M.scaleX=F/K,M.scaleY=K,M.skewX=0,M.skewY=(w*I+P*q)/F}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=i;const s="[object Array]",a="[object Number]",o="[object String]",c="[object Boolean]",l=Math.PI/180,h=180/Math.PI,g="#",d="",b="0",_="Konva warning: ",p="Konva error: ",v="rgb(",S={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},E=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let O=[];const y=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(f){setTimeout(f,60)};t.Util={_isElement(f){return!!(f&&f.nodeType==1)},_isFunction(f){return!!(f&&f.constructor&&f.call&&f.apply)},_isPlainObject(f){return!!f&&f.constructor===Object},_isArray(f){return Object.prototype.toString.call(f)===s},_isNumber(f){return Object.prototype.toString.call(f)===a&&!isNaN(f)&&isFinite(f)},_isString(f){return Object.prototype.toString.call(f)===o},_isBoolean(f){return Object.prototype.toString.call(f)===c},isObject(f){return f instanceof Object},isValidSelector(f){if(typeof f!="string")return!1;const w=f[0];return w==="#"||w==="."||w===w.toUpperCase()},_sign(f){return f===0||f>0?1:-1},requestAnimFrame(f){O.push(f),O.length===1&&y(function(){const w=O;O=[],w.forEach(function(P){P()})})},createCanvasElement(){const f=document.createElement("canvas");try{f.style=f.style||{}}catch{}return f},createImageElement(){return document.createElement("img")},_isInDocument(f){for(;f=f.parentNode;)if(f==document)return!0;return!1},_urlToImage(f,w){const P=t.Util.createImageElement();P.onload=function(){w(P)},P.src=f},_rgbToHex(f,w,P){return((1<<24)+(f<<16)+(w<<8)+P).toString(16).slice(1)},_hexToRgb(f){f=f.replace(g,d);const w=parseInt(f,16);return{r:w>>16&255,g:w>>8&255,b:w&255}},getRandomColor(){let f=(Math.random()*16777215<<0).toString(16);for(;f.length<6;)f=b+f;return g+f},getRGB(f){let w;return f in S?(w=S[f],{r:w[0],g:w[1],b:w[2]}):f[0]===g?this._hexToRgb(f.substring(1)):f.substr(0,4)===v?(w=E.exec(f.replace(/ /g,"")),{r:parseInt(w[1],10),g:parseInt(w[2],10),b:parseInt(w[3],10)}):{r:0,g:0,b:0}},colorToRGBA(f){return f=f||"black",t.Util._namedColorToRBA(f)||t.Util._hex3ColorToRGBA(f)||t.Util._hex4ColorToRGBA(f)||t.Util._hex6ColorToRGBA(f)||t.Util._hex8ColorToRGBA(f)||t.Util._rgbColorToRGBA(f)||t.Util._rgbaColorToRGBA(f)||t.Util._hslColorToRGBA(f)},_namedColorToRBA(f){const w=S[f.toLowerCase()];return w?{r:w[0],g:w[1],b:w[2],a:1}:null},_rgbColorToRGBA(f){if(f.indexOf("rgb(")===0){f=f.match(/rgb\(([^)]+)\)/)[1];const w=f.split(/ *, */).map(Number);return{r:w[0],g:w[1],b:w[2],a:1}}},_rgbaColorToRGBA(f){if(f.indexOf("rgba(")===0){f=f.match(/rgba\(([^)]+)\)/)[1];const w=f.split(/ *, */).map((P,I)=>P.slice(-1)==="%"?I===3?parseInt(P)/100:parseInt(P)/100*255:Number(P));return{r:w[0],g:w[1],b:w[2],a:w[3]}}},_hex8ColorToRGBA(f){if(f[0]==="#"&&f.length===9)return{r:parseInt(f.slice(1,3),16),g:parseInt(f.slice(3,5),16),b:parseInt(f.slice(5,7),16),a:parseInt(f.slice(7,9),16)/255}},_hex6ColorToRGBA(f){if(f[0]==="#"&&f.length===7)return{r:parseInt(f.slice(1,3),16),g:parseInt(f.slice(3,5),16),b:parseInt(f.slice(5,7),16),a:1}},_hex4ColorToRGBA(f){if(f[0]==="#"&&f.length===5)return{r:parseInt(f[1]+f[1],16),g:parseInt(f[2]+f[2],16),b:parseInt(f[3]+f[3],16),a:parseInt(f[4]+f[4],16)/255}},_hex3ColorToRGBA(f){if(f[0]==="#"&&f.length===4)return{r:parseInt(f[1]+f[1],16),g:parseInt(f[2]+f[2],16),b:parseInt(f[3]+f[3],16),a:1}},_hslColorToRGBA(f){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(f)){const[w,...P]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(f),I=Number(P[0])/360,q=Number(P[1])/100,A=Number(P[2])/100;let k,F,M;if(q===0)return M=A*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};A<.5?k=A*(1+q):k=A+q-A*q;const K=2*A-k,W=[0,0,0];for(let J=0;J<3;J++)F=I+1/3*-(J-1),F<0&&F++,F>1&&F--,6*F<1?M=K+(k-K)*6*F:2*F<1?M=k:3*F<2?M=K+(k-K)*(2/3-F)*6:M=K,W[J]=M*255;return{r:Math.round(W[0]),g:Math.round(W[1]),b:Math.round(W[2]),a:1}}},haveIntersection(f,w){return!(w.x>f.x+f.width||w.x+w.width<f.x||w.y>f.y+f.height||w.y+w.height<f.y)},cloneObject(f){const w={};for(const P in f)this._isPlainObject(f[P])?w[P]=this.cloneObject(f[P]):this._isArray(f[P])?w[P]=this.cloneArray(f[P]):w[P]=f[P];return w},cloneArray(f){return f.slice(0)},degToRad(f){return f*l},radToDeg(f){return f*h},_degToRad(f){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(f)},_radToDeg(f){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(f)},_getRotation(f){return e.Konva.angleDeg?t.Util.radToDeg(f):f},_capitalize(f){return f.charAt(0).toUpperCase()+f.slice(1)},throw(f){throw new Error(p+f)},error(f){console.error(p+f)},warn(f){e.Konva.showWarnings&&console.warn(_+f)},each(f,w){for(const P in f)w(P,f[P])},_inRange(f,w,P){return w<=f&&f<P},_getProjectionToSegment(f,w,P,I,q,A){let k,F,M;const K=(f-P)*(f-P)+(w-I)*(w-I);if(K==0)k=f,F=w,M=(q-P)*(q-P)+(A-I)*(A-I);else{const W=((q-f)*(P-f)+(A-w)*(I-w))/K;W<0?(k=f,F=w,M=(f-q)*(f-q)+(w-A)*(w-A)):W>1?(k=P,F=I,M=(P-q)*(P-q)+(I-A)*(I-A)):(k=f+W*(P-f),F=w+W*(I-w),M=(k-q)*(k-q)+(F-A)*(F-A))}return[k,F,M]},_getProjectionToLine(f,w,P){const I=t.Util.cloneObject(f);let q=Number.MAX_VALUE;return w.forEach(function(A,k){if(!P&&k===w.length-1)return;const F=w[(k+1)%w.length],M=t.Util._getProjectionToSegment(A.x,A.y,F.x,F.y,f.x,f.y),K=M[0],W=M[1],J=M[2];J<q&&(I.x=K,I.y=W,q=J)}),I},_prepareArrayForTween(f,w,P){const I=[],q=[];if(f.length>w.length){const k=w;w=f,f=k}for(let k=0;k<f.length;k+=2)I.push({x:f[k],y:f[k+1]});for(let k=0;k<w.length;k+=2)q.push({x:w[k],y:w[k+1]});const A=[];return q.forEach(function(k){const F=t.Util._getProjectionToLine(k,I,P);A.push(F.x),A.push(F.y)}),A},_prepareToStringify(f){let w;f.visitedByCircularReferenceRemoval=!0;for(const P in f)if(f.hasOwnProperty(P)&&f[P]&&typeof f[P]=="object"){if(w=Object.getOwnPropertyDescriptor(f,P),f[P].visitedByCircularReferenceRemoval||t.Util._isElement(f[P]))if(w.configurable)delete f[P];else return null;else if(t.Util._prepareToStringify(f[P])===null)if(w.configurable)delete f[P];else return null}return delete f.visitedByCircularReferenceRemoval,f},_assign(f,w){for(const P in w)f[P]=w[P];return f},_getFirstPointerId(f){return f.touches?f.changedTouches[0].identifier:f.pointerId||999},releaseCanvas(...f){e.Konva.releaseCanvasOnDestroy&&f.forEach(w=>{w.width=0,w.height=0})},drawRoundedRectPath(f,w,P,I){let q=0,A=0,k=0,F=0;typeof I=="number"?q=A=k=F=Math.min(I,w/2,P/2):(q=Math.min(I[0]||0,w/2,P/2),A=Math.min(I[1]||0,w/2,P/2),F=Math.min(I[2]||0,w/2,P/2),k=Math.min(I[3]||0,w/2,P/2)),f.moveTo(q,0),f.lineTo(w-A,0),f.arc(w-A,A,A,Math.PI*3/2,0,!1),f.lineTo(w,P-F),f.arc(w-F,P-F,F,0,Math.PI/2,!1),f.lineTo(k,P),f.arc(k,P-k,k,Math.PI/2,Math.PI,!1),f.lineTo(0,q),f.arc(q,q,q,Math.PI,Math.PI*3/2,!1)}}})(no)),no}var pr={},tn={},en={},al;function lu(){if(al)return en;al=1,Object.defineProperty(en,"__esModule",{value:!0}),en.HitContext=en.SceneContext=en.Context=void 0;const t=ce(),e=zt();function i(O){const y=[],f=O.length,w=t.Util;for(let P=0;P<f;P++){let I=O[P];w._isNumber(I)?I=Math.round(I*1e3)/1e3:w._isString(I)||(I=I+""),y.push(I)}return y}const s=",",a="(",o=")",c="([",l="])",h=";",g="()",d="=",b=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],_=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],p=100;let v=class{constructor(y){this.canvas=y,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(y){y.fillEnabled()&&this._fill(y)}_fill(y){}strokeShape(y){y.hasStroke()&&this._stroke(y)}_stroke(y){}fillStrokeShape(y){y.attrs.fillAfterStrokeEnabled?(this.strokeShape(y),this.fillShape(y)):(this.fillShape(y),this.strokeShape(y))}getTrace(y,f){let w=this.traceArr,P=w.length,I="",q,A,k,F;for(q=0;q<P;q++)A=w[q],k=A.method,k?(F=A.args,I+=k,y?I+=g:t.Util._isArray(F[0])?I+=c+F.join(s)+l:(f&&(F=F.map(M=>typeof M=="number"?Math.floor(M):M)),I+=a+F.join(s)+o)):(I+=A.property,y||(I+=d+A.val)),I+=h;return I}clearTrace(){this.traceArr=[]}_trace(y){let f=this.traceArr,w;f.push(y),w=f.length,w>=p&&f.shift()}reset(){const y=this.getCanvas().getPixelRatio();this.setTransform(1*y,0,0,1*y,0,0)}getCanvas(){return this.canvas}clear(y){const f=this.getCanvas();y?this.clearRect(y.x||0,y.y||0,y.width||0,y.height||0):this.clearRect(0,0,f.getWidth()/f.pixelRatio,f.getHeight()/f.pixelRatio)}_applyLineCap(y){const f=y.attrs.lineCap;f&&this.setAttr("lineCap",f)}_applyOpacity(y){const f=y.getAbsoluteOpacity();f!==1&&this.setAttr("globalAlpha",f)}_applyLineJoin(y){const f=y.attrs.lineJoin;f&&this.setAttr("lineJoin",f)}setAttr(y,f){this._context[y]=f}arc(y,f,w,P,I,q){this._context.arc(y,f,w,P,I,q)}arcTo(y,f,w,P,I){this._context.arcTo(y,f,w,P,I)}beginPath(){this._context.beginPath()}bezierCurveTo(y,f,w,P,I,q){this._context.bezierCurveTo(y,f,w,P,I,q)}clearRect(y,f,w,P){this._context.clearRect(y,f,w,P)}clip(...y){this._context.clip.apply(this._context,y)}closePath(){this._context.closePath()}createImageData(y,f){const w=arguments;if(w.length===2)return this._context.createImageData(y,f);if(w.length===1)return this._context.createImageData(y)}createLinearGradient(y,f,w,P){return this._context.createLinearGradient(y,f,w,P)}createPattern(y,f){return this._context.createPattern(y,f)}createRadialGradient(y,f,w,P,I,q){return this._context.createRadialGradient(y,f,w,P,I,q)}drawImage(y,f,w,P,I,q,A,k,F){const M=arguments,K=this._context;M.length===3?K.drawImage(y,f,w):M.length===5?K.drawImage(y,f,w,P,I):M.length===9&&K.drawImage(y,f,w,P,I,q,A,k,F)}ellipse(y,f,w,P,I,q,A,k){this._context.ellipse(y,f,w,P,I,q,A,k)}isPointInPath(y,f,w,P){return w?this._context.isPointInPath(w,y,f,P):this._context.isPointInPath(y,f,P)}fill(...y){this._context.fill.apply(this._context,y)}fillRect(y,f,w,P){this._context.fillRect(y,f,w,P)}strokeRect(y,f,w,P){this._context.strokeRect(y,f,w,P)}fillText(y,f,w,P){P?this._context.fillText(y,f,w,P):this._context.fillText(y,f,w)}measureText(y){return this._context.measureText(y)}getImageData(y,f,w,P){return this._context.getImageData(y,f,w,P)}lineTo(y,f){this._context.lineTo(y,f)}moveTo(y,f){this._context.moveTo(y,f)}rect(y,f,w,P){this._context.rect(y,f,w,P)}roundRect(y,f,w,P,I){this._context.roundRect(y,f,w,P,I)}putImageData(y,f,w){this._context.putImageData(y,f,w)}quadraticCurveTo(y,f,w,P){this._context.quadraticCurveTo(y,f,w,P)}restore(){this._context.restore()}rotate(y){this._context.rotate(y)}save(){this._context.save()}scale(y,f){this._context.scale(y,f)}setLineDash(y){this._context.setLineDash?this._context.setLineDash(y):"mozDash"in this._context?this._context.mozDash=y:"webkitLineDash"in this._context&&(this._context.webkitLineDash=y)}getLineDash(){return this._context.getLineDash()}setTransform(y,f,w,P,I,q){this._context.setTransform(y,f,w,P,I,q)}stroke(y){y?this._context.stroke(y):this._context.stroke()}strokeText(y,f,w,P){this._context.strokeText(y,f,w,P)}transform(y,f,w,P,I,q){this._context.transform(y,f,w,P,I,q)}translate(y,f){this._context.translate(y,f)}_enableTrace(){let y=this,f=b.length,w=this.setAttr,P,I;const q=function(A){let k=y[A],F;y[A]=function(){return I=i(Array.prototype.slice.call(arguments,0)),F=k.apply(y,arguments),y._trace({method:A,args:I}),F}};for(P=0;P<f;P++)q(b[P]);y.setAttr=function(){w.apply(y,arguments);const A=arguments[0];let k=arguments[1];(A==="shadowOffsetX"||A==="shadowOffsetY"||A==="shadowBlur")&&(k=k/this.canvas.getPixelRatio()),y._trace({property:A,val:k})}}_applyGlobalCompositeOperation(y){const f=y.attrs.globalCompositeOperation;!f||f==="source-over"||this.setAttr("globalCompositeOperation",f)}};en.Context=v,_.forEach(function(O){Object.defineProperty(v.prototype,O,{get(){return this._context[O]},set(y){this._context[O]=y}})});class S extends v{constructor(y,{willReadFrequently:f=!1}={}){super(y),this._context=y._canvas.getContext("2d",{willReadFrequently:f})}_fillColor(y){const f=y.fill();this.setAttr("fillStyle",f),y._fillFunc(this)}_fillPattern(y){this.setAttr("fillStyle",y._getFillPattern()),y._fillFunc(this)}_fillLinearGradient(y){const f=y._getLinearGradient();f&&(this.setAttr("fillStyle",f),y._fillFunc(this))}_fillRadialGradient(y){const f=y._getRadialGradient();f&&(this.setAttr("fillStyle",f),y._fillFunc(this))}_fill(y){const f=y.fill(),w=y.getFillPriority();if(f&&w==="color"){this._fillColor(y);return}const P=y.getFillPatternImage();if(P&&w==="pattern"){this._fillPattern(y);return}const I=y.getFillLinearGradientColorStops();if(I&&w==="linear-gradient"){this._fillLinearGradient(y);return}const q=y.getFillRadialGradientColorStops();if(q&&w==="radial-gradient"){this._fillRadialGradient(y);return}f?this._fillColor(y):P?this._fillPattern(y):I?this._fillLinearGradient(y):q&&this._fillRadialGradient(y)}_strokeLinearGradient(y){const f=y.getStrokeLinearGradientStartPoint(),w=y.getStrokeLinearGradientEndPoint(),P=y.getStrokeLinearGradientColorStops(),I=this.createLinearGradient(f.x,f.y,w.x,w.y);if(P){for(let q=0;q<P.length;q+=2)I.addColorStop(P[q],P[q+1]);this.setAttr("strokeStyle",I)}}_stroke(y){const f=y.dash(),w=y.getStrokeScaleEnabled();if(y.hasStroke()){if(!w){this.save();const I=this.getCanvas().getPixelRatio();this.setTransform(I,0,0,I,0,0)}this._applyLineCap(y),f&&y.dashEnabled()&&(this.setLineDash(f),this.setAttr("lineDashOffset",y.dashOffset())),this.setAttr("lineWidth",y.strokeWidth()),y.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),y.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(y):this.setAttr("strokeStyle",y.stroke()),y._strokeFunc(this),w||this.restore()}}_applyShadow(y){var f,w,P;const I=(f=y.getShadowRGBA())!==null&&f!==void 0?f:"black",q=(w=y.getShadowBlur())!==null&&w!==void 0?w:5,A=(P=y.getShadowOffset())!==null&&P!==void 0?P:{x:0,y:0},k=y.getAbsoluteScale(),F=this.canvas.getPixelRatio(),M=k.x*F,K=k.y*F;this.setAttr("shadowColor",I),this.setAttr("shadowBlur",q*Math.min(Math.abs(M),Math.abs(K))),this.setAttr("shadowOffsetX",A.x*M),this.setAttr("shadowOffsetY",A.y*K)}}en.SceneContext=S;class E extends v{constructor(y){super(y),this._context=y._canvas.getContext("2d",{willReadFrequently:!0})}_fill(y){this.save(),this.setAttr("fillStyle",y.colorKey),y._fillFuncHit(this),this.restore()}strokeShape(y){y.hasHitStroke()&&this._stroke(y)}_stroke(y){if(y.hasHitStroke()){const f=y.getStrokeScaleEnabled();if(!f){this.save();const I=this.getCanvas().getPixelRatio();this.setTransform(I,0,0,I,0,0)}this._applyLineCap(y);const w=y.hitStrokeWidth(),P=w==="auto"?y.strokeWidth():w;this.setAttr("lineWidth",P),this.setAttr("strokeStyle",y.colorKey),y._strokeFuncHit(this),f||this.restore()}}}return en.HitContext=E,en}var ll;function us(){if(ll)return tn;ll=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.HitCanvas=tn.SceneCanvas=tn.Canvas=void 0;const t=ce(),e=lu(),i=zt();let s;function a(){if(s)return s;const h=t.Util.createCanvasElement(),g=h.getContext("2d");return s=(function(){const d=i.Konva._global.devicePixelRatio||1,b=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;return d/b})(),t.Util.releaseCanvas(h),s}let o=class{constructor(g){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const b=(g||{}).pixelRatio||i.Konva.pixelRatio||a();this.pixelRatio=b,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(g){const d=this.pixelRatio;this.pixelRatio=g,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(g){this.width=this._canvas.width=g*this.pixelRatio,this._canvas.style.width=g+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(g){this.height=this._canvas.height=g*this.pixelRatio,this._canvas.style.height=g+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(g,d){this.setWidth(g||0),this.setHeight(d||0)}toDataURL(g,d){try{return this._canvas.toDataURL(g,d)}catch{try{return this._canvas.toDataURL()}catch(_){return t.Util.error("Unable to get data URL. "+_.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};tn.Canvas=o;class c extends o{constructor(g={width:0,height:0,willReadFrequently:!1}){super(g),this.context=new e.SceneContext(this,{willReadFrequently:g.willReadFrequently}),this.setSize(g.width,g.height)}}tn.SceneCanvas=c;class l extends o{constructor(g={width:0,height:0}){super(g),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(g.width,g.height)}}return tn.HitCanvas=l,tn}var ro={},cl;function Yo(){return cl||(cl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=zt(),i=ce();t.DD={get isDragging(){let s=!1;return t.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(s=!0)}),s},justDragged:!1,get node(){let s;return t.DD._dragElements.forEach(a=>{s=a.node}),s},_dragElements:new Map,_drag(s){const a=[];t.DD._dragElements.forEach((o,c)=>{const{node:l}=o,h=l.getStage();h.setPointersPositions(s),o.pointerId===void 0&&(o.pointerId=i.Util._getFirstPointerId(s));const g=h._changedPointerPositions.find(d=>d.id===o.pointerId);if(g){if(o.dragStatus!=="dragging"){const d=l.dragDistance();if(Math.max(Math.abs(g.x-o.startPointerPos.x),Math.abs(g.y-o.startPointerPos.y))<d||(l.startDrag({evt:s}),!l.isDragging()))return}l._setDragPosition(s,o),a.push(l)}}),a.forEach(o=>{o.fire("dragmove",{type:"dragmove",target:o,evt:s},!0)})},_endDragBefore(s){const a=[];t.DD._dragElements.forEach(o=>{const{node:c}=o,l=c.getStage();if(s&&l.setPointersPositions(s),!l._changedPointerPositions.find(d=>d.id===o.pointerId))return;(o.dragStatus==="dragging"||o.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,o.dragStatus="stopped");const g=o.node.getLayer()||o.node instanceof e.Konva.Stage&&o.node;g&&a.indexOf(g)===-1&&a.push(g)}),a.forEach(o=>{o.draw()})},_endDragAfter(s){t.DD._dragElements.forEach((a,o)=>{a.dragStatus==="stopped"&&a.node.fire("dragend",{type:"dragend",target:a.node,evt:s},!0),a.dragStatus!=="dragging"&&t.DD._dragElements.delete(o)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(ro)),ro}var io={},Oe={},ul;function Xt(){if(ul)return Oe;ul=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.RGBComponent=s,Oe.alphaComponent=a,Oe.getNumberValidator=o,Oe.getNumberOrArrayOfNumbersValidator=c,Oe.getNumberOrAutoValidator=l,Oe.getStringValidator=h,Oe.getStringOrGradientValidator=g,Oe.getFunctionValidator=d,Oe.getNumberArrayValidator=b,Oe.getBooleanValidator=_,Oe.getComponentValidator=p;const t=zt(),e=ce();function i(v){return e.Util._isString(v)?'"'+v+'"':Object.prototype.toString.call(v)==="[object Number]"||e.Util._isBoolean(v)?v:Object.prototype.toString.call(v)}function s(v){return v>255?255:v<0?0:Math.round(v)}function a(v){return v>1?1:v<1e-4?1e-4:v}function o(){if(t.Konva.isUnminified)return function(v,S){return e.Util._isNumber(v)||e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a number.'),v}}function c(v){if(t.Konva.isUnminified)return function(S,E){let O=e.Util._isNumber(S),y=e.Util._isArray(S)&&S.length==v;return!O&&!y&&e.Util.warn(i(S)+' is a not valid value for "'+E+'" attribute. The value should be a number or Array<number>('+v+")"),S}}function l(){if(t.Konva.isUnminified)return function(v,S){return e.Util._isNumber(v)||v==="auto"||e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a number or "auto".'),v}}function h(){if(t.Konva.isUnminified)return function(v,S){return e.Util._isString(v)||e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a string.'),v}}function g(){if(t.Konva.isUnminified)return function(v,S){const E=e.Util._isString(v),O=Object.prototype.toString.call(v)==="[object CanvasGradient]"||v&&v.addColorStop;return E||O||e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a string or a native gradient.'),v}}function d(){if(t.Konva.isUnminified)return function(v,S){return e.Util._isFunction(v)||e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a function.'),v}}function b(){if(t.Konva.isUnminified)return function(v,S){const E=Int8Array?Object.getPrototypeOf(Int8Array):null;return E&&v instanceof E||(e.Util._isArray(v)?v.forEach(function(O){e.Util._isNumber(O)||e.Util.warn('"'+S+'" attribute has non numeric element '+O+". Make sure that all elements are numbers.")}):e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a array of numbers.')),v}}function _(){if(t.Konva.isUnminified)return function(v,S){return v===!0||v===!1||e.Util.warn(i(v)+' is a not valid value for "'+S+'" attribute. The value should be a boolean.'),v}}function p(v){if(t.Konva.isUnminified)return function(S,E){return S==null||e.Util.isObject(S)||e.Util.warn(i(S)+' is a not valid value for "'+E+'" attribute. The value should be an object with properties '+v),S}}return Oe}var hl;function Yt(){return hl||(hl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=ce(),i=Xt(),s="get",a="set";t.Factory={addGetterSetter(o,c,l,h,g){t.Factory.addGetter(o,c,l),t.Factory.addSetter(o,c,h,g),t.Factory.addOverloadedGetterSetter(o,c)},addGetter(o,c,l){const h=s+e.Util._capitalize(c);o.prototype[h]=o.prototype[h]||function(){const g=this.attrs[c];return g===void 0?l:g}},addSetter(o,c,l,h){const g=a+e.Util._capitalize(c);o.prototype[g]||t.Factory.overWriteSetter(o,c,l,h)},overWriteSetter(o,c,l,h){const g=a+e.Util._capitalize(c);o.prototype[g]=function(d){return l&&d!==void 0&&d!==null&&(d=l.call(this,d,c)),this._setAttr(c,d),h&&h.call(this),this}},addComponentsGetterSetter(o,c,l,h,g){const d=l.length,b=e.Util._capitalize,_=s+b(c),p=a+b(c);o.prototype[_]=function(){const S={};for(let E=0;E<d;E++){const O=l[E];S[O]=this.getAttr(c+b(O))}return S};const v=(0,i.getComponentValidator)(l);o.prototype[p]=function(S){const E=this.attrs[c];h&&(S=h.call(this,S,c)),v&&v.call(this,S,c);for(const O in S)S.hasOwnProperty(O)&&this._setAttr(c+b(O),S[O]);return S||l.forEach(O=>{this._setAttr(c+b(O),void 0)}),this._fireChangeEvent(c,E,S),g&&g.call(this),this},t.Factory.addOverloadedGetterSetter(o,c)},addOverloadedGetterSetter(o,c){const l=e.Util._capitalize(c),h=a+l,g=s+l;o.prototype[c]=function(){return arguments.length?(this[h](arguments[0]),this):this[g]()}},addDeprecatedGetterSetter(o,c,l,h){e.Util.error("Adding deprecated "+c);const g=s+e.Util._capitalize(c),d=c+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[g]=function(){e.Util.error(d);const b=this.attrs[c];return b===void 0?l:b},t.Factory.addSetter(o,c,h,function(){e.Util.error(d)}),t.Factory.addOverloadedGetterSetter(o,c)},backCompat(o,c){e.Util.each(c,function(l,h){const g=o.prototype[h],d=s+e.Util._capitalize(l),b=a+e.Util._capitalize(l);function _(){g.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+h+'" instead.')}o.prototype[l]=_,o.prototype[d]=_,o.prototype[b]=_})},afterSetFilter(){this._filterUpToDate=!1}}})(io)),io}var fl;function de(){if(fl)return pr;fl=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.Node=void 0;const t=us(),e=Yo(),i=Yt(),s=zt(),a=ce(),o=Xt(),c="absoluteOpacity",l="allEventListeners",h="absoluteTransform",g="absoluteScale",d="canvas",b="Change",_="children",p="konva",v="listening",S="mouseenter",E="mouseleave",O="pointerenter",y="pointerleave",f="touchenter",w="touchleave",P="set",I="Shape",q=" ",A="stage",k="transform",F="Stage",M="visible",K=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(q);let W=1,J=class So{constructor(C){this._id=W++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(C),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(C){(C===k||C===h)&&this._cache.get(C)?this._cache.get(C).dirty=!0:C?this._cache.delete(C):this._cache.clear()}_getCache(C,R){let G=this._cache.get(C);return(G===void 0||(C===k||C===h)&&G.dirty===!0)&&(G=R.call(this),this._cache.set(C,G)),G}_calculate(C,R,G){if(!this._attachedDepsListeners.get(C)){const L=R.map(j=>j+"Change.konva").join(q);this.on(L,()=>{this._clearCache(C)}),this._attachedDepsListeners.set(C,!0)}return this._getCache(C,G)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(C){this._clearCache(C),C===h&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:C,filter:R,hit:G,buffer:L}=this._cache.get(d);a.Util.releaseCanvas(C,R,G,L),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(C){const R=C||{};let G={};(R.x===void 0||R.y===void 0||R.width===void 0||R.height===void 0)&&(G=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let L=Math.ceil(R.width||G.width),j=Math.ceil(R.height||G.height),ct=R.pixelRatio,$=R.x===void 0?Math.floor(G.x):R.x,vt=R.y===void 0?Math.floor(G.y):R.y,St=R.offset||0,ot=R.drawBorder||!1,B=R.hitCanvasPixelRatio||1;if(!L||!j){a.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const at=Math.abs(Math.round(G.x)-$)>.5?1:0,ht=Math.abs(Math.round(G.y)-vt)>.5?1:0;L+=St*2+at,j+=St*2+ht,$-=St,vt-=St;const At=new t.SceneCanvas({pixelRatio:ct,width:L,height:j}),Dt=new t.SceneCanvas({pixelRatio:ct,width:0,height:0,willReadFrequently:!0}),N=new t.HitCanvas({pixelRatio:B,width:L,height:j}),V=At.getContext(),st=N.getContext(),ut=new t.SceneCanvas({width:At.width/At.pixelRatio+Math.abs($),height:At.height/At.pixelRatio+Math.abs(vt),pixelRatio:At.pixelRatio}),pt=ut.getContext();return N.isCache=!0,At.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,R.imageSmoothingEnabled===!1&&(At.getContext()._context.imageSmoothingEnabled=!1,Dt.getContext()._context.imageSmoothingEnabled=!1),V.save(),st.save(),pt.save(),V.translate(-$,-vt),st.translate(-$,-vt),pt.translate(-$,-vt),ut.x=$,ut.y=vt,this._isUnderCache=!0,this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(g),this.drawScene(At,this,ut),this.drawHit(N,this),this._isUnderCache=!1,V.restore(),st.restore(),ot&&(V.save(),V.beginPath(),V.rect(0,0,L,j),V.closePath(),V.setAttr("strokeStyle","red"),V.setAttr("lineWidth",5),V.stroke(),V.restore()),this._cache.set(d,{scene:At,filter:Dt,hit:N,buffer:ut,x:$,y:vt}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(C){throw new Error('abstract "getClientRect" method call')}_transformedRect(C,R){const G=[{x:C.x,y:C.y},{x:C.x+C.width,y:C.y},{x:C.x+C.width,y:C.y+C.height},{x:C.x,y:C.y+C.height}];let L=1/0,j=1/0,ct=-1/0,$=-1/0;const vt=this.getAbsoluteTransform(R);return G.forEach(function(St){const ot=vt.point(St);L===void 0&&(L=ct=ot.x,j=$=ot.y),L=Math.min(L,ot.x),j=Math.min(j,ot.y),ct=Math.max(ct,ot.x),$=Math.max($,ot.y)}),{x:L,y:j,width:ct-L,height:$-j}}_drawCachedSceneCanvas(C){C.save(),C._applyOpacity(this),C._applyGlobalCompositeOperation(this);const R=this._getCanvasCache();C.translate(R.x,R.y);const G=this._getCachedSceneCanvas(),L=G.pixelRatio;C.drawImage(G._canvas,0,0,G.width/L,G.height/L),C.restore()}_drawCachedHitCanvas(C){const R=this._getCanvasCache(),G=R.hit;C.save(),C.translate(R.x,R.y),C.drawImage(G._canvas,0,0,G.width/G.pixelRatio,G.height/G.pixelRatio),C.restore()}_getCachedSceneCanvas(){let C=this.filters(),R=this._getCanvasCache(),G=R.scene,L=R.filter,j=L.getContext(),ct,$,vt,St;if(C){if(!this._filterUpToDate){const ot=G.pixelRatio;L.setSize(G.width/G.pixelRatio,G.height/G.pixelRatio);try{for(ct=C.length,j.clear(),j.drawImage(G._canvas,0,0,G.getWidth()/ot,G.getHeight()/ot),$=j.getImageData(0,0,L.getWidth(),L.getHeight()),vt=0;vt<ct;vt++){if(St=C[vt],typeof St!="function"){a.Util.error("Filter should be type of function, but got "+typeof St+" instead. Please check correct filters");continue}St.call(this,$),j.putImageData($,0,0)}}catch(B){a.Util.error("Unable to apply filter. "+B.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return L}return G}on(C,R){if(this._cache&&this._cache.delete(l),arguments.length===3)return this._delegate.apply(this,arguments);const G=C.split(q);for(let L=0;L<G.length;L++){const ct=G[L].split("."),$=ct[0],vt=ct[1]||"";this.eventListeners[$]||(this.eventListeners[$]=[]),this.eventListeners[$].push({name:vt,handler:R})}return this}off(C,R){let G=(C||"").split(q),L=G.length,j,ct,$,vt,St,ot;if(this._cache&&this._cache.delete(l),!C)for(ct in this.eventListeners)this._off(ct);for(j=0;j<L;j++)if($=G[j],vt=$.split("."),St=vt[0],ot=vt[1],St)this.eventListeners[St]&&this._off(St,ot,R);else for(ct in this.eventListeners)this._off(ct,ot,R);return this}dispatchEvent(C){const R={target:this,type:C.type,evt:C};return this.fire(C.type,R),this}addEventListener(C,R){return this.on(C,function(G){R.call(this,G.evt)}),this}removeEventListener(C){return this.off(C),this}_delegate(C,R,G){const L=this;this.on(C,function(j){const ct=j.target.findAncestors(R,!0,L);for(let $=0;$<ct.length;$++)j=a.Util.cloneObject(j),j.currentTarget=ct[$],G.call(ct[$],j)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(g),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(M),this._clearSelfAndDescendantCache(v)}_remove(){this._clearCaches();const C=this.getParent();C&&C.children&&(C.children.splice(this.index,1),C._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(C){const R="get"+a.Util._capitalize(C);return a.Util._isFunction(this[R])?this[R]():this.attrs[C]}getAncestors(){let C=this.getParent(),R=[];for(;C;)R.push(C),C=C.getParent();return R}getAttrs(){return this.attrs||{}}setAttrs(C){return this._batchTransformChanges(()=>{let R,G;if(!C)return this;for(R in C)R!==_&&(G=P+a.Util._capitalize(R),a.Util._isFunction(this[G])?this[G](C[R]):this._setAttr(R,C[R]))}),this}isListening(){return this._getCache(v,this._isListening)}_isListening(C){if(!this.listening())return!1;const G=this.getParent();return G&&G!==C&&this!==C?G._isListening(C):!0}isVisible(){return this._getCache(M,this._isVisible)}_isVisible(C){if(!this.visible())return!1;const G=this.getParent();return G&&G!==C&&this!==C?G._isVisible(C):!0}shouldDrawHit(C,R=!1){if(C)return this._isVisible(C)&&this._isListening(C);const G=this.getLayer();let L=!1;e.DD._dragElements.forEach(ct=>{ct.dragStatus==="dragging"&&(ct.node.nodeType==="Stage"||ct.node.getLayer()===G)&&(L=!0)});const j=!R&&!s.Konva.hitOnDragEnabled&&(L||s.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!j}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let C=this.getDepth(),R=this,G=0,L,j,ct,$;function vt(ot){for(L=[],j=ot.length,ct=0;ct<j;ct++)$=ot[ct],G++,$.nodeType!==I&&(L=L.concat($.getChildren().slice())),$._id===R._id&&(ct=j);L.length>0&&L[0].getDepth()<=C&&vt(L)}const St=this.getStage();return R.nodeType!==F&&St&&vt(St.getChildren()),G}getDepth(){let C=0,R=this.parent;for(;R;)C++,R=R.parent;return C}_batchTransformChanges(C){this._batchingTransformChange=!0,C(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(k),this._clearSelfAndDescendantCache(h)),this._needClearTransformCache=!1}setPosition(C){return this._batchTransformChanges(()=>{this.x(C.x),this.y(C.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const C=this.getStage();if(!C)return null;const R=C.getPointerPosition();if(!R)return null;const G=this.getAbsoluteTransform().copy();return G.invert(),G.point(R)}getAbsolutePosition(C){let R=!1,G=this.parent;for(;G;){if(G.isCached()){R=!0;break}G=G.parent}R&&!C&&(C=!0);const L=this.getAbsoluteTransform(C).getMatrix(),j=new a.Transform,ct=this.offset();return j.m=L.slice(),j.translate(ct.x,ct.y),j.getTranslation()}setAbsolutePosition(C){const{x:R,y:G,...L}=this._clearTransform();this.attrs.x=R,this.attrs.y=G,this._clearCache(k);const j=this._getAbsoluteTransform().copy();return j.invert(),j.translate(C.x,C.y),C={x:this.attrs.x+j.getTranslation().x,y:this.attrs.y+j.getTranslation().y},this._setTransform(L),this.setPosition({x:C.x,y:C.y}),this._clearCache(k),this._clearSelfAndDescendantCache(h),this}_setTransform(C){let R;for(R in C)this.attrs[R]=C[R]}_clearTransform(){const C={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,C}move(C){let R=C.x,G=C.y,L=this.x(),j=this.y();return R!==void 0&&(L+=R),G!==void 0&&(j+=G),this.setPosition({x:L,y:j}),this}_eachAncestorReverse(C,R){let G=[],L=this.getParent(),j,ct;if(!(R&&R._id===this._id)){for(G.unshift(this);L&&(!R||L._id!==R._id);)G.unshift(L),L=L.parent;for(j=G.length,ct=0;ct<j;ct++)C(G[ct])}}rotate(C){return this.rotation(this.rotation()+C),this}moveToTop(){if(!this.parent)return a.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const C=this.index,R=this.parent.getChildren().length;return C<R-1?(this.parent.children.splice(C,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return a.Util.warn("Node has no parent. moveUp function is ignored."),!1;const C=this.index,R=this.parent.getChildren().length;return C<R-1?(this.parent.children.splice(C,1),this.parent.children.splice(C+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return a.Util.warn("Node has no parent. moveDown function is ignored."),!1;const C=this.index;return C>0?(this.parent.children.splice(C,1),this.parent.children.splice(C-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return a.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const C=this.index;return C>0?(this.parent.children.splice(C,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(C){if(!this.parent)return a.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(C<0||C>=this.parent.children.length)&&a.Util.warn("Unexpected value "+C+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const R=this.index;return this.parent.children.splice(R,1),this.parent.children.splice(C,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(c,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let C=this.opacity();const R=this.getParent();return R&&!R._isUnderCache&&(C*=R.getAbsoluteOpacity()),C}moveTo(C){return this.getParent()!==C&&(this._remove(),C.add(this)),this}toObject(){let C=this.getAttrs(),R,G,L,j,ct;const $={attrs:{},className:this.getClassName()};for(R in C)G=C[R],ct=a.Util.isObject(G)&&!a.Util._isPlainObject(G)&&!a.Util._isArray(G),!ct&&(L=typeof this[R]=="function"&&this[R],delete C[R],j=L?L.call(this):null,C[R]=G,j!==G&&($.attrs[R]=G));return a.Util._prepareToStringify($)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(C,R,G){const L=[];R&&this._isMatch(C)&&L.push(this);let j=this.parent;for(;j;){if(j===G)return L;j._isMatch(C)&&L.push(j),j=j.parent}return L}isAncestorOf(C){return!1}findAncestor(C,R,G){return this.findAncestors(C,R,G)[0]}_isMatch(C){if(!C)return!1;if(typeof C=="function")return C(this);let R=C.replace(/ /g,"").split(","),G=R.length,L,j;for(L=0;L<G;L++)if(j=R[L],a.Util.isValidSelector(j)||(a.Util.warn('Selector "'+j+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),a.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),a.Util.warn("Konva is awesome, right?")),j.charAt(0)==="#"){if(this.id()===j.slice(1))return!0}else if(j.charAt(0)==="."){if(this.hasName(j.slice(1)))return!0}else if(this.className===j||this.nodeType===j)return!0;return!1}getLayer(){const C=this.getParent();return C?C.getLayer():null}getStage(){return this._getCache(A,this._getStage)}_getStage(){const C=this.getParent();return C?C.getStage():null}fire(C,R={},G){return R.target=R.target||this,G?this._fireAndBubble(C,R):this._fire(C,R),this}getAbsoluteTransform(C){return C?this._getAbsoluteTransform(C):this._getCache(h,this._getAbsoluteTransform)}_getAbsoluteTransform(C){let R;if(C)return R=new a.Transform,this._eachAncestorReverse(function(G){const L=G.transformsEnabled();L==="all"?R.multiply(G.getTransform()):L==="position"&&R.translate(G.x()-G.offsetX(),G.y()-G.offsetY())},C),R;{R=this._cache.get(h)||new a.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(R):R.reset();const G=this.transformsEnabled();if(G==="all")R.multiply(this.getTransform());else if(G==="position"){const L=this.attrs.x||0,j=this.attrs.y||0,ct=this.attrs.offsetX||0,$=this.attrs.offsetY||0;R.translate(L-ct,j-$)}return R.dirty=!1,R}}getAbsoluteScale(C){let R=this;for(;R;)R._isUnderCache&&(C=R),R=R.getParent();const L=this.getAbsoluteTransform(C).decompose();return{x:L.scaleX,y:L.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(k,this._getTransform)}_getTransform(){var C,R;const G=this._cache.get(k)||new a.Transform;G.reset();const L=this.x(),j=this.y(),ct=s.Konva.getAngle(this.rotation()),$=(C=this.attrs.scaleX)!==null&&C!==void 0?C:1,vt=(R=this.attrs.scaleY)!==null&&R!==void 0?R:1,St=this.attrs.skewX||0,ot=this.attrs.skewY||0,B=this.attrs.offsetX||0,at=this.attrs.offsetY||0;return(L!==0||j!==0)&&G.translate(L,j),ct!==0&&G.rotate(ct),(St!==0||ot!==0)&&G.skew(St,ot),($!==1||vt!==1)&&G.scale($,vt),(B!==0||at!==0)&&G.translate(-1*B,-1*at),G.dirty=!1,G}clone(C){let R=a.Util.cloneObject(this.attrs),G,L,j,ct,$;for(G in C)R[G]=C[G];const vt=new this.constructor(R);for(G in this.eventListeners)for(L=this.eventListeners[G],j=L.length,ct=0;ct<j;ct++)$=L[ct],$.name.indexOf(p)<0&&(vt.eventListeners[G]||(vt.eventListeners[G]=[]),vt.eventListeners[G].push($));return vt}_toKonvaCanvas(C){C=C||{};const R=this.getClientRect(),G=this.getStage(),L=C.x!==void 0?C.x:Math.floor(R.x),j=C.y!==void 0?C.y:Math.floor(R.y),ct=C.pixelRatio||1,$=new t.SceneCanvas({width:C.width||Math.ceil(R.width)||(G?G.width():0),height:C.height||Math.ceil(R.height)||(G?G.height():0),pixelRatio:ct}),vt=$.getContext(),St=new t.SceneCanvas({width:$.width/$.pixelRatio+Math.abs(L),height:$.height/$.pixelRatio+Math.abs(j),pixelRatio:$.pixelRatio});return C.imageSmoothingEnabled===!1&&(vt._context.imageSmoothingEnabled=!1),vt.save(),(L||j)&&vt.translate(-1*L,-1*j),this.drawScene($,void 0,St),vt.restore(),$}toCanvas(C){return this._toKonvaCanvas(C)._canvas}toDataURL(C){C=C||{};const R=C.mimeType||null,G=C.quality||null,L=this._toKonvaCanvas(C).toDataURL(R,G);return C.callback&&C.callback(L),L}toImage(C){return new Promise((R,G)=>{try{const L=C==null?void 0:C.callback;L&&delete C.callback,a.Util._urlToImage(this.toDataURL(C),function(j){R(j),L==null||L(j)})}catch(L){G(L)}})}toBlob(C){return new Promise((R,G)=>{try{const L=C==null?void 0:C.callback;L&&delete C.callback,this.toCanvas(C).toBlob(j=>{R(j),L==null||L(j)},C==null?void 0:C.mimeType,C==null?void 0:C.quality)}catch(L){G(L)}})}setSize(C){return this.width(C.width),this.height(C.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():s.Konva.dragDistance}_off(C,R,G){let L=this.eventListeners[C],j,ct,$;for(j=0;j<L.length;j++)if(ct=L[j].name,$=L[j].handler,(ct!=="konva"||R==="konva")&&(!R||ct===R)&&(!G||G===$)){if(L.splice(j,1),L.length===0){delete this.eventListeners[C];break}j--}}_fireChangeEvent(C,R,G){this._fire(C+b,{oldVal:R,newVal:G})}addName(C){if(!this.hasName(C)){const R=this.name(),G=R?R+" "+C:C;this.name(G)}return this}hasName(C){if(!C)return!1;const R=this.name();return R?(R||"").split(/\s/g).indexOf(C)!==-1:!1}removeName(C){const R=(this.name()||"").split(/\s/g),G=R.indexOf(C);return G!==-1&&(R.splice(G,1),this.name(R.join(" "))),this}setAttr(C,R){const G=this[P+a.Util._capitalize(C)];return a.Util._isFunction(G)?G.call(this,R):this._setAttr(C,R),this}_requestDraw(){if(s.Konva.autoDrawEnabled){const C=this.getLayer()||this.getStage();C==null||C.batchDraw()}}_setAttr(C,R){const G=this.attrs[C];G===R&&!a.Util.isObject(R)||(R==null?delete this.attrs[C]:this.attrs[C]=R,this._shouldFireChangeEvents&&this._fireChangeEvent(C,G,R),this._requestDraw())}_setComponentAttr(C,R,G){let L;G!==void 0&&(L=this.attrs[C],L||(this.attrs[C]=this.getAttr(C)),this.attrs[C][R]=G,this._fireChangeEvent(C,L,G))}_fireAndBubble(C,R,G){R&&this.nodeType===I&&(R.target=this);const L=[S,E,O,y,f,w];if(!(L.indexOf(C)!==-1&&(G&&(this===G||this.isAncestorOf&&this.isAncestorOf(G))||this.nodeType==="Stage"&&!G))){this._fire(C,R);const ct=L.indexOf(C)!==-1&&G&&G.isAncestorOf&&G.isAncestorOf(this)&&!G.isAncestorOf(this.parent);(R&&!R.cancelBubble||!R)&&this.parent&&this.parent.isListening()&&!ct&&(G&&G.parent?this._fireAndBubble.call(this.parent,C,R,G):this._fireAndBubble.call(this.parent,C,R))}}_getProtoListeners(C){var R,G,L;const j=(R=this._cache.get(l))!==null&&R!==void 0?R:{};let ct=j==null?void 0:j[C];if(ct===void 0){ct=[];let $=Object.getPrototypeOf(this);for(;$;){const vt=(L=(G=$.eventListeners)===null||G===void 0?void 0:G[C])!==null&&L!==void 0?L:[];ct.push(...vt),$=Object.getPrototypeOf($)}j[C]=ct,this._cache.set(l,j)}return ct}_fire(C,R){R=R||{},R.currentTarget=this,R.type=C;const G=this._getProtoListeners(C);if(G)for(let j=0;j<G.length;j++)G[j].handler.call(this,R);const L=this.eventListeners[C];if(L)for(let j=0;j<L.length;j++)L[j].handler.call(this,R)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(C){const R=C?C.pointerId:void 0,G=this.getStage(),L=this.getAbsolutePosition();if(!G)return;const j=G._getPointerById(R)||G._changedPointerPositions[0]||L;e.DD._dragElements.set(this._id,{node:this,startPointerPos:j,offset:{x:j.x-L.x,y:j.y-L.y},dragStatus:"ready",pointerId:R})}startDrag(C,R=!0){e.DD._dragElements.has(this._id)||this._createDragElement(C);const G=e.DD._dragElements.get(this._id);G.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:C&&C.evt},R)}_setDragPosition(C,R){const G=this.getStage()._getPointerById(R.pointerId);if(!G)return;let L={x:G.x-R.offset.x,y:G.y-R.offset.y};const j=this.dragBoundFunc();if(j!==void 0){const ct=j.call(this,L,C);ct?L=ct:a.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==L.x||this._lastPos.y!==L.y)&&(this.setAbsolutePosition(L),this._requestDraw()),this._lastPos=L}stopDrag(C){const R=e.DD._dragElements.get(this._id);R&&(R.dragStatus="stopped"),e.DD._endDragBefore(C),e.DD._endDragAfter(C)}setDraggable(C){this._setAttr("draggable",C),this._dragChange()}isDragging(){const C=e.DD._dragElements.get(this._id);return C?C.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(C){if(!(!(C.evt.button!==void 0)||s.Konva.dragButtons.indexOf(C.evt.button)>=0)||this.isDragging())return;let L=!1;e.DD._dragElements.forEach(j=>{this.isAncestorOf(j.node)&&(L=!0)}),L||this._createDragElement(C)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const R=e.DD._dragElements.get(this._id),G=R&&R.dragStatus==="dragging",L=R&&R.dragStatus==="ready";G?this.stopDrag():L&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(C={x:0,y:0}){const R=this.getStage();if(!R)return!1;const G={x:-C.x,y:-C.y,width:R.width()+2*C.x,height:R.height()+2*C.y};return a.Util.haveIntersection(G,this.getClientRect())}static create(C,R){return a.Util._isString(C)&&(C=JSON.parse(C)),this._createNode(C,R)}static _createNode(C,R){let G=So.prototype.getClassName.call(C),L=C.children,j,ct,$;R&&(C.attrs.container=R),s.Konva[G]||(a.Util.warn('Can not find a node with class name "'+G+'". Fallback to "Shape".'),G="Shape");const vt=s.Konva[G];if(j=new vt(C.attrs),L)for(ct=L.length,$=0;$<ct;$++)j.add(So._createNode(L[$]));return j}};pr.Node=J,J.prototype.nodeType="Node",J.prototype._attrsAffectingSize=[],J.prototype.eventListeners={},J.prototype.on.call(J.prototype,K,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(k),this._clearSelfAndDescendantCache(h)}),J.prototype.on.call(J.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(M)}),J.prototype.on.call(J.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(v)}),J.prototype.on.call(J.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(c)});const z=i.Factory.addGetterSetter;return z(J,"zIndex"),z(J,"absolutePosition"),z(J,"position"),z(J,"x",0,(0,o.getNumberValidator)()),z(J,"y",0,(0,o.getNumberValidator)()),z(J,"globalCompositeOperation","source-over",(0,o.getStringValidator)()),z(J,"opacity",1,(0,o.getNumberValidator)()),z(J,"name","",(0,o.getStringValidator)()),z(J,"id","",(0,o.getStringValidator)()),z(J,"rotation",0,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(J,"scale",["x","y"]),z(J,"scaleX",1,(0,o.getNumberValidator)()),z(J,"scaleY",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(J,"skew",["x","y"]),z(J,"skewX",0,(0,o.getNumberValidator)()),z(J,"skewY",0,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(J,"offset",["x","y"]),z(J,"offsetX",0,(0,o.getNumberValidator)()),z(J,"offsetY",0,(0,o.getNumberValidator)()),z(J,"dragDistance",void 0,(0,o.getNumberValidator)()),z(J,"width",0,(0,o.getNumberValidator)()),z(J,"height",0,(0,o.getNumberValidator)()),z(J,"listening",!0,(0,o.getBooleanValidator)()),z(J,"preventDefault",!0,(0,o.getBooleanValidator)()),z(J,"filters",void 0,function(ft){return this._filterUpToDate=!1,ft}),z(J,"visible",!0,(0,o.getBooleanValidator)()),z(J,"transformsEnabled","all",(0,o.getStringValidator)()),z(J,"size"),z(J,"dragBoundFunc"),z(J,"draggable",!1,(0,o.getBooleanValidator)()),i.Factory.backCompat(J,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),pr}var mr={},dl;function hs(){if(dl)return mr;dl=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.Container=void 0;const t=Yt(),e=de(),i=Xt();let s=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(o){const c=this.children||[];return o?c.filter(o):c}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.destroy()}),this.children=[],this._requestDraw(),this}add(...o){if(o.length===0)return this;if(o.length>1){for(let l=0;l<o.length;l++)this.add(o[l]);return this}const c=o[0];return c.getParent()?(c.moveTo(this),this):(this._validateAdd(c),c.index=this.getChildren().length,c.parent=this,c._clearCaches(),this.getChildren().push(c),this._fire("add",{child:c}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(o){return this._generalFind(o,!1)}findOne(o){const c=this._generalFind(o,!0);return c.length>0?c[0]:void 0}_generalFind(o,c){const l=[];return this._descendants(h=>{const g=h._isMatch(o);return g&&l.push(h),!!(g&&c)}),l}_descendants(o){let c=!1;const l=this.getChildren();for(const h of l){if(c=o(h),c)return!0;if(h.hasChildren()&&(c=h._descendants(o),c))return!0}return!1}toObject(){const o=e.Node.prototype.toObject.call(this);return o.children=[],this.getChildren().forEach(c=>{o.children.push(c.toObject())}),o}isAncestorOf(o){let c=o.getParent();for(;c;){if(c._id===this._id)return!0;c=c.getParent()}return!1}clone(o){const c=e.Node.prototype.clone.call(this,o);return this.getChildren().forEach(function(l){c.add(l.clone())}),c}getAllIntersections(o){const c=[];return this.find("Shape").forEach(l=>{l.isVisible()&&l.intersects(o)&&c.push(l)}),c}_clearSelfAndDescendantCache(o){var c;super._clearSelfAndDescendantCache(o),!this.isCached()&&((c=this.children)===null||c===void 0||c.forEach(function(l){l._clearSelfAndDescendantCache(o)}))}_setChildrenIndices(){var o;(o=this.children)===null||o===void 0||o.forEach(function(c,l){c.index=l}),this._requestDraw()}drawScene(o,c,l){const h=this.getLayer(),g=o||h&&h.getCanvas(),d=g&&g.getContext(),b=this._getCanvasCache(),_=b&&b.scene,p=g&&g.isCache;if(!this.isVisible()&&!p)return this;if(_){d.save();const v=this.getAbsoluteTransform(c).getMatrix();d.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",g,c,l);return this}drawHit(o,c){if(!this.shouldDrawHit(c))return this;const l=this.getLayer(),h=o||l&&l.hitCanvas,g=h&&h.getContext(),d=this._getCanvasCache();if(d&&d.hit){g.save();const _=this.getAbsoluteTransform(c).getMatrix();g.transform(_[0],_[1],_[2],_[3],_[4],_[5]),this._drawCachedHitCanvas(g),g.restore()}else this._drawChildren("drawHit",h,c);return this}_drawChildren(o,c,l,h){var g;const d=c&&c.getContext(),b=this.clipWidth(),_=this.clipHeight(),p=this.clipFunc(),v=typeof b=="number"&&typeof _=="number"||p,S=l===this;if(v){d.save();const O=this.getAbsoluteTransform(l);let y=O.getMatrix();d.transform(y[0],y[1],y[2],y[3],y[4],y[5]),d.beginPath();let f;if(p)f=p.call(this,d,this);else{const w=this.clipX(),P=this.clipY();d.rect(w||0,P||0,b,_)}d.clip.apply(d,f),y=O.copy().invert().getMatrix(),d.transform(y[0],y[1],y[2],y[3],y[4],y[5])}const E=!S&&this.globalCompositeOperation()!=="source-over"&&o==="drawScene";E&&(d.save(),d._applyGlobalCompositeOperation(this)),(g=this.children)===null||g===void 0||g.forEach(function(O){O[o](c,l,h)}),E&&d.restore(),v&&d.restore()}getClientRect(o={}){var c;const l=o.skipTransform,h=o.relativeTo;let g,d,b,_,p={x:1/0,y:1/0,width:0,height:0};const v=this;(c=this.children)===null||c===void 0||c.forEach(function(O){if(!O.visible())return;const y=O.getClientRect({relativeTo:v,skipShadow:o.skipShadow,skipStroke:o.skipStroke});y.width===0&&y.height===0||(g===void 0?(g=y.x,d=y.y,b=y.x+y.width,_=y.y+y.height):(g=Math.min(g,y.x),d=Math.min(d,y.y),b=Math.max(b,y.x+y.width),_=Math.max(_,y.y+y.height)))});const S=this.find("Shape");let E=!1;for(let O=0;O<S.length;O++)if(S[O]._isVisible(this)){E=!0;break}return E&&g!==void 0?p={x:g,y:d,width:b-g,height:_-d}:p={x:0,y:0,width:0,height:0},l?p:this._transformedRect(p,h)}};return mr.Container=s,t.Factory.addComponentsGetterSetter(s,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(s,"clipX",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clipY",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clipWidth",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clipHeight",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clipFunc"),mr}var so={},yn={},gl;function cu(){if(gl)return yn;gl=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.getCapturedShape=s,yn.createEvent=a,yn.hasPointerCapture=o,yn.setPointerCapture=c,yn.releaseCapture=l;const t=zt(),e=new Map,i=t.Konva._global.PointerEvent!==void 0;function s(h){return e.get(h)}function a(h){return{evt:h,pointerId:h.pointerId}}function o(h,g){return e.get(h)===g}function c(h,g){l(h),g.getStage()&&(e.set(h,g),i&&g._fire("gotpointercapture",a(new PointerEvent("gotpointercapture"))))}function l(h,g){const d=e.get(h);if(!d)return;const b=d.getStage();b&&b.content,e.delete(h),i&&d._fire("lostpointercapture",a(new PointerEvent("lostpointercapture")))}return yn}var pl;function gd(){return pl||(pl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=ce(),i=Yt(),s=hs(),a=zt(),o=us(),c=Yo(),l=zt(),h=cu(),g="Stage",d="string",b="px",_="mouseout",p="mouseleave",v="mouseover",S="mouseenter",E="mousemove",O="mousedown",y="mouseup",f="pointermove",w="pointerdown",P="pointerup",I="pointercancel",q="lostpointercapture",A="pointerout",k="pointerleave",F="pointerover",M="pointerenter",K="contextmenu",W="touchstart",J="touchend",z="touchmove",ft="touchcancel",C="wheel",R=5,G=[[S,"_pointerenter"],[O,"_pointerdown"],[E,"_pointermove"],[y,"_pointerup"],[p,"_pointerleave"],[W,"_pointerdown"],[z,"_pointermove"],[J,"_pointerup"],[ft,"_pointercancel"],[v,"_pointerover"],[C,"_wheel"],[K,"_contextmenu"],[w,"_pointerdown"],[f,"_pointermove"],[P,"_pointerup"],[I,"_pointercancel"],[k,"_pointerleave"],[q,"_lostpointercapture"]],L={mouse:{[A]:_,[k]:p,[F]:v,[M]:S,[f]:E,[w]:O,[P]:y,[I]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[k]:"touchleave",[F]:"touchover",[M]:"touchenter",[f]:z,[w]:W,[P]:J,[I]:ft,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[k]:k,[F]:F,[M]:M,[f]:f,[w]:w,[P]:P,[I]:I,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},j=ot=>ot.indexOf("pointer")>=0?"pointer":ot.indexOf("touch")>=0?"touch":"mouse",ct=ot=>{const B=j(ot);if(B==="pointer")return a.Konva.pointerEventsEnabled&&L.pointer;if(B==="touch")return L.touch;if(B==="mouse")return L.mouse};function $(ot={}){return(ot.clipFunc||ot.clipWidth||ot.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ot}const vt="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class St extends s.Container{constructor(B){super($(B)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{$(this.attrs)}),this._checkVisibility()}_validateAdd(B){const at=B.getType()==="Layer",ht=B.getType()==="FastLayer";at||ht||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const B=this.visible()?"":"none";this.content.style.display=B}setContainer(B){if(typeof B===d){let at;if(B.charAt(0)==="."){const ht=B.slice(1);B=document.getElementsByClassName(ht)[0]}else B.charAt(0)!=="#"?at=B:at=B.slice(1),B=document.getElementById(at);if(!B)throw"Can not find container in document with id "+at}return this._setAttr("container",B),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),B.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const B=this.children,at=B.length;for(let ht=0;ht<at;ht++)B[ht].clear();return this}clone(B){return B||(B={}),B.container=typeof document<"u"&&document.createElement("div"),s.Container.prototype.clone.call(this,B)}destroy(){super.destroy();const B=this.content;B&&e.Util._isInDocument(B)&&this.container().removeChild(B);const at=t.stages.indexOf(this);return at>-1&&t.stages.splice(at,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const B=this._pointerPositions[0]||this._changedPointerPositions[0];return B?{x:B.x,y:B.y}:(e.Util.warn(vt),null)}_getPointerById(B){return this._pointerPositions.find(at=>at.id===B)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(B){B=B||{},B.x=B.x||0,B.y=B.y||0,B.width=B.width||this.width(),B.height=B.height||this.height();const at=new o.SceneCanvas({width:B.width,height:B.height,pixelRatio:B.pixelRatio||1}),ht=at.getContext()._context,At=this.children;return(B.x||B.y)&&ht.translate(-1*B.x,-1*B.y),At.forEach(function(Dt){if(!Dt.isVisible())return;const N=Dt._toKonvaCanvas(B);ht.drawImage(N._canvas,B.x,B.y,N.getWidth()/N.getPixelRatio(),N.getHeight()/N.getPixelRatio())}),at}getIntersection(B){if(!B)return null;const at=this.children,ht=at.length,At=ht-1;for(let Dt=At;Dt>=0;Dt--){const N=at[Dt].getIntersection(B);if(N)return N}return null}_resizeDOM(){const B=this.width(),at=this.height();this.content&&(this.content.style.width=B+b,this.content.style.height=at+b),this.bufferCanvas.setSize(B,at),this.bufferHitCanvas.setSize(B,at),this.children.forEach(ht=>{ht.setSize({width:B,height:at}),ht.draw()})}add(B,...at){if(arguments.length>1){for(let At=0;At<arguments.length;At++)this.add(arguments[At]);return this}super.add(B);const ht=this.children.length;return ht>R&&e.Util.warn("The stage has "+ht+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),B.setSize({width:this.width(),height:this.height()}),B.draw(),a.Konva.isBrowser&&this.content.appendChild(B.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(B){return h.hasPointerCapture(B,this)}setPointerCapture(B){h.setPointerCapture(B,this)}releaseCapture(B){h.releaseCapture(B,this)}getLayers(){return this.children}_bindContentEvents(){a.Konva.isBrowser&&G.forEach(([B,at])=>{this.content.addEventListener(B,ht=>{this[at](ht)},{passive:!1})})}_pointerenter(B){this.setPointersPositions(B);const at=ct(B.type);at&&this._fire(at.pointerenter,{evt:B,target:this,currentTarget:this})}_pointerover(B){this.setPointersPositions(B);const at=ct(B.type);at&&this._fire(at.pointerover,{evt:B,target:this,currentTarget:this})}_getTargetShape(B){let at=this[B+"targetShape"];return at&&!at.getStage()&&(at=null),at}_pointerleave(B){const at=ct(B.type),ht=j(B.type);if(!at)return;this.setPointersPositions(B);const At=this._getTargetShape(ht),Dt=!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled;At&&Dt?(At._fireAndBubble(at.pointerout,{evt:B}),At._fireAndBubble(at.pointerleave,{evt:B}),this._fire(at.pointerleave,{evt:B,target:this,currentTarget:this}),this[ht+"targetShape"]=null):Dt&&(this._fire(at.pointerleave,{evt:B,target:this,currentTarget:this}),this._fire(at.pointerout,{evt:B,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(B){const at=ct(B.type),ht=j(B.type);if(!at)return;this.setPointersPositions(B);let At=!1;this._changedPointerPositions.forEach(Dt=>{const N=this.getIntersection(Dt);if(c.DD.justDragged=!1,a.Konva["_"+ht+"ListenClick"]=!0,!N||!N.isListening()){this[ht+"ClickStartShape"]=void 0;return}a.Konva.capturePointerEventsEnabled&&N.setPointerCapture(Dt.id),this[ht+"ClickStartShape"]=N,N._fireAndBubble(at.pointerdown,{evt:B,pointerId:Dt.id}),At=!0;const V=B.type.indexOf("touch")>=0;N.preventDefault()&&B.cancelable&&V&&B.preventDefault()}),At||this._fire(at.pointerdown,{evt:B,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(B){const at=ct(B.type),ht=j(B.type);if(!at||(a.Konva.isDragging()&&c.DD.node.preventDefault()&&B.cancelable&&B.preventDefault(),this.setPointersPositions(B),!(!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled)))return;const Dt={};let N=!1;const V=this._getTargetShape(ht);this._changedPointerPositions.forEach(st=>{const ut=h.getCapturedShape(st.id)||this.getIntersection(st),pt=st.id,dt={evt:B,pointerId:pt},bt=V!==ut;if(bt&&V&&(V._fireAndBubble(at.pointerout,{...dt},ut),V._fireAndBubble(at.pointerleave,{...dt},ut)),ut){if(Dt[ut._id])return;Dt[ut._id]=!0}ut&&ut.isListening()?(N=!0,bt&&(ut._fireAndBubble(at.pointerover,{...dt},V),ut._fireAndBubble(at.pointerenter,{...dt},V),this[ht+"targetShape"]=ut),ut._fireAndBubble(at.pointermove,{...dt})):V&&(this._fire(at.pointerover,{evt:B,target:this,currentTarget:this,pointerId:pt}),this[ht+"targetShape"]=null)}),N||this._fire(at.pointermove,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(B){const at=ct(B.type),ht=j(B.type);if(!at)return;this.setPointersPositions(B);const At=this[ht+"ClickStartShape"],Dt=this[ht+"ClickEndShape"],N={};let V=!1;this._changedPointerPositions.forEach(st=>{const ut=h.getCapturedShape(st.id)||this.getIntersection(st);if(ut){if(ut.releaseCapture(st.id),N[ut._id])return;N[ut._id]=!0}const pt=st.id,dt={evt:B,pointerId:pt};let bt=!1;a.Konva["_"+ht+"InDblClickWindow"]?(bt=!0,clearTimeout(this[ht+"DblTimeout"])):c.DD.justDragged||(a.Konva["_"+ht+"InDblClickWindow"]=!0,clearTimeout(this[ht+"DblTimeout"])),this[ht+"DblTimeout"]=setTimeout(function(){a.Konva["_"+ht+"InDblClickWindow"]=!1},a.Konva.dblClickWindow),ut&&ut.isListening()?(V=!0,this[ht+"ClickEndShape"]=ut,ut._fireAndBubble(at.pointerup,{...dt}),a.Konva["_"+ht+"ListenClick"]&&At&&At===ut&&(ut._fireAndBubble(at.pointerclick,{...dt}),bt&&Dt&&Dt===ut&&ut._fireAndBubble(at.pointerdblclick,{...dt}))):(this[ht+"ClickEndShape"]=null,a.Konva["_"+ht+"ListenClick"]&&this._fire(at.pointerclick,{evt:B,target:this,currentTarget:this,pointerId:pt}),bt&&this._fire(at.pointerdblclick,{evt:B,target:this,currentTarget:this,pointerId:pt}))}),V||this._fire(at.pointerup,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a.Konva["_"+ht+"ListenClick"]=!1,B.cancelable&&ht!=="touch"&&ht!=="pointer"&&B.preventDefault()}_contextmenu(B){this.setPointersPositions(B);const at=this.getIntersection(this.getPointerPosition());at&&at.isListening()?at._fireAndBubble(K,{evt:B}):this._fire(K,{evt:B,target:this,currentTarget:this})}_wheel(B){this.setPointersPositions(B);const at=this.getIntersection(this.getPointerPosition());at&&at.isListening()?at._fireAndBubble(C,{evt:B}):this._fire(C,{evt:B,target:this,currentTarget:this})}_pointercancel(B){this.setPointersPositions(B);const at=h.getCapturedShape(B.pointerId)||this.getIntersection(this.getPointerPosition());at&&at._fireAndBubble(P,h.createEvent(B)),h.releaseCapture(B.pointerId)}_lostpointercapture(B){h.releaseCapture(B.pointerId)}setPointersPositions(B){const at=this._getContentPosition();let ht=null,At=null;B=B||window.event,B.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(B.touches,Dt=>{this._pointerPositions.push({id:Dt.identifier,x:(Dt.clientX-at.left)/at.scaleX,y:(Dt.clientY-at.top)/at.scaleY})}),Array.prototype.forEach.call(B.changedTouches||B.touches,Dt=>{this._changedPointerPositions.push({id:Dt.identifier,x:(Dt.clientX-at.left)/at.scaleX,y:(Dt.clientY-at.top)/at.scaleY})})):(ht=(B.clientX-at.left)/at.scaleX,At=(B.clientY-at.top)/at.scaleY,this.pointerPos={x:ht,y:At},this._pointerPositions=[{x:ht,y:At,id:e.Util._getFirstPointerId(B)}],this._changedPointerPositions=[{x:ht,y:At,id:e.Util._getFirstPointerId(B)}])}_setPointerPosition(B){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(B)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const B=this.content.getBoundingClientRect();return{top:B.top,left:B.left,scaleX:B.width/this.content.clientWidth||1,scaleY:B.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!a.Konva.isBrowser)return;const B=this.container();if(!B)throw"Stage has no container. A container is required.";B.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),B.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(B){B.batchDraw()}),this}}t.Stage=St,St.prototype.nodeType=g,(0,l._registerNode)(St),i.Factory.addGetterSetter(St,"container"),a.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(ot=>{ot.batchDraw()})})})(so)),so}var yr={},oo={},ml;function _e(){return ml||(ml=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=zt(),i=ce(),s=Yt(),a=de(),o=Xt(),c=zt(),l=cu(),h="hasShadow",g="shadowRGBA",d="patternImage",b="linearGradient",_="radialGradient";let p;function v(){return p||(p=i.Util.createCanvasElement().getContext("2d"),p)}t.shapes={};function S(k){const F=this.attrs.fillRule;F?k.fill(F):k.fill()}function E(k){k.stroke()}function O(k){const F=this.attrs.fillRule;F?k.fill(F):k.fill()}function y(k){k.stroke()}function f(){this._clearCache(h)}function w(){this._clearCache(g)}function P(){this._clearCache(d)}function I(){this._clearCache(b)}function q(){this._clearCache(_)}class A extends a.Node{constructor(F){super(F);let M;for(;M=i.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return i.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return i.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(h,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=v().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const K=new i.Transform;K.translate(this.fillPatternX(),this.fillPatternY()),K.rotate(e.Konva.getAngle(this.fillPatternRotation())),K.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),K.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const W=K.getMatrix(),J=typeof DOMMatrix>"u"?{a:W[0],b:W[1],c:W[2],d:W[3],e:W[4],f:W[5]}:new DOMMatrix(W);M.setTransform(J)}return M}}_getLinearGradient(){return this._getCache(b,this.__getLinearGradient)}__getLinearGradient(){const F=this.fillLinearGradientColorStops();if(F){const M=v(),K=this.fillLinearGradientStartPoint(),W=this.fillLinearGradientEndPoint(),J=M.createLinearGradient(K.x,K.y,W.x,W.y);for(let z=0;z<F.length;z+=2)J.addColorStop(F[z],F[z+1]);return J}}_getRadialGradient(){return this._getCache(_,this.__getRadialGradient)}__getRadialGradient(){const F=this.fillRadialGradientColorStops();if(F){const M=v(),K=this.fillRadialGradientStartPoint(),W=this.fillRadialGradientEndPoint(),J=M.createRadialGradient(K.x,K.y,this.fillRadialGradientStartRadius(),W.x,W.y,this.fillRadialGradientEndRadius());for(let z=0;z<F.length;z+=2)J.addColorStop(F[z],F[z+1]);return J}}getShadowRGBA(){return this._getCache(g,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const F=i.Util.colorToRGBA(this.shadowColor());if(F)return"rgba("+F.r+","+F.g+","+F.b+","+F.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const F=this.hitStrokeWidth();return F==="auto"?this.hasStroke():this.strokeEnabled()&&!!F}intersects(F){const M=this.getStage();if(!M)return!1;const K=M.bufferHitCanvas;return K.getContext().clear(),this.drawHit(K,void 0,!0),K.context.getImageData(Math.round(F.x),Math.round(F.y),1,1).data[3]>0}destroy(){return a.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(F){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const W=F||this.hasFill(),J=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(W&&J&&z)return!0;const ft=this.hasShadow(),C=this.shadowForStrokeEnabled();return!!(W&&J&&ft&&C)}setStrokeHitEnabled(F){i.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),F?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const F=this.size();return{x:this._centroid?-F.width/2:0,y:this._centroid?-F.height/2:0,width:F.width,height:F.height}}getClientRect(F={}){let M=!1,K=this.getParent();for(;K;){if(K.isCached()){M=!0;break}K=K.getParent()}const W=F.skipTransform,J=F.relativeTo||M&&this.getStage()||void 0,z=this.getSelfRect(),C=!F.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,R=z.width+C,G=z.height+C,L=!F.skipShadow&&this.hasShadow(),j=L?this.shadowOffsetX():0,ct=L?this.shadowOffsetY():0,$=R+Math.abs(j),vt=G+Math.abs(ct),St=L&&this.shadowBlur()||0,ot=$+St*2,B=vt+St*2,at={width:ot,height:B,x:-(C/2+St)+Math.min(j,0)+z.x,y:-(C/2+St)+Math.min(ct,0)+z.y};return W?at:this._transformedRect(at,J)}drawScene(F,M,K){const W=this.getLayer(),J=F||W.getCanvas(),z=J.getContext(),ft=this._getCanvasCache(),C=this.getSceneFunc(),R=this.hasShadow();let G;const L=M===this;if(!this.isVisible()&&!L)return this;if(ft){z.save();const j=this.getAbsoluteTransform(M).getMatrix();return z.transform(j[0],j[1],j[2],j[3],j[4],j[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!C)return this;if(z.save(),this._useBufferCanvas()){G=this.getStage();const j=K||G.bufferCanvas,ct=j.getContext();ct.clear(),ct.save(),ct._applyLineJoin(this);const $=this.getAbsoluteTransform(M).getMatrix();ct.transform($[0],$[1],$[2],$[3],$[4],$[5]),C.call(this,ct,this),ct.restore();const vt=j.pixelRatio;R&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(j._canvas,j.x||0,j.y||0,j.width/vt,j.height/vt)}else{if(z._applyLineJoin(this),!L){const j=this.getAbsoluteTransform(M).getMatrix();z.transform(j[0],j[1],j[2],j[3],j[4],j[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}R&&z._applyShadow(this),C.call(this,z,this)}return z.restore(),this}drawHit(F,M,K=!1){if(!this.shouldDrawHit(M,K))return this;const W=this.getLayer(),J=F||W.hitCanvas,z=J&&J.getContext(),ft=this.hitFunc()||this.sceneFunc(),C=this._getCanvasCache(),R=C&&C.hit;if(this.colorKey||i.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),R){z.save();const L=this.getAbsoluteTransform(M).getMatrix();return z.transform(L[0],L[1],L[2],L[3],L[4],L[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!ft)return this;if(z.save(),z._applyLineJoin(this),!(this===M)){const L=this.getAbsoluteTransform(M).getMatrix();z.transform(L[0],L[1],L[2],L[3],L[4],L[5])}return ft.call(this,z,this),z.restore(),this}drawHitFromCache(F=0){const M=this._getCanvasCache(),K=this._getCachedSceneCanvas(),W=M.hit,J=W.getContext(),z=W.getWidth(),ft=W.getHeight();J.clear(),J.drawImage(K._canvas,0,0,z,ft);try{const C=J.getImageData(0,0,z,ft),R=C.data,G=R.length,L=i.Util._hexToRgb(this.colorKey);for(let j=0;j<G;j+=4)R[j+3]>F?(R[j]=L.r,R[j+1]=L.g,R[j+2]=L.b,R[j+3]=255):R[j+3]=0;J.putImageData(C,0,0)}catch(C){i.Util.error("Unable to draw hit graph from cached scene canvas. "+C.message)}return this}hasPointerCapture(F){return l.hasPointerCapture(F,this)}setPointerCapture(F){l.setPointerCapture(F,this)}releaseCapture(F){l.releaseCapture(F,this)}}t.Shape=A,A.prototype._fillFunc=S,A.prototype._strokeFunc=E,A.prototype._fillFuncHit=O,A.prototype._strokeFuncHit=y,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,c._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",f),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",I),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",q),s.Factory.addGetterSetter(A,"stroke",void 0,(0,o.getStringOrGradientValidator)()),s.Factory.addGetterSetter(A,"strokeWidth",2,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),s.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),s.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),s.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),s.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),s.Factory.addGetterSetter(A,"lineJoin"),s.Factory.addGetterSetter(A,"lineCap"),s.Factory.addGetterSetter(A,"sceneFunc"),s.Factory.addGetterSetter(A,"hitFunc"),s.Factory.addGetterSetter(A,"dash"),s.Factory.addGetterSetter(A,"dashOffset",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"shadowColor",void 0,(0,o.getStringValidator)()),s.Factory.addGetterSetter(A,"shadowBlur",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"shadowOpacity",1,(0,o.getNumberValidator)()),s.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),s.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"fillPatternImage"),s.Factory.addGetterSetter(A,"fill",void 0,(0,o.getStringOrGradientValidator)()),s.Factory.addGetterSetter(A,"fillPatternX",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"fillPatternY",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),s.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),s.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),s.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),s.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),s.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),s.Factory.addGetterSetter(A,"fillEnabled",!0),s.Factory.addGetterSetter(A,"strokeEnabled",!0),s.Factory.addGetterSetter(A,"shadowEnabled",!0),s.Factory.addGetterSetter(A,"dashEnabled",!0),s.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),s.Factory.addGetterSetter(A,"fillPriority","color"),s.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),s.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),s.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),s.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,o.getNumberValidator)()),s.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),s.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),s.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),s.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),s.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),s.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),s.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),s.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),s.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),s.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),s.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),s.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),s.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),s.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),s.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),s.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),s.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),s.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),s.Factory.addGetterSetter(A,"fillPatternRotation",0),s.Factory.addGetterSetter(A,"fillRule",void 0,(0,o.getStringValidator)()),s.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(oo)),oo}var yl;function uu(){if(yl)return yr;yl=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.Layer=void 0;const t=ce(),e=hs(),i=de(),s=Yt(),a=us(),o=Xt(),c=_e(),l=zt(),h="#",g="beforeDraw",d="draw",b=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],_=b.length;let p=class extends e.Container{constructor(S){super(S),this.canvas=new a.SceneCanvas,this.hitCanvas=new a.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(S){return this.getContext().clear(S),this.getHitCanvas().getContext().clear(S),this}setZIndex(S){super.setZIndex(S);const E=this.getStage();return E&&E.content&&(E.content.removeChild(this.getNativeCanvasElement()),S<E.children.length-1?E.content.insertBefore(this.getNativeCanvasElement(),E.children[S+1].getCanvas()._canvas):E.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){i.Node.prototype.moveToTop.call(this);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!i.Node.prototype.moveUp.call(this))return!1;const E=this.getStage();return!E||!E.content?!1:(E.content.removeChild(this.getNativeCanvasElement()),this.index<E.children.length-1?E.content.insertBefore(this.getNativeCanvasElement(),E.children[this.index+1].getCanvas()._canvas):E.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(i.Node.prototype.moveDown.call(this)){const S=this.getStage();if(S){const E=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),E[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(i.Node.prototype.moveToBottom.call(this)){const S=this.getStage();if(S){const E=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),E[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const S=this.getNativeCanvasElement();return i.Node.prototype.remove.call(this),S&&S.parentNode&&t.Util._isInDocument(S)&&S.parentNode.removeChild(S),this}getStage(){return this.parent}setSize({width:S,height:E}){return this.canvas.setSize(S,E),this.hitCanvas.setSize(S,E),this._setSmoothEnabled(),this}_validateAdd(S){const E=S.getType();E!=="Group"&&E!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(S){return S=S||{},S.width=S.width||this.getWidth(),S.height=S.height||this.getHeight(),S.x=S.x!==void 0?S.x:this.x(),S.y=S.y!==void 0?S.y:this.y(),i.Node.prototype._toKonvaCanvas.call(this,S)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(S){if(!this.isListening()||!this.isVisible())return null;let E=1,O=!1;for(;;){for(let y=0;y<_;y++){const f=b[y],w=this._getIntersection({x:S.x+f.x*E,y:S.y+f.y*E}),P=w.shape;if(P)return P;if(O=!!w.antialiased,!w.antialiased)break}if(O)E+=1;else return null}}_getIntersection(S){const E=this.hitCanvas.pixelRatio,O=this.hitCanvas.context.getImageData(Math.round(S.x*E),Math.round(S.y*E),1,1).data,y=O[3];if(y===255){const f=t.Util._rgbToHex(O[0],O[1],O[2]),w=c.shapes[h+f];return w?{shape:w}:{antialiased:!0}}else if(y>0)return{antialiased:!0};return{}}drawScene(S,E,O){const y=this.getLayer(),f=S||y&&y.getCanvas();return this._fire(g,{node:this}),this.clearBeforeDraw()&&f.getContext().clear(),e.Container.prototype.drawScene.call(this,f,E,O),this._fire(d,{node:this}),this}drawHit(S,E){const O=this.getLayer(),y=S||O&&O.hitCanvas;return O&&O.clearBeforeDraw()&&O.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,y,E),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(S){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(S)}getHitGraphEnabled(S){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const S=this.parent;!!this.hitCanvas._canvas.parentNode?S.content.removeChild(this.hitCanvas._canvas):S.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return yr.Layer=p,p.prototype.nodeType="Layer",(0,l._registerNode)(p),s.Factory.addGetterSetter(p,"imageSmoothingEnabled",!0),s.Factory.addGetterSetter(p,"clearBeforeDraw",!0),s.Factory.addGetterSetter(p,"hitGraphEnabled",!0,(0,o.getBooleanValidator)()),yr}var vr={},vl;function pd(){if(vl)return vr;vl=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.FastLayer=void 0;const t=ce(),e=uu(),i=zt();let s=class extends e.Layer{constructor(o){super(o),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return vr.FastLayer=s,s.prototype.nodeType="FastLayer",(0,i._registerNode)(s),vr}var _r={},_l;function Xo(){if(_l)return _r;_l=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.Group=void 0;const t=ce(),e=hs(),i=zt();let s=class extends e.Container{_validateAdd(o){const c=o.getType();c!=="Group"&&c!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return _r.Group=s,s.prototype.nodeType="Group",(0,i._registerNode)(s),_r}var br={},bl;function Qo(){if(bl)return br;bl=1,Object.defineProperty(br,"__esModule",{value:!0}),br.Animation=void 0;const t=zt(),e=ce(),i=(function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}})();let s=class Qn{constructor(o,c){this.id=Qn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:i(),frameRate:0},this.func=o,this.setLayers(c)}setLayers(o){let c=[];return o&&(c=Array.isArray(o)?o:[o]),this.layers=c,this}getLayers(){return this.layers}addLayer(o){const c=this.layers,l=c.length;for(let h=0;h<l;h++)if(c[h]._id===o._id)return!1;return this.layers.push(o),!0}isRunning(){const c=Qn.animations,l=c.length;for(let h=0;h<l;h++)if(c[h].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=i(),Qn._addAnimation(this),this}stop(){return Qn._removeAnimation(this),this}_updateFrameObject(o){this.frame.timeDiff=o-this.frame.lastTime,this.frame.lastTime=o,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(o){this.animations.push(o),this._handleAnimation()}static _removeAnimation(o){const c=o.id,l=this.animations,h=l.length;for(let g=0;g<h;g++)if(l[g].id===c){this.animations.splice(g,1);break}}static _runFrames(){const o={},c=this.animations;for(let l=0;l<c.length;l++){const h=c[l],g=h.layers,d=h.func;h._updateFrameObject(i());const b=g.length;let _;if(d?_=d.call(h,h.frame)!==!1:_=!0,!!_)for(let p=0;p<b;p++){const v=g[p];v._id!==void 0&&(o[v._id]=v)}}for(const l in o)o.hasOwnProperty(l)&&o[l].batchDraw()}static _animationLoop(){const o=Qn;o.animations.length?(o._runFrames(),e.Util.requestAnimFrame(o._animationLoop)):o.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return br.Animation=s,s.animations=[],s.animIdCounter=0,s.animRunning=!1,br}var ao={},wl;function md(){return wl||(wl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=ce(),i=Qo(),s=de(),a=zt(),o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},c=1,l=2,h=3,g=["fill","stroke","shadowColor"];let d=0;class b{constructor(v,S,E,O,y,f,w){this.prop=v,this.propFunc=S,this.begin=O,this._pos=O,this.duration=f,this._change=0,this.prevPos=0,this.yoyo=w,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=E,this._change=y-this.begin,this.pause()}fire(v){const S=this[v];S&&S()}setTime(v){v>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():v<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=v,this.update())}getTime(){return this._time}setPosition(v){this.prevPos=this._pos,this.propFunc(v),this._pos=v}getPosition(v){return v===void 0&&(v=this._time),this.func(v,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=h,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(v){this.pause(),this._time=v,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const v=this.getTimer()-this._startTime;this.state===l?this.setTime(v):this.state===h&&this.setTime(this.duration-v)}pause(){this.state=c,this.fire("onPause")}getTimer(){return new Date().getTime()}}class _{constructor(v){const S=this,E=v.node,O=E._id,y=v.easing||t.Easings.Linear,f=!!v.yoyo;let w,P;typeof v.duration>"u"?w=.3:v.duration===0?w=.001:w=v.duration,this.node=E,this._id=d++;const I=E.getLayer()||(E instanceof a.Konva.Stage?E.getLayers():null);I||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new i.Animation(function(){S.tween.onEnterFrame()},I),this.tween=new b(P,function(q){S._tweenFunc(q)},y,0,1,w*1e3,f),this._addListeners(),_.attrs[O]||(_.attrs[O]={}),_.attrs[O][this._id]||(_.attrs[O][this._id]={}),_.tweens[O]||(_.tweens[O]={});for(P in v)o[P]===void 0&&this._addAttr(P,v[P]);this.reset(),this.onFinish=v.onFinish,this.onReset=v.onReset,this.onUpdate=v.onUpdate}_addAttr(v,S){const E=this.node,O=E._id;let y,f,w,P,I;const q=_.tweens[O][v];q&&delete _.attrs[O][q][v];let A=E.getAttr(v);if(e.Util._isArray(S))if(y=[],f=Math.max(S.length,A.length),v==="points"&&S.length!==A.length&&(S.length>A.length?(P=A,A=e.Util._prepareArrayForTween(A,S,E.closed())):(w=S,S=e.Util._prepareArrayForTween(S,A,E.closed()))),v.indexOf("fill")===0)for(let k=0;k<f;k++)if(k%2===0)y.push(S[k]-A[k]);else{const F=e.Util.colorToRGBA(A[k]);I=e.Util.colorToRGBA(S[k]),A[k]=F,y.push({r:I.r-F.r,g:I.g-F.g,b:I.b-F.b,a:I.a-F.a})}else for(let k=0;k<f;k++)y.push(S[k]-A[k]);else g.indexOf(v)!==-1?(A=e.Util.colorToRGBA(A),I=e.Util.colorToRGBA(S),y={r:I.r-A.r,g:I.g-A.g,b:I.b-A.b,a:I.a-A.a}):y=S-A;_.attrs[O][this._id][v]={start:A,diff:y,end:S,trueEnd:w,trueStart:P},_.tweens[O][v]=this._id}_tweenFunc(v){const S=this.node,E=_.attrs[S._id][this._id];let O,y,f,w,P,I,q,A;for(O in E){if(y=E[O],f=y.start,w=y.diff,A=y.end,e.Util._isArray(f))if(P=[],q=Math.max(f.length,A.length),O.indexOf("fill")===0)for(I=0;I<q;I++)I%2===0?P.push((f[I]||0)+w[I]*v):P.push("rgba("+Math.round(f[I].r+w[I].r*v)+","+Math.round(f[I].g+w[I].g*v)+","+Math.round(f[I].b+w[I].b*v)+","+(f[I].a+w[I].a*v)+")");else for(I=0;I<q;I++)P.push((f[I]||0)+w[I]*v);else g.indexOf(O)!==-1?P="rgba("+Math.round(f.r+w.r*v)+","+Math.round(f.g+w.g*v)+","+Math.round(f.b+w.b*v)+","+(f.a+w.a*v)+")":P=f+w*v;S.setAttr(O,P)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const v=this.node,S=_.attrs[v._id][this._id];S.points&&S.points.trueEnd&&v.setAttr("points",S.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const v=this.node,S=_.attrs[v._id][this._id];S.points&&S.points.trueStart&&v.points(S.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(v){return this.tween.seek(v*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const v=this.node._id,S=this._id,E=_.tweens[v];this.pause(),this.anim&&this.anim.stop();for(const O in E)delete _.tweens[v][O];delete _.attrs[v][S],_.tweens[v]&&(Object.keys(_.tweens[v]).length===0&&delete _.tweens[v],Object.keys(_.attrs[v]).length===0&&delete _.attrs[v])}}t.Tween=_,_.attrs={},_.tweens={},s.Node.prototype.to=function(p){const v=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),v&&v()},new _(p).play()},t.Easings={BackEaseIn(p,v,S,E){return S*(p/=E)*p*((1.70158+1)*p-1.70158)+v},BackEaseOut(p,v,S,E){return S*((p=p/E-1)*p*((1.70158+1)*p+1.70158)+1)+v},BackEaseInOut(p,v,S,E){let O=1.70158;return(p/=E/2)<1?S/2*(p*p*(((O*=1.525)+1)*p-O))+v:S/2*((p-=2)*p*(((O*=1.525)+1)*p+O)+2)+v},ElasticEaseIn(p,v,S,E,O,y){let f=0;return p===0?v:(p/=E)===1?v+S:(y||(y=E*.3),!O||O<Math.abs(S)?(O=S,f=y/4):f=y/(2*Math.PI)*Math.asin(S/O),-(O*Math.pow(2,10*(p-=1))*Math.sin((p*E-f)*(2*Math.PI)/y))+v)},ElasticEaseOut(p,v,S,E,O,y){let f=0;return p===0?v:(p/=E)===1?v+S:(y||(y=E*.3),!O||O<Math.abs(S)?(O=S,f=y/4):f=y/(2*Math.PI)*Math.asin(S/O),O*Math.pow(2,-10*p)*Math.sin((p*E-f)*(2*Math.PI)/y)+S+v)},ElasticEaseInOut(p,v,S,E,O,y){let f=0;return p===0?v:(p/=E/2)===2?v+S:(y||(y=E*(.3*1.5)),!O||O<Math.abs(S)?(O=S,f=y/4):f=y/(2*Math.PI)*Math.asin(S/O),p<1?-.5*(O*Math.pow(2,10*(p-=1))*Math.sin((p*E-f)*(2*Math.PI)/y))+v:O*Math.pow(2,-10*(p-=1))*Math.sin((p*E-f)*(2*Math.PI)/y)*.5+S+v)},BounceEaseOut(p,v,S,E){return(p/=E)<1/2.75?S*(7.5625*p*p)+v:p<2/2.75?S*(7.5625*(p-=1.5/2.75)*p+.75)+v:p<2.5/2.75?S*(7.5625*(p-=2.25/2.75)*p+.9375)+v:S*(7.5625*(p-=2.625/2.75)*p+.984375)+v},BounceEaseIn(p,v,S,E){return S-t.Easings.BounceEaseOut(E-p,0,S,E)+v},BounceEaseInOut(p,v,S,E){return p<E/2?t.Easings.BounceEaseIn(p*2,0,S,E)*.5+v:t.Easings.BounceEaseOut(p*2-E,0,S,E)*.5+S*.5+v},EaseIn(p,v,S,E){return S*(p/=E)*p+v},EaseOut(p,v,S,E){return-S*(p/=E)*(p-2)+v},EaseInOut(p,v,S,E){return(p/=E/2)<1?S/2*p*p+v:-S/2*(--p*(p-2)-1)+v},StrongEaseIn(p,v,S,E){return S*(p/=E)*p*p*p*p+v},StrongEaseOut(p,v,S,E){return S*((p=p/E-1)*p*p*p*p+1)+v},StrongEaseInOut(p,v,S,E){return(p/=E/2)<1?S/2*p*p*p*p*p+v:S/2*((p-=2)*p*p*p*p+2)+v},Linear(p,v,S,E){return S*p/E+v}}})(ao)),ao}var Sl;function yd(){return Sl||(Sl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=zt(),i=ce(),s=de(),a=hs(),o=gd(),c=uu(),l=pd(),h=Xo(),g=Yo(),d=_e(),b=Qo(),_=md(),p=lu(),v=us();t.Konva=i.Util._assign(e.Konva,{Util:i.Util,Transform:i.Transform,Node:s.Node,Container:a.Container,Stage:o.Stage,stages:o.stages,Layer:c.Layer,FastLayer:l.FastLayer,Group:h.Group,DD:g.DD,Shape:d.Shape,shapes:d.shapes,Animation:b.Animation,Tween:_.Tween,Easings:_.Easings,Context:p.Context,Canvas:v.Canvas}),t.default=t.Konva})(to)),to}var wr={},xl;function vd(){if(xl)return wr;xl=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.Arc=void 0;const t=Yt(),e=_e(),i=zt(),s=Xt(),a=zt();let o=class extends e.Shape{_sceneFunc(l){const h=i.Konva.getAngle(this.angle()),g=this.clockwise();l.beginPath(),l.arc(0,0,this.outerRadius(),0,h,g),l.arc(0,0,this.innerRadius(),h,0,!g),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}getSelfRect(){const l=this.innerRadius(),h=this.outerRadius(),g=this.clockwise(),d=i.Konva.getAngle(g?360-this.angle():this.angle()),b=Math.cos(Math.min(d,Math.PI)),_=1,p=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),v=Math.sin(Math.min(d,Math.PI/2)),S=b*(b>0?l:h),E=_*h,O=p*(p>0?l:h),y=v*(v>0?h:l);return{x:S,y:g?-1*y:O,width:E-S,height:y-O}}};return wr.Arc=o,o.prototype._centroid=!0,o.prototype.className="Arc",o.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,a._registerNode)(o),t.Factory.addGetterSetter(o,"innerRadius",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"outerRadius",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"angle",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"clockwise",!1,(0,s.getBooleanValidator)()),wr}var Sr={},xr={},Cl;function hu(){if(Cl)return xr;Cl=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.Line=void 0;const t=Yt(),e=zt(),i=_e(),s=Xt();function a(l,h,g,d,b,_,p){const v=Math.sqrt(Math.pow(g-l,2)+Math.pow(d-h,2)),S=Math.sqrt(Math.pow(b-g,2)+Math.pow(_-d,2)),E=p*v/(v+S),O=p*S/(v+S),y=g-E*(b-l),f=d-E*(_-h),w=g+O*(b-l),P=d+O*(_-h);return[y,f,w,P]}function o(l,h){const g=l.length,d=[];for(let b=2;b<g-2;b+=2){const _=a(l[b-2],l[b-1],l[b],l[b+1],l[b+2],l[b+3],h);isNaN(_[0])||(d.push(_[0]),d.push(_[1]),d.push(l[b]),d.push(l[b+1]),d.push(_[2]),d.push(_[3]))}return d}let c=class extends i.Shape{constructor(h){super(h),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(h){const g=this.points(),d=g.length,b=this.tension(),_=this.closed(),p=this.bezier();if(!d)return;let v=0;if(h.beginPath(),h.moveTo(g[0],g[1]),b!==0&&d>4){const S=this.getTensionPoints(),E=S.length;for(v=_?0:4,_||h.quadraticCurveTo(S[0],S[1],S[2],S[3]);v<E-2;)h.bezierCurveTo(S[v++],S[v++],S[v++],S[v++],S[v++],S[v++]);_||h.quadraticCurveTo(S[E-2],S[E-1],g[d-2],g[d-1])}else if(p)for(v=2;v<d;)h.bezierCurveTo(g[v++],g[v++],g[v++],g[v++],g[v++],g[v++]);else for(v=2;v<d;v+=2)h.lineTo(g[v],g[v+1]);_?(h.closePath(),h.fillStrokeShape(this)):h.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o(this.points(),this.tension())}_getTensionPointsClosed(){const h=this.points(),g=h.length,d=this.tension(),b=a(h[g-2],h[g-1],h[0],h[1],h[2],h[3],d),_=a(h[g-4],h[g-3],h[g-2],h[g-1],h[0],h[1],d),p=o(h,d);return[b[2],b[3]].concat(p).concat([_[0],_[1],h[g-2],h[g-1],_[2],_[3],b[0],b[1],h[0],h[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let h=this.points();if(h.length<4)return{x:h[0]||0,y:h[1]||0,width:0,height:0};this.tension()!==0?h=[h[0],h[1],...this._getTensionPoints(),h[h.length-2],h[h.length-1]]:h=this.points();let g=h[0],d=h[0],b=h[1],_=h[1],p,v;for(let S=0;S<h.length/2;S++)p=h[S*2],v=h[S*2+1],g=Math.min(g,p),d=Math.max(d,p),b=Math.min(b,v),_=Math.max(_,v);return{x:g,y:b,width:d-g,height:_-b}}};return xr.Line=c,c.prototype.className="Line",c.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(c),t.Factory.addGetterSetter(c,"closed",!1),t.Factory.addGetterSetter(c,"bezier",!1),t.Factory.addGetterSetter(c,"tension",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(c,"points",[],(0,s.getNumberArrayValidator)()),xr}var Cr={},lo={},Pl;function _d(){return Pl||(Pl=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(c,l,h)=>{let g,d;const _=h/2;g=0;for(let p=0;p<20;p++)d=_*t.tValues[20][p]+_,g+=t.cValues[20][p]*s(c,l,d);return _*g};t.getCubicArcLength=e;const i=(c,l,h)=>{h===void 0&&(h=1);const g=c[0]-2*c[1]+c[2],d=l[0]-2*l[1]+l[2],b=2*c[1]-2*c[0],_=2*l[1]-2*l[0],p=4*(g*g+d*d),v=4*(g*b+d*_),S=b*b+_*_;if(p===0)return h*Math.sqrt(Math.pow(c[2]-c[0],2)+Math.pow(l[2]-l[0],2));const E=v/(2*p),O=S/p,y=h+E,f=O-E*E,w=y*y+f>0?Math.sqrt(y*y+f):0,P=E*E+f>0?Math.sqrt(E*E+f):0,I=E+Math.sqrt(E*E+f)!==0?f*Math.log(Math.abs((y+w)/(E+P))):0;return Math.sqrt(p)/2*(y*w-E*P+I)};t.getQuadraticArcLength=i;function s(c,l,h){const g=a(1,h,c),d=a(1,h,l),b=g*g+d*d;return Math.sqrt(b)}const a=(c,l,h)=>{const g=h.length-1;let d,b;if(g===0)return 0;if(c===0){b=0;for(let _=0;_<=g;_++)b+=t.binomialCoefficients[g][_]*Math.pow(1-l,g-_)*Math.pow(l,_)*h[_];return b}else{d=new Array(g);for(let _=0;_<g;_++)d[_]=g*(h[_+1]-h[_]);return a(c-1,l,d)}},o=(c,l,h)=>{let g=1,d=c/l,b=(c-h(d))/l,_=0;for(;g>.001;){const p=h(d+b),v=Math.abs(c-p)/l;if(v<g)g=v,d+=b;else{const S=h(d-b),E=Math.abs(c-S)/l;E<g?(g=E,d-=b):b/=2}if(_++,_>500)break}return d};t.t2length=o})(lo)),lo}var Tl;function Jo(){if(Tl)return Cr;Tl=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.Path=void 0;const t=Yt(),e=zt(),i=_e(),s=_d();let a=class Me extends i.Shape{constructor(c){super(c),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Me.parsePathData(this.data()),this.pathLength=Me.getPathLength(this.dataArray)}_sceneFunc(c){const l=this.dataArray;c.beginPath();let h=!1;for(let g=0;g<l.length;g++){const d=l[g].command,b=l[g].points;switch(d){case"L":c.lineTo(b[0],b[1]);break;case"M":c.moveTo(b[0],b[1]);break;case"C":c.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5]);break;case"Q":c.quadraticCurveTo(b[0],b[1],b[2],b[3]);break;case"A":const _=b[0],p=b[1],v=b[2],S=b[3],E=b[4],O=b[5],y=b[6],f=b[7],w=v>S?v:S,P=v>S?1:v/S,I=v>S?S/v:1;c.translate(_,p),c.rotate(y),c.scale(P,I),c.arc(0,0,w,E,E+O,1-f),c.scale(1/P,1/I),c.rotate(-y),c.translate(-_,-p);break;case"z":h=!0,c.closePath();break}}!h&&!this.hasFill()?c.strokeShape(this):c.fillStrokeShape(this)}getSelfRect(){let c=[];this.dataArray.forEach(function(p){if(p.command==="A"){const v=p.points[4],S=p.points[5],E=p.points[4]+S;let O=Math.PI/180;if(Math.abs(v-E)<O&&(O=Math.abs(v-E)),S<0)for(let y=v-O;y>E;y-=O){const f=Me.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],y,0);c.push(f.x,f.y)}else for(let y=v+O;y<E;y+=O){const f=Me.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],y,0);c.push(f.x,f.y)}}else if(p.command==="C")for(let v=0;v<=1;v+=.01){const S=Me.getPointOnCubicBezier(v,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);c.push(S.x,S.y)}else c=c.concat(p.points)});let l=c[0],h=c[0],g=c[1],d=c[1],b,_;for(let p=0;p<c.length/2;p++)b=c[p*2],_=c[p*2+1],isNaN(b)||(l=Math.min(l,b),h=Math.max(h,b)),isNaN(_)||(g=Math.min(g,_),d=Math.max(d,_));return{x:l,y:g,width:h-l,height:d-g}}getLength(){return this.pathLength}getPointAtLength(c){return Me.getPointAtLengthOfDataArray(c,this.dataArray)}static getLineLength(c,l,h,g){return Math.sqrt((h-c)*(h-c)+(g-l)*(g-l))}static getPathLength(c){let l=0;for(let h=0;h<c.length;++h)l+=c[h].pathLength;return l}static getPointAtLengthOfDataArray(c,l){let h,g=0,d=l.length;if(!d)return null;for(;g<d&&c>l[g].pathLength;)c-=l[g].pathLength,++g;if(g===d)return h=l[g-1].points.slice(-2),{x:h[0],y:h[1]};if(c<.01)return l[g].command==="M"?(h=l[g].points.slice(0,2),{x:h[0],y:h[1]}):{x:l[g].start.x,y:l[g].start.y};const b=l[g],_=b.points;switch(b.command){case"L":return Me.getPointOnLine(c,b.start.x,b.start.y,_[0],_[1]);case"C":return Me.getPointOnCubicBezier((0,s.t2length)(c,Me.getPathLength(l),w=>(0,s.getCubicArcLength)([b.start.x,_[0],_[2],_[4]],[b.start.y,_[1],_[3],_[5]],w)),b.start.x,b.start.y,_[0],_[1],_[2],_[3],_[4],_[5]);case"Q":return Me.getPointOnQuadraticBezier((0,s.t2length)(c,Me.getPathLength(l),w=>(0,s.getQuadraticArcLength)([b.start.x,_[0],_[2]],[b.start.y,_[1],_[3]],w)),b.start.x,b.start.y,_[0],_[1],_[2],_[3]);case"A":const p=_[0],v=_[1],S=_[2],E=_[3],O=_[5],y=_[6];let f=_[4];return f+=O*c/b.pathLength,Me.getPointOnEllipticalArc(p,v,S,E,f,y)}return null}static getPointOnLine(c,l,h,g,d,b,_){b=b??l,_=_??h;const p=this.getLineLength(l,h,g,d);if(p<1e-10)return{x:l,y:h};if(g===l)return{x:b,y:_+(d>h?c:-c)};const v=(d-h)/(g-l),S=Math.sqrt(c*c/(1+v*v))*(g<l?-1:1),E=v*S;if(Math.abs(_-h-v*(b-l))<1e-10)return{x:b+S,y:_+E};const O=((b-l)*(g-l)+(_-h)*(d-h))/(p*p),y=l+O*(g-l),f=h+O*(d-h),w=this.getLineLength(b,_,y,f),P=Math.sqrt(c*c-w*w),I=Math.sqrt(P*P/(1+v*v))*(g<l?-1:1),q=v*I;return{x:y+I,y:f+q}}static getPointOnCubicBezier(c,l,h,g,d,b,_,p,v){function S(P){return P*P*P}function E(P){return 3*P*P*(1-P)}function O(P){return 3*P*(1-P)*(1-P)}function y(P){return(1-P)*(1-P)*(1-P)}const f=p*S(c)+b*E(c)+g*O(c)+l*y(c),w=v*S(c)+_*E(c)+d*O(c)+h*y(c);return{x:f,y:w}}static getPointOnQuadraticBezier(c,l,h,g,d,b,_){function p(y){return y*y}function v(y){return 2*y*(1-y)}function S(y){return(1-y)*(1-y)}const E=b*p(c)+g*v(c)+l*S(c),O=_*p(c)+d*v(c)+h*S(c);return{x:E,y:O}}static getPointOnEllipticalArc(c,l,h,g,d,b){const _=Math.cos(b),p=Math.sin(b),v={x:h*Math.cos(d),y:g*Math.sin(d)};return{x:c+(v.x*_-v.y*p),y:l+(v.x*p+v.y*_)}}static parsePathData(c){if(!c)return[];let l=c;const h=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];l=l.replace(new RegExp(" ","g"),",");for(let E=0;E<h.length;E++)l=l.replace(new RegExp(h[E],"g"),"|"+h[E]);const g=l.split("|"),d=[],b=[];let _=0,p=0;const v=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let S;for(let E=1;E<g.length;E++){let O=g[E],y=O.charAt(0);for(O=O.slice(1),b.length=0;S=v.exec(O);)b.push(S[0]);const f=[];for(let w=0,P=b.length;w<P;w++){if(b[w]==="00"){f.push(0,0);continue}const I=parseFloat(b[w]);isNaN(I)?f.push(0):f.push(I)}for(;f.length>0&&!isNaN(f[0]);){let w="",P=[];const I=_,q=p;let A,k,F,M,K,W,J,z,ft,C;switch(y){case"l":_+=f.shift(),p+=f.shift(),w="L",P.push(_,p);break;case"L":_=f.shift(),p=f.shift(),P.push(_,p);break;case"m":const R=f.shift(),G=f.shift();if(_+=R,p+=G,w="M",d.length>2&&d[d.length-1].command==="z"){for(let L=d.length-2;L>=0;L--)if(d[L].command==="M"){_=d[L].points[0]+R,p=d[L].points[1]+G;break}}P.push(_,p),y="l";break;case"M":_=f.shift(),p=f.shift(),w="M",P.push(_,p),y="L";break;case"h":_+=f.shift(),w="L",P.push(_,p);break;case"H":_=f.shift(),w="L",P.push(_,p);break;case"v":p+=f.shift(),w="L",P.push(_,p);break;case"V":p=f.shift(),w="L",P.push(_,p);break;case"C":P.push(f.shift(),f.shift(),f.shift(),f.shift()),_=f.shift(),p=f.shift(),P.push(_,p);break;case"c":P.push(_+f.shift(),p+f.shift(),_+f.shift(),p+f.shift()),_+=f.shift(),p+=f.shift(),w="C",P.push(_,p);break;case"S":k=_,F=p,A=d[d.length-1],A.command==="C"&&(k=_+(_-A.points[2]),F=p+(p-A.points[3])),P.push(k,F,f.shift(),f.shift()),_=f.shift(),p=f.shift(),w="C",P.push(_,p);break;case"s":k=_,F=p,A=d[d.length-1],A.command==="C"&&(k=_+(_-A.points[2]),F=p+(p-A.points[3])),P.push(k,F,_+f.shift(),p+f.shift()),_+=f.shift(),p+=f.shift(),w="C",P.push(_,p);break;case"Q":P.push(f.shift(),f.shift()),_=f.shift(),p=f.shift(),P.push(_,p);break;case"q":P.push(_+f.shift(),p+f.shift()),_+=f.shift(),p+=f.shift(),w="Q",P.push(_,p);break;case"T":k=_,F=p,A=d[d.length-1],A.command==="Q"&&(k=_+(_-A.points[0]),F=p+(p-A.points[1])),_=f.shift(),p=f.shift(),w="Q",P.push(k,F,_,p);break;case"t":k=_,F=p,A=d[d.length-1],A.command==="Q"&&(k=_+(_-A.points[0]),F=p+(p-A.points[1])),_+=f.shift(),p+=f.shift(),w="Q",P.push(k,F,_,p);break;case"A":M=f.shift(),K=f.shift(),W=f.shift(),J=f.shift(),z=f.shift(),ft=_,C=p,_=f.shift(),p=f.shift(),w="A",P=this.convertEndpointToCenterParameterization(ft,C,_,p,J,z,M,K,W);break;case"a":M=f.shift(),K=f.shift(),W=f.shift(),J=f.shift(),z=f.shift(),ft=_,C=p,_+=f.shift(),p+=f.shift(),w="A",P=this.convertEndpointToCenterParameterization(ft,C,_,p,J,z,M,K,W);break}d.push({command:w||y,points:P,start:{x:I,y:q},pathLength:this.calcLength(I,q,w||y,P)})}(y==="z"||y==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(c,l,h,g){let d,b,_,p;const v=Me;switch(h){case"L":return v.getLineLength(c,l,g[0],g[1]);case"C":return(0,s.getCubicArcLength)([c,g[0],g[2],g[4]],[l,g[1],g[3],g[5]],1);case"Q":return(0,s.getQuadraticArcLength)([c,g[0],g[2]],[l,g[1],g[3]],1);case"A":d=0;const S=g[4],E=g[5],O=g[4]+E;let y=Math.PI/180;if(Math.abs(S-O)<y&&(y=Math.abs(S-O)),b=v.getPointOnEllipticalArc(g[0],g[1],g[2],g[3],S,0),E<0)for(p=S-y;p>O;p-=y)_=v.getPointOnEllipticalArc(g[0],g[1],g[2],g[3],p,0),d+=v.getLineLength(b.x,b.y,_.x,_.y),b=_;else for(p=S+y;p<O;p+=y)_=v.getPointOnEllipticalArc(g[0],g[1],g[2],g[3],p,0),d+=v.getLineLength(b.x,b.y,_.x,_.y),b=_;return _=v.getPointOnEllipticalArc(g[0],g[1],g[2],g[3],O,0),d+=v.getLineLength(b.x,b.y,_.x,_.y),d}return 0}static convertEndpointToCenterParameterization(c,l,h,g,d,b,_,p,v){const S=v*(Math.PI/180),E=Math.cos(S)*(c-h)/2+Math.sin(S)*(l-g)/2,O=-1*Math.sin(S)*(c-h)/2+Math.cos(S)*(l-g)/2,y=E*E/(_*_)+O*O/(p*p);y>1&&(_*=Math.sqrt(y),p*=Math.sqrt(y));let f=Math.sqrt((_*_*(p*p)-_*_*(O*O)-p*p*(E*E))/(_*_*(O*O)+p*p*(E*E)));d===b&&(f*=-1),isNaN(f)&&(f=0);const w=f*_*O/p,P=f*-p*E/_,I=(c+h)/2+Math.cos(S)*w-Math.sin(S)*P,q=(l+g)/2+Math.sin(S)*w+Math.cos(S)*P,A=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},k=function(z,ft){return(z[0]*ft[0]+z[1]*ft[1])/(A(z)*A(ft))},F=function(z,ft){return(z[0]*ft[1]<z[1]*ft[0]?-1:1)*Math.acos(k(z,ft))},M=F([1,0],[(E-w)/_,(O-P)/p]),K=[(E-w)/_,(O-P)/p],W=[(-1*E-w)/_,(-1*O-P)/p];let J=F(K,W);return k(K,W)<=-1&&(J=Math.PI),k(K,W)>=1&&(J=0),b===0&&J>0&&(J=J-2*Math.PI),b===1&&J<0&&(J=J+2*Math.PI),[I,q,_,p,M,J,S,b]}};return Cr.Path=a,a.prototype.className="Path",a.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(a),t.Factory.addGetterSetter(a,"data"),Cr}var El;function bd(){if(El)return Sr;El=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.Arrow=void 0;const t=Yt(),e=hu(),i=Xt(),s=zt(),a=Jo();let o=class extends e.Line{_sceneFunc(l){super._sceneFunc(l);const h=Math.PI*2,g=this.points();let d=g;const b=this.tension()!==0&&g.length>4;b&&(d=this.getTensionPoints());const _=this.pointerLength(),p=g.length;let v,S;if(b){const y=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],g[p-2],g[p-1]],f=a.Path.calcLength(d[d.length-4],d[d.length-3],"C",y),w=a.Path.getPointOnQuadraticBezier(Math.min(1,1-_/f),y[0],y[1],y[2],y[3],y[4],y[5]);v=g[p-2]-w.x,S=g[p-1]-w.y}else v=g[p-2]-g[p-4],S=g[p-1]-g[p-3];const E=(Math.atan2(S,v)+h)%h,O=this.pointerWidth();this.pointerAtEnding()&&(l.save(),l.beginPath(),l.translate(g[p-2],g[p-1]),l.rotate(E),l.moveTo(0,0),l.lineTo(-_,O/2),l.lineTo(-_,-O/2),l.closePath(),l.restore(),this.__fillStroke(l)),this.pointerAtBeginning()&&(l.save(),l.beginPath(),l.translate(g[0],g[1]),b?(v=(d[0]+d[2])/2-g[0],S=(d[1]+d[3])/2-g[1]):(v=g[2]-g[0],S=g[3]-g[1]),l.rotate((Math.atan2(-S,-v)+h)%h),l.moveTo(0,0),l.lineTo(-_,O/2),l.lineTo(-_,-O/2),l.closePath(),l.restore(),this.__fillStroke(l))}__fillStroke(l){const h=this.dashEnabled();h&&(this.attrs.dashEnabled=!1,l.setLineDash([])),l.fillStrokeShape(this),h&&(this.attrs.dashEnabled=!0)}getSelfRect(){const l=super.getSelfRect(),h=this.pointerWidth()/2;return{x:l.x,y:l.y-h,width:l.width,height:l.height+h*2}}};return Sr.Arrow=o,o.prototype.className="Arrow",(0,s._registerNode)(o),t.Factory.addGetterSetter(o,"pointerLength",10,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"pointerWidth",10,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"pointerAtBeginning",!1),t.Factory.addGetterSetter(o,"pointerAtEnding",!0),Sr}var Pr={},Al;function wd(){if(Al)return Pr;Al=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.Circle=void 0;const t=Yt(),e=_e(),i=Xt(),s=zt();let a=class extends e.Shape{_sceneFunc(c){c.beginPath(),c.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),c.closePath(),c.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(c){this.radius()!==c/2&&this.radius(c/2)}setHeight(c){this.radius()!==c/2&&this.radius(c/2)}};return Pr.Circle=a,a.prototype._centroid=!0,a.prototype.className="Circle",a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),t.Factory.addGetterSetter(a,"radius",0,(0,i.getNumberValidator)()),Pr}var Tr={},Rl;function Sd(){if(Rl)return Tr;Rl=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Ellipse=void 0;const t=Yt(),e=_e(),i=Xt(),s=zt();let a=class extends e.Shape{_sceneFunc(c){const l=this.radiusX(),h=this.radiusY();c.beginPath(),c.save(),l!==h&&c.scale(1,h/l),c.arc(0,0,l,0,Math.PI*2,!1),c.restore(),c.closePath(),c.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(c){this.radiusX(c/2)}setHeight(c){this.radiusY(c/2)}};return Tr.Ellipse=a,a.prototype.className="Ellipse",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,s._registerNode)(a),t.Factory.addComponentsGetterSetter(a,"radius",["x","y"]),t.Factory.addGetterSetter(a,"radiusX",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(a,"radiusY",0,(0,i.getNumberValidator)()),Tr}var Er={},kl;function xd(){if(kl)return Er;kl=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.Image=void 0;const t=ce(),e=Yt(),i=_e(),s=zt(),a=Xt();class o extends i.Shape{constructor(l){super(l),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",h=>{this._removeImageLoad(h.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const l=this.image();l&&l.complete||l&&l.readyState===4||l&&l.addEventListener&&l.addEventListener("load",this._loadListener)}_removeImageLoad(l){l&&l.removeEventListener&&l.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const l=!!this.cornerRadius(),h=this.hasShadow();return l&&h?!0:super._useBufferCanvas(!0)}_sceneFunc(l){const h=this.getWidth(),g=this.getHeight(),d=this.cornerRadius(),b=this.attrs.image;let _;if(b){const p=this.attrs.cropWidth,v=this.attrs.cropHeight;p&&v?_=[b,this.cropX(),this.cropY(),p,v,0,0,h,g]:_=[b,0,0,h,g]}(this.hasFill()||this.hasStroke()||d)&&(l.beginPath(),d?t.Util.drawRoundedRectPath(l,h,g,d):l.rect(0,0,h,g),l.closePath(),l.fillStrokeShape(this)),b&&(d&&l.clip(),l.drawImage.apply(l,_))}_hitFunc(l){const h=this.width(),g=this.height(),d=this.cornerRadius();l.beginPath(),d?t.Util.drawRoundedRectPath(l,h,g,d):l.rect(0,0,h,g),l.closePath(),l.fillStrokeShape(this)}getWidth(){var l,h;return(l=this.attrs.width)!==null&&l!==void 0?l:(h=this.image())===null||h===void 0?void 0:h.width}getHeight(){var l,h;return(l=this.attrs.height)!==null&&l!==void 0?l:(h=this.image())===null||h===void 0?void 0:h.height}static fromURL(l,h,g=null){const d=t.Util.createImageElement();d.onload=function(){const b=new o({image:d});h(b)},d.onerror=g,d.crossOrigin="Anonymous",d.src=l}}return Er.Image=o,o.prototype.className="Image",(0,s._registerNode)(o),e.Factory.addGetterSetter(o,"cornerRadius",0,(0,a.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(o,"image"),e.Factory.addComponentsGetterSetter(o,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(o,"cropX",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(o,"cropY",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(o,"cropWidth",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(o,"cropHeight",0,(0,a.getNumberValidator)()),Er}var Nn={},Ol;function Cd(){if(Ol)return Nn;Ol=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Tag=Nn.Label=void 0;const t=Yt(),e=_e(),i=Xo(),s=Xt(),a=zt(),o=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],c="Change.konva",l="none",h="up",g="right",d="down",b="left",_=o.length;let p=class extends i.Group{constructor(E){super(E),this.on("add.konva",function(O){this._addListeners(O.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(E){let O=this,y;const f=function(){O._sync()};for(y=0;y<_;y++)E.on(o[y]+c,f)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let E=this.getText(),O=this.getTag(),y,f,w,P,I,q,A;if(E&&O){switch(y=E.width(),f=E.height(),w=O.pointerDirection(),P=O.pointerWidth(),A=O.pointerHeight(),I=0,q=0,w){case h:I=y/2,q=-1*A;break;case g:I=y+P,q=f/2;break;case d:I=y/2,q=f+A;break;case b:I=-1*P,q=f/2;break}O.setAttrs({x:-1*I,y:-1*q,width:y,height:f}),E.setAttrs({x:-1*I,y:-1*q})}}};Nn.Label=p,p.prototype.className="Label",(0,a._registerNode)(p);class v extends e.Shape{_sceneFunc(E){const O=this.width(),y=this.height(),f=this.pointerDirection(),w=this.pointerWidth(),P=this.pointerHeight(),I=this.cornerRadius();let q=0,A=0,k=0,F=0;typeof I=="number"?q=A=k=F=Math.min(I,O/2,y/2):(q=Math.min(I[0]||0,O/2,y/2),A=Math.min(I[1]||0,O/2,y/2),F=Math.min(I[2]||0,O/2,y/2),k=Math.min(I[3]||0,O/2,y/2)),E.beginPath(),E.moveTo(q,0),f===h&&(E.lineTo((O-w)/2,0),E.lineTo(O/2,-1*P),E.lineTo((O+w)/2,0)),E.lineTo(O-A,0),E.arc(O-A,A,A,Math.PI*3/2,0,!1),f===g&&(E.lineTo(O,(y-P)/2),E.lineTo(O+w,y/2),E.lineTo(O,(y+P)/2)),E.lineTo(O,y-F),E.arc(O-F,y-F,F,0,Math.PI/2,!1),f===d&&(E.lineTo((O+w)/2,y),E.lineTo(O/2,y+P),E.lineTo((O-w)/2,y)),E.lineTo(k,y),E.arc(k,y-k,k,Math.PI/2,Math.PI,!1),f===b&&(E.lineTo(0,(y+P)/2),E.lineTo(-1*w,y/2),E.lineTo(0,(y-P)/2)),E.lineTo(0,q),E.arc(q,q,q,Math.PI,Math.PI*3/2,!1),E.closePath(),E.fillStrokeShape(this)}getSelfRect(){let E=0,O=0,y=this.pointerWidth(),f=this.pointerHeight(),w=this.pointerDirection(),P=this.width(),I=this.height();return w===h?(O-=f,I+=f):w===d?I+=f:w===b?(E-=y*1.5,P+=y):w===g&&(P+=y*1.5),{x:E,y:O,width:P,height:I}}}return Nn.Tag=v,v.prototype.className="Tag",(0,a._registerNode)(v),t.Factory.addGetterSetter(v,"pointerDirection",l),t.Factory.addGetterSetter(v,"pointerWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(v,"pointerHeight",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(v,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Nn}var Ar={},Ml;function fu(){if(Ml)return Ar;Ml=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.Rect=void 0;const t=Yt(),e=_e(),i=zt(),s=ce(),a=Xt();let o=class extends e.Shape{_sceneFunc(l){const h=this.cornerRadius(),g=this.width(),d=this.height();l.beginPath(),h?s.Util.drawRoundedRectPath(l,g,d,h):l.rect(0,0,g,d),l.closePath(),l.fillStrokeShape(this)}};return Ar.Rect=o,o.prototype.className="Rect",(0,i._registerNode)(o),t.Factory.addGetterSetter(o,"cornerRadius",0,(0,a.getNumberOrArrayOfNumbersValidator)(4)),Ar}var Rr={},Fl;function Pd(){if(Fl)return Rr;Fl=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.RegularPolygon=void 0;const t=Yt(),e=_e(),i=Xt(),s=zt();let a=class extends e.Shape{_sceneFunc(c){const l=this._getPoints();c.beginPath(),c.moveTo(l[0].x,l[0].y);for(let h=1;h<l.length;h++)c.lineTo(l[h].x,l[h].y);c.closePath(),c.fillStrokeShape(this)}_getPoints(){const c=this.attrs.sides,l=this.attrs.radius||0,h=[];for(let g=0;g<c;g++)h.push({x:l*Math.sin(g*2*Math.PI/c),y:-1*l*Math.cos(g*2*Math.PI/c)});return h}getSelfRect(){const c=this._getPoints();let l=c[0].x,h=c[0].y,g=c[0].x,d=c[0].y;return c.forEach(b=>{l=Math.min(l,b.x),h=Math.max(h,b.x),g=Math.min(g,b.y),d=Math.max(d,b.y)}),{x:l,y:g,width:h-l,height:d-g}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(c){this.radius(c/2)}setHeight(c){this.radius(c/2)}};return Rr.RegularPolygon=a,a.prototype.className="RegularPolygon",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),t.Factory.addGetterSetter(a,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(a,"sides",0,(0,i.getNumberValidator)()),Rr}var kr={},Il;function Td(){if(Il)return kr;Il=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.Ring=void 0;const t=Yt(),e=_e(),i=Xt(),s=zt(),a=Math.PI*2;let o=class extends e.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.innerRadius(),0,a,!1),l.moveTo(this.outerRadius(),0),l.arc(0,0,this.outerRadius(),a,0,!0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}};return kr.Ring=o,o.prototype.className="Ring",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,s._registerNode)(o),t.Factory.addGetterSetter(o,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"outerRadius",0,(0,i.getNumberValidator)()),kr}var Or={},Nl;function Ed(){if(Nl)return Or;Nl=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.Sprite=void 0;const t=Yt(),e=_e(),i=Qo(),s=Xt(),a=zt();let o=class extends e.Shape{constructor(l){super(l),this._updated=!0,this.anim=new i.Animation(()=>{const h=this._updated;return this._updated=!1,h}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(l){const h=this.animation(),g=this.frameIndex(),d=g*4,b=this.animations()[h],_=this.frameOffsets(),p=b[d+0],v=b[d+1],S=b[d+2],E=b[d+3],O=this.image();if((this.hasFill()||this.hasStroke())&&(l.beginPath(),l.rect(0,0,S,E),l.closePath(),l.fillStrokeShape(this)),O)if(_){const y=_[h],f=g*2;l.drawImage(O,p,v,S,E,y[f+0],y[f+1],S,E)}else l.drawImage(O,p,v,S,E,0,0,S,E)}_hitFunc(l){const h=this.animation(),g=this.frameIndex(),d=g*4,b=this.animations()[h],_=this.frameOffsets(),p=b[d+2],v=b[d+3];if(l.beginPath(),_){const S=_[h],E=g*2;l.rect(S[E+0],S[E+1],p,v)}else l.rect(0,0,p,v);l.closePath(),l.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const l=this;this.interval=setInterval(function(){l._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const l=this.getLayer();this.anim.setLayers(l),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const l=this.frameIndex(),h=this.animation(),g=this.animations(),d=g[h],b=d.length/4;l<b-1?this.frameIndex(l+1):this.frameIndex(0)}};return Or.Sprite=o,o.prototype.className="Sprite",(0,a._registerNode)(o),t.Factory.addGetterSetter(o,"animation"),t.Factory.addGetterSetter(o,"animations"),t.Factory.addGetterSetter(o,"frameOffsets"),t.Factory.addGetterSetter(o,"image"),t.Factory.addGetterSetter(o,"frameIndex",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"frameRate",17,(0,s.getNumberValidator)()),t.Factory.backCompat(o,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Or}var Mr={},Dl;function Ad(){if(Dl)return Mr;Dl=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Star=void 0;const t=Yt(),e=_e(),i=Xt(),s=zt();let a=class extends e.Shape{_sceneFunc(c){const l=this.innerRadius(),h=this.outerRadius(),g=this.numPoints();c.beginPath(),c.moveTo(0,0-h);for(let d=1;d<g*2;d++){const b=d%2===0?h:l,_=b*Math.sin(d*Math.PI/g),p=-1*b*Math.cos(d*Math.PI/g);c.lineTo(_,p)}c.closePath(),c.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(c){this.outerRadius(c/2)}setHeight(c){this.outerRadius(c/2)}};return Mr.Star=a,a.prototype.className="Star",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,s._registerNode)(a),t.Factory.addGetterSetter(a,"numPoints",5,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(a,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(a,"outerRadius",0,(0,i.getNumberValidator)()),Mr}var Yn={},Ll;function du(){if(Ll)return Yn;Ll=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.Text=void 0,Yn.stringToArray=c;const t=ce(),e=Yt(),i=_e(),s=zt(),a=Xt(),o=zt();function c(ct){return[...ct].reduce(($,vt,St,ot)=>{if(new RegExp("\\p{Emoji}","u").test(vt)){const B=ot[St+1];B&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(B)?($.push(vt+B),ot[St+1]=""):$.push(vt)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(vt+(ot[St+1]||""))?$.push(vt+ot[St+1]):St>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(vt)?$[$.length-1]+=vt:vt&&$.push(vt);return $},[])}const l="auto",h="center",g="inherit",d="justify",b="Change.konva",_="2d",p="-",v="left",S="text",E="Text",O="top",y="bottom",f="middle",w="normal",P="px ",I=" ",q="right",A="rtl",k="word",F="char",M="none",K="",W=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],J=W.length;function z(ct){return ct.split(",").map($=>{$=$.trim();const vt=$.indexOf(" ")>=0,St=$.indexOf('"')>=0||$.indexOf("'")>=0;return vt&&!St&&($=`"${$}"`),$}).join(", ")}let ft;function C(){return ft||(ft=t.Util.createCanvasElement().getContext(_),ft)}function R(ct){ct.fillText(this._partialText,this._partialTextX,this._partialTextY)}function G(ct){ct.setAttr("miterLimit",2),ct.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function L(ct){return ct=ct||{},!ct.fillLinearGradientColorStops&&!ct.fillRadialGradientColorStops&&!ct.fillPatternImage&&(ct.fill=ct.fill||"black"),ct}let j=class extends i.Shape{constructor($){super(L($)),this._partialTextX=0,this._partialTextY=0;for(let vt=0;vt<J;vt++)this.on(W[vt]+b,this._setTextData);this._setTextData()}_sceneFunc($){const vt=this.textArr,St=vt.length;if(!this.text())return;let ot=this.padding(),B=this.fontSize(),at=this.lineHeight()*B,ht=this.verticalAlign(),At=this.direction(),Dt=0,N=this.align(),V=this.getWidth(),st=this.letterSpacing(),ut=this.fill(),pt=this.textDecoration(),dt=pt.indexOf("underline")!==-1,bt=pt.indexOf("line-through")!==-1,xt;At=At===g?$.direction:At;let _t=at/2,mt=f;if(s.Konva._fixTextRendering){const kt=this.measureSize("M");mt="alphabetic",_t=(kt.fontBoundingBoxAscent-kt.fontBoundingBoxDescent)/2+at/2}for(At===A&&$.setAttr("direction",At),$.setAttr("font",this._getContextFont()),$.setAttr("textBaseline",mt),$.setAttr("textAlign",v),ht===f?Dt=(this.getHeight()-St*at-ot*2)/2:ht===y&&(Dt=this.getHeight()-St*at-ot*2),$.translate(ot,Dt+ot),xt=0;xt<St;xt++){let kt=0,Ct=0;const Nt=vt[xt],Lt=Nt.text,Gt=Nt.width,Ut=Nt.lastInParagraph;if($.save(),N===q?kt+=V-Gt-ot*2:N===h&&(kt+=(V-Gt-ot*2)/2),dt){$.save(),$.beginPath();const Bt=s.Konva._fixTextRendering?Math.round(B/4):Math.round(B/2),Zt=kt,Jt=_t+Ct+Bt;$.moveTo(Zt,Jt);const te=N===d&&!Ut?V-ot*2:Gt;$.lineTo(Zt+Math.round(te),Jt),$.lineWidth=B/15;const oe=this._getLinearGradient();$.strokeStyle=oe||ut,$.stroke(),$.restore()}if(bt){$.save(),$.beginPath();const Bt=s.Konva._fixTextRendering?-Math.round(B/4):0;$.moveTo(kt,_t+Ct+Bt);const Zt=N===d&&!Ut?V-ot*2:Gt;$.lineTo(kt+Math.round(Zt),_t+Ct+Bt),$.lineWidth=B/15;const Jt=this._getLinearGradient();$.strokeStyle=Jt||ut,$.stroke(),$.restore()}if(At!==A&&(st!==0||N===d)){const Bt=Lt.split(" ").length-1,Zt=c(Lt);for(let Jt=0;Jt<Zt.length;Jt++){const te=Zt[Jt];te===" "&&!Ut&&N===d&&(kt+=(V-ot*2-Gt)/Bt),this._partialTextX=kt,this._partialTextY=_t+Ct,this._partialText=te,$.fillStrokeShape(this),kt+=this.measureSize(te).width+st}}else st!==0&&$.setAttr("letterSpacing",`${st}px`),this._partialTextX=kt,this._partialTextY=_t+Ct,this._partialText=Lt,$.fillStrokeShape(this);$.restore(),St>1&&(_t+=at)}}_hitFunc($){const vt=this.getWidth(),St=this.getHeight();$.beginPath(),$.rect(0,0,vt,St),$.closePath(),$.fillStrokeShape(this)}setText($){const vt=t.Util._isString($)?$:$==null?"":$+"";return this._setAttr(S,vt),this}getWidth(){return this.attrs.width===l||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===l||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize($){var vt,St,ot,B,at,ht,At,Dt,N,V,st;let ut=C(),pt=this.fontSize(),dt;ut.save(),ut.font=this._getContextFont(),dt=ut.measureText($),ut.restore();const bt=pt/100;return{actualBoundingBoxAscent:(vt=dt.actualBoundingBoxAscent)!==null&&vt!==void 0?vt:71.58203125*bt,actualBoundingBoxDescent:(St=dt.actualBoundingBoxDescent)!==null&&St!==void 0?St:0,actualBoundingBoxLeft:(ot=dt.actualBoundingBoxLeft)!==null&&ot!==void 0?ot:-7.421875*bt,actualBoundingBoxRight:(B=dt.actualBoundingBoxRight)!==null&&B!==void 0?B:75.732421875*bt,alphabeticBaseline:(at=dt.alphabeticBaseline)!==null&&at!==void 0?at:0,emHeightAscent:(ht=dt.emHeightAscent)!==null&&ht!==void 0?ht:100*bt,emHeightDescent:(At=dt.emHeightDescent)!==null&&At!==void 0?At:-20*bt,fontBoundingBoxAscent:(Dt=dt.fontBoundingBoxAscent)!==null&&Dt!==void 0?Dt:91*bt,fontBoundingBoxDescent:(N=dt.fontBoundingBoxDescent)!==null&&N!==void 0?N:21*bt,hangingBaseline:(V=dt.hangingBaseline)!==null&&V!==void 0?V:72.80000305175781*bt,ideographicBaseline:(st=dt.ideographicBaseline)!==null&&st!==void 0?st:-21*bt,width:dt.width,height:pt}}_getContextFont(){return this.fontStyle()+I+this.fontVariant()+I+(this.fontSize()+P)+z(this.fontFamily())}_addTextLine($){this.align()===d&&($=$.trim());const St=this._getTextWidth($);return this.textArr.push({text:$,width:St,lastInParagraph:!1})}_getTextWidth($){const vt=this.letterSpacing(),St=$.length;return C().measureText($).width+vt*St}_setTextData(){let $=this.text().split(`
`),vt=+this.fontSize(),St=0,ot=this.lineHeight()*vt,B=this.attrs.width,at=this.attrs.height,ht=B!==l&&B!==void 0,At=at!==l&&at!==void 0,Dt=this.padding(),N=B-Dt*2,V=at-Dt*2,st=0,ut=this.wrap(),pt=ut!==M,dt=ut!==F&&pt,bt=this.ellipsis();this.textArr=[],C().font=this._getContextFont();const xt=bt?this._getTextWidth(K):0;for(let _t=0,mt=$.length;_t<mt;++_t){let kt=$[_t],Ct=this._getTextWidth(kt);if(ht&&Ct>N)for(;kt.length>0;){let Nt=0,Lt=c(kt).length,Gt="",Ut=0;for(;Nt<Lt;){const Bt=Nt+Lt>>>1,Zt=c(kt),Jt=Zt.slice(0,Bt+1).join(""),te=this._getTextWidth(Jt);(bt&&At&&st+ot>V?te+xt:te)<=N?(Nt=Bt+1,Gt=Jt,Ut=te):Lt=Bt}if(Gt){if(dt){const Jt=c(kt),te=c(Gt),oe=Jt[te.length],Ie=oe===I||oe===p;let Be;if(Ie&&Ut<=N)Be=te.length;else{const ae=te.lastIndexOf(I),Ft=te.lastIndexOf(p);Be=Math.max(ae,Ft)+1}Be>0&&(Nt=Be,Gt=Jt.slice(0,Nt).join(""),Ut=this._getTextWidth(Gt))}if(Gt=Gt.trimRight(),this._addTextLine(Gt),St=Math.max(St,Ut),st+=ot,this._shouldHandleEllipsis(st)){this._tryToAddEllipsisToLastLine();break}if(kt=c(kt).slice(Nt).join("").trimLeft(),kt.length>0&&(Ct=this._getTextWidth(kt),Ct<=N)){this._addTextLine(kt),st+=ot,St=Math.max(St,Ct);break}}else break}else this._addTextLine(kt),st+=ot,St=Math.max(St,Ct),this._shouldHandleEllipsis(st)&&_t<mt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),At&&st+ot>V)break}this.textHeight=vt,this.textWidth=St}_shouldHandleEllipsis($){const vt=+this.fontSize(),St=this.lineHeight()*vt,ot=this.attrs.height,B=ot!==l&&ot!==void 0,at=this.padding(),ht=ot-at*2;return!(this.wrap()!==M)||B&&$+St>ht}_tryToAddEllipsisToLastLine(){const $=this.attrs.width,vt=$!==l&&$!==void 0,St=this.padding(),ot=$-St*2,B=this.ellipsis(),at=this.textArr[this.textArr.length-1];!at||!B||(vt&&(this._getTextWidth(at.text+K)<ot||(at.text=at.text.slice(0,at.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(at.text+K))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const $=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,vt=this.hasShadow();return $&&vt?!0:super._useBufferCanvas()}};return Yn.Text=j,j.prototype._fillFunc=R,j.prototype._strokeFunc=G,j.prototype.className=E,j.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,o._registerNode)(j),e.Factory.overWriteSetter(j,"width",(0,a.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(j,"height",(0,a.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(j,"direction",g),e.Factory.addGetterSetter(j,"fontFamily","Arial"),e.Factory.addGetterSetter(j,"fontSize",12,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"fontStyle",w),e.Factory.addGetterSetter(j,"fontVariant",w),e.Factory.addGetterSetter(j,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"align",v),e.Factory.addGetterSetter(j,"verticalAlign",O),e.Factory.addGetterSetter(j,"lineHeight",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"wrap",k),e.Factory.addGetterSetter(j,"ellipsis",!1,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(j,"letterSpacing",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"text","",(0,a.getStringValidator)()),e.Factory.addGetterSetter(j,"textDecoration",""),Yn}var Fr={},Gl;function Rd(){if(Gl)return Fr;Gl=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.TextPath=void 0;const t=ce(),e=Yt(),i=_e(),s=Jo(),a=du(),o=Xt(),c=zt(),l="",h="normal";function g(_){_.fillText(this.partialText,0,0)}function d(_){_.strokeText(this.partialText,0,0)}let b=class extends i.Shape{constructor(p){super(p),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return s.Path.getPathLength(this.dataArray)}_getPointAtLength(p){if(!this.attrs.data)return null;const v=this.pathLength;return p-1>v?null:s.Path.getPointAtLengthOfDataArray(p,this.dataArray)}_readDataAttribute(){this.dataArray=s.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(p){p.setAttr("font",this._getContextFont()),p.setAttr("textBaseline",this.textBaseline()),p.setAttr("textAlign","left"),p.save();const v=this.textDecoration(),S=this.fill(),E=this.fontSize(),O=this.glyphInfo;v==="underline"&&p.beginPath();for(let y=0;y<O.length;y++){p.save();const f=O[y].p0;p.translate(f.x,f.y),p.rotate(O[y].rotation),this.partialText=O[y].text,p.fillStrokeShape(this),v==="underline"&&(y===0&&p.moveTo(0,E/2+1),p.lineTo(E,E/2+1)),p.restore()}v==="underline"&&(p.strokeStyle=S,p.lineWidth=E/20,p.stroke()),p.restore()}_hitFunc(p){p.beginPath();const v=this.glyphInfo;if(v.length>=1){const S=v[0].p0;p.moveTo(S.x,S.y)}for(let S=0;S<v.length;S++){const E=v[S].p1;p.lineTo(E.x,E.y)}p.setAttr("lineWidth",this.fontSize()),p.setAttr("strokeStyle",this.colorKey),p.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(p){return a.Text.prototype.setText.call(this,p)}_getContextFont(){return a.Text.prototype._getContextFont.call(this)}_getTextSize(p){const S=this.dummyCanvas.getContext("2d");S.save(),S.font=this._getContextFont();const E=S.measureText(p);return S.restore(),{width:E.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:p,height:v}=this._getTextSize(this.attrs.text);if(this.textWidth=p,this.textHeight=v,this.glyphInfo=[],!this.attrs.data)return null;const S=this.letterSpacing(),E=this.align(),O=this.kerningFunc(),y=Math.max(this.textWidth+((this.attrs.text||"").length-1)*S,0);let f=0;E==="center"&&(f=Math.max(0,this.pathLength/2-y/2)),E==="right"&&(f=Math.max(0,this.pathLength-y));const w=(0,a.stringToArray)(this.text());let P=f;for(let I=0;I<w.length;I++){const q=this._getPointAtLength(P);if(!q)return;let A=this._getTextSize(w[I]).width+S;if(w[I]===" "&&E==="justify"){const J=this.text().split(" ").length-1;A+=(this.pathLength-y)/J}const k=this._getPointAtLength(P+A);if(!k)return;const F=s.Path.getLineLength(q.x,q.y,k.x,k.y);let M=0;if(O)try{M=O(w[I-1],w[I])*this.fontSize()}catch{M=0}q.x+=M,k.x+=M,this.textWidth+=M;const K=s.Path.getPointOnLine(M+F/2,q.x,q.y,k.x,k.y),W=Math.atan2(k.y-q.y,k.x-q.x);this.glyphInfo.push({transposeX:K.x,transposeY:K.y,text:w[I],rotation:W,p0:q,p1:k}),P+=A}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const p=[];this.glyphInfo.forEach(function(P){p.push(P.p0.x),p.push(P.p0.y),p.push(P.p1.x),p.push(P.p1.y)});let v=p[0]||0,S=p[0]||0,E=p[1]||0,O=p[1]||0,y,f;for(let P=0;P<p.length/2;P++)y=p[P*2],f=p[P*2+1],v=Math.min(v,y),S=Math.max(S,y),E=Math.min(E,f),O=Math.max(O,f);const w=this.fontSize();return{x:v-w/2,y:E-w/2,width:S-v+w,height:O-E+w}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Fr.TextPath=b,b.prototype._fillFunc=g,b.prototype._strokeFunc=d,b.prototype._fillFuncHit=g,b.prototype._strokeFuncHit=d,b.prototype.className="TextPath",b.prototype._attrsAffectingSize=["text","fontSize","data"],(0,c._registerNode)(b),e.Factory.addGetterSetter(b,"data"),e.Factory.addGetterSetter(b,"fontFamily","Arial"),e.Factory.addGetterSetter(b,"fontSize",12,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(b,"fontStyle",h),e.Factory.addGetterSetter(b,"align","left"),e.Factory.addGetterSetter(b,"letterSpacing",0,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(b,"textBaseline","middle"),e.Factory.addGetterSetter(b,"fontVariant",h),e.Factory.addGetterSetter(b,"text",l),e.Factory.addGetterSetter(b,"textDecoration",""),e.Factory.addGetterSetter(b,"kerningFunc",void 0),Fr}var Ir={},Bl;function kd(){if(Bl)return Ir;Bl=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Transformer=void 0;const t=ce(),e=Yt(),i=de(),s=_e(),a=fu(),o=Xo(),c=zt(),l=Xt(),h=zt(),g="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(A=>A+`.${g}`).join(" "),b="nodesRect",_=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],p={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},v="ontouchstart"in c.Konva._global;function S(A,k,F){if(A==="rotater")return F;k+=t.Util.degToRad(p[A]||0);const M=(t.Util.radToDeg(k)%360+360)%360;return t.Util._inRange(M,315+22.5,360)||t.Util._inRange(M,0,22.5)?"ns-resize":t.Util._inRange(M,45-22.5,45+22.5)?"nesw-resize":t.Util._inRange(M,90-22.5,90+22.5)?"ew-resize":t.Util._inRange(M,135-22.5,135+22.5)?"nwse-resize":t.Util._inRange(M,180-22.5,180+22.5)?"ns-resize":t.Util._inRange(M,225-22.5,225+22.5)?"nesw-resize":t.Util._inRange(M,270-22.5,270+22.5)?"ew-resize":t.Util._inRange(M,315-22.5,315+22.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+M),"pointer")}const E=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function O(A){return{x:A.x+A.width/2*Math.cos(A.rotation)+A.height/2*Math.sin(-A.rotation),y:A.y+A.height/2*Math.cos(A.rotation)+A.width/2*Math.sin(A.rotation)}}function y(A,k,F){const M=F.x+(A.x-F.x)*Math.cos(k)-(A.y-F.y)*Math.sin(k),K=F.y+(A.x-F.x)*Math.sin(k)+(A.y-F.y)*Math.cos(k);return{...A,rotation:A.rotation+k,x:M,y:K}}function f(A,k){const F=O(A);return y(A,k,F)}function w(A,k,F){let M=k;for(let K=0;K<A.length;K++){const W=c.Konva.getAngle(A[K]),J=Math.abs(W-k)%(Math.PI*2);Math.min(J,Math.PI*2-J)<F&&(M=W)}return M}let P=0,I=class extends o.Group{constructor(k){super(k),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(k){return this.setNode(k),this}setNode(k){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([k])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return g+this._id}setNodes(k=[]){this._nodes&&this._nodes.length&&this.detach();const F=k.filter(K=>K.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=k=F,k.length===1&&this.useSingleNodeRotation()?this.rotation(k[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(K=>{const W=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(K._attrsAffectingSize.length){const J=K._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");K.on(J,W)}K.on(_.map(J=>J+`.${this._getEventNamespace()}`).join(" "),W),K.on(`absoluteTransformChange.${this._getEventNamespace()}`,W),this._proxyDrag(K)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(k){let F;k.on(`dragstart.${this._getEventNamespace()}`,M=>{F=k.getAbsolutePosition(),!this.isDragging()&&k!==this.findOne(".back")&&this.startDrag(M,!1)}),k.on(`dragmove.${this._getEventNamespace()}`,M=>{if(!F)return;const K=k.getAbsolutePosition(),W=K.x-F.x,J=K.y-F.y;this.nodes().forEach(z=>{if(z===k||z.isDragging())return;const ft=z.getAbsolutePosition();z.setAbsolutePosition({x:ft.x+W,y:ft.y+J}),z.startDrag(M)}),F=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(k=>{k.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(b),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(b,this.__getNodeRect)}__getNodeShape(k,F=this.rotation(),M){const K=k.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),W=k.getAbsoluteScale(M),J=k.getAbsolutePosition(M),z=K.x*W.x-k.offsetX()*W.x,ft=K.y*W.y-k.offsetY()*W.y,C=(c.Konva.getAngle(k.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),R={x:J.x+z*Math.cos(C)+ft*Math.sin(-C),y:J.y+ft*Math.cos(C)+z*Math.sin(C),width:K.width*W.x,height:K.height*W.y,rotation:C};return y(R,-c.Konva.getAngle(F),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const F=[];this.nodes().map(C=>{const R=C.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),G=[{x:R.x,y:R.y},{x:R.x+R.width,y:R.y},{x:R.x+R.width,y:R.y+R.height},{x:R.x,y:R.y+R.height}],L=C.getAbsoluteTransform();G.forEach(function(j){const ct=L.point(j);F.push(ct)})});const M=new t.Transform;M.rotate(-c.Konva.getAngle(this.rotation()));let K=1/0,W=1/0,J=-1/0,z=-1/0;F.forEach(function(C){const R=M.point(C);K===void 0&&(K=J=R.x,W=z=R.y),K=Math.min(K,R.x),W=Math.min(W,R.y),J=Math.max(J,R.x),z=Math.max(z,R.y)}),M.invert();const ft=M.point({x:K,y:W});return{x:ft.x,y:ft.y,width:J-K,height:z-W,rotation:c.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),E.forEach(k=>{this._createAnchor(k)}),this._createAnchor("rotater")}_createAnchor(k){const F=new a.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:k+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),M=this;F.on("mousedown touchstart",function(K){M._handleMouseDown(K)}),F.on("dragstart",K=>{F.stopDrag(),K.cancelBubble=!0}),F.on("dragend",K=>{K.cancelBubble=!0}),F.on("mouseenter",()=>{const K=c.Konva.getAngle(this.rotation()),W=this.rotateAnchorCursor(),J=S(k,K,W);F.getStage().content&&(F.getStage().content.style.cursor=J),this._cursorChange=!0}),F.on("mouseout",()=>{F.getStage().content&&(F.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(F)}_createBack(){const k=new s.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(F,M){const K=M.getParent(),W=K.padding();F.beginPath(),F.rect(-W,-W,M.width()+W*2,M.height()+W*2),F.moveTo(M.width()/2,-W),K.rotateEnabled()&&K.rotateLineVisible()&&F.lineTo(M.width()/2,-K.rotateAnchorOffset()*t.Util._sign(M.height())-W),F.fillStrokeShape(M)},hitFunc:(F,M)=>{if(!this.shouldOverdrawWholeArea())return;const K=this.padding();F.beginPath(),F.rect(-K,-K,M.width()+K*2,M.height()+K*2),F.fillStrokeShape(M)}});this.add(k),this._proxyDrag(k),k.on("dragstart",F=>{F.cancelBubble=!0}),k.on("dragmove",F=>{F.cancelBubble=!0}),k.on("dragend",F=>{F.cancelBubble=!0}),this.on("dragmove",F=>{this.update()})}_handleMouseDown(k){if(this._transforming)return;this._movingAnchorName=k.target.name().split(" ")[0];const F=this._getNodeRect(),M=F.width,K=F.height,W=Math.sqrt(Math.pow(M,2)+Math.pow(K,2));this.sin=Math.abs(K/W),this.cos=Math.abs(M/W),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const J=k.target.getAbsolutePosition(),z=k.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-J.x,y:z.y-J.y},P++,this._fire("transformstart",{evt:k.evt,target:this.getNode()}),this._nodes.forEach(ft=>{ft._fire("transformstart",{evt:k.evt,target:ft})})}_handleMouseMove(k){let F,M,K;const W=this.findOne("."+this._movingAnchorName),J=W.getStage();J.setPointersPositions(k);const z=J.getPointerPosition();let ft={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const C=W.getAbsolutePosition();this.anchorDragBoundFunc()&&(ft=this.anchorDragBoundFunc()(C,ft,k)),W.setAbsolutePosition(ft);const R=W.getAbsolutePosition();if(C.x===R.x&&C.y===R.y)return;if(this._movingAnchorName==="rotater"){const ot=this._getNodeRect();F=W.x()-ot.width/2,M=-W.y()+ot.height/2;let B=Math.atan2(-M,F)+Math.PI/2;ot.height<0&&(B-=Math.PI);const ht=c.Konva.getAngle(this.rotation())+B,At=c.Konva.getAngle(this.rotationSnapTolerance()),N=w(this.rotationSnaps(),ht,At)-ot.rotation,V=f(ot,N);this._fitNodesInto(V,k);return}const G=this.shiftBehavior();let L;G==="inverted"?L=this.keepRatio()&&!k.shiftKey:G==="none"?L=this.keepRatio():L=this.keepRatio()||k.shiftKey;let j=this.centeredScaling()||k.altKey;if(this._movingAnchorName==="top-left"){if(L){const ot=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};K=Math.sqrt(Math.pow(ot.x-W.x(),2)+Math.pow(ot.y-W.y(),2));const B=this.findOne(".top-left").x()>ot.x?-1:1,at=this.findOne(".top-left").y()>ot.y?-1:1;F=K*this.cos*B,M=K*this.sin*at,this.findOne(".top-left").x(ot.x-F),this.findOne(".top-left").y(ot.y-M)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(W.y());else if(this._movingAnchorName==="top-right"){if(L){const ot=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};K=Math.sqrt(Math.pow(W.x()-ot.x,2)+Math.pow(ot.y-W.y(),2));const B=this.findOne(".top-right").x()<ot.x?-1:1,at=this.findOne(".top-right").y()>ot.y?-1:1;F=K*this.cos*B,M=K*this.sin*at,this.findOne(".top-right").x(ot.x+F),this.findOne(".top-right").y(ot.y-M)}var ct=W.position();this.findOne(".top-left").y(ct.y),this.findOne(".bottom-right").x(ct.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(W.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(W.x());else if(this._movingAnchorName==="bottom-left"){if(L){const ot=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};K=Math.sqrt(Math.pow(ot.x-W.x(),2)+Math.pow(W.y()-ot.y,2));const B=ot.x<W.x()?-1:1,at=W.y()<ot.y?-1:1;F=K*this.cos*B,M=K*this.sin*at,W.x(ot.x-F),W.y(ot.y+M)}ct=W.position(),this.findOne(".top-left").x(ct.x),this.findOne(".bottom-right").y(ct.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(W.y());else if(this._movingAnchorName==="bottom-right"){if(L){const ot=j?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};K=Math.sqrt(Math.pow(W.x()-ot.x,2)+Math.pow(W.y()-ot.y,2));const B=this.findOne(".bottom-right").x()<ot.x?-1:1,at=this.findOne(".bottom-right").y()<ot.y?-1:1;F=K*this.cos*B,M=K*this.sin*at,this.findOne(".bottom-right").x(ot.x+F),this.findOne(".bottom-right").y(ot.y+M)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(j=this.centeredScaling()||k.altKey,j){const ot=this.findOne(".top-left"),B=this.findOne(".bottom-right"),at=ot.x(),ht=ot.y(),At=this.getWidth()-B.x(),Dt=this.getHeight()-B.y();B.move({x:-at,y:-ht}),ot.move({x:At,y:Dt})}const $=this.findOne(".top-left").getAbsolutePosition();F=$.x,M=$.y;const vt=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),St=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:F,y:M,width:vt,height:St,rotation:c.Konva.getAngle(this.rotation())},k)}_handleMouseUp(k){this._removeEvents(k)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(k){var F;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const M=this.getNode();P--,this._fire("transformend",{evt:k,target:M}),(F=this.getLayer())===null||F===void 0||F.batchDraw(),M&&this._nodes.forEach(K=>{var W;K._fire("transformend",{evt:k,target:K}),(W=K.getLayer())===null||W===void 0||W.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(k,F){const M=this._getNodeRect(),K=1;if(t.Util._inRange(k.width,-this.padding()*2-K,K)){this.update();return}if(t.Util._inRange(k.height,-this.padding()*2-K,K)){this.update();return}const W=new t.Transform;if(W.rotate(c.Konva.getAngle(this.rotation())),this._movingAnchorName&&k.width<0&&this._movingAnchorName.indexOf("left")>=0){const L=W.point({x:-this.padding()*2,y:0});k.x+=L.x,k.y+=L.y,k.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=L.x,this._anchorDragOffset.y-=L.y}else if(this._movingAnchorName&&k.width<0&&this._movingAnchorName.indexOf("right")>=0){const L=W.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=L.x,this._anchorDragOffset.y-=L.y,k.width+=this.padding()*2}if(this._movingAnchorName&&k.height<0&&this._movingAnchorName.indexOf("top")>=0){const L=W.point({x:0,y:-this.padding()*2});k.x+=L.x,k.y+=L.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=L.x,this._anchorDragOffset.y-=L.y,k.height+=this.padding()*2}else if(this._movingAnchorName&&k.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const L=W.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=L.x,this._anchorDragOffset.y-=L.y,k.height+=this.padding()*2}if(this.boundBoxFunc()){const L=this.boundBoxFunc()(M,k);L?k=L:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const J=1e7,z=new t.Transform;z.translate(M.x,M.y),z.rotate(M.rotation),z.scale(M.width/J,M.height/J);const ft=new t.Transform,C=k.width/J,R=k.height/J;this.flipEnabled()===!1?(ft.translate(k.x,k.y),ft.rotate(k.rotation),ft.translate(k.width<0?k.width:0,k.height<0?k.height:0),ft.scale(Math.abs(C),Math.abs(R))):(ft.translate(k.x,k.y),ft.rotate(k.rotation),ft.scale(C,R));const G=ft.multiply(z.invert());this._nodes.forEach(L=>{var j;const ct=L.getParent().getAbsoluteTransform(),$=L.getTransform().copy();$.translate(L.offsetX(),L.offsetY());const vt=new t.Transform;vt.multiply(ct.copy().invert()).multiply(G).multiply(ct).multiply($);const St=vt.decompose();L.setAttrs(St),(j=L.getLayer())===null||j===void 0||j.batchDraw()}),this.rotation(t.Util._getRotation(k.rotation)),this._nodes.forEach(L=>{this._fire("transform",{evt:F,target:L}),L._fire("transform",{evt:F,target:L})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(k,F){this.findOne(k).setAttrs(F)}update(){var k;const F=this._getNodeRect();this.rotation(t.Util._getRotation(F.rotation));const M=F.width,K=F.height,W=this.enabledAnchors(),J=this.resizeEnabled(),z=this.padding(),ft=this.anchorSize(),C=this.find("._anchor");C.forEach(G=>{G.setAttrs({width:ft,height:ft,offsetX:ft/2,offsetY:ft/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:ft/2+z,offsetY:ft/2+z,visible:J&&W.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:M/2,y:0,offsetY:ft/2+z,visible:J&&W.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:M,y:0,offsetX:ft/2-z,offsetY:ft/2+z,visible:J&&W.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:K/2,offsetX:ft/2+z,visible:J&&W.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:M,y:K/2,offsetX:ft/2-z,visible:J&&W.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:K,offsetX:ft/2+z,offsetY:ft/2-z,visible:J&&W.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:M/2,y:K,offsetY:ft/2-z,visible:J&&W.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:M,y:K,offsetX:ft/2-z,offsetY:ft/2-z,visible:J&&W.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:M/2,y:-this.rotateAnchorOffset()*t.Util._sign(K)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:M,height:K,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const R=this.anchorStyleFunc();R&&C.forEach(G=>{R(G)}),(k=this.getLayer())===null||k===void 0||k.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const k=this.findOne("."+this._movingAnchorName);k&&k.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),o.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return i.Node.prototype.toObject.call(this)}clone(k){return i.Node.prototype.clone.call(this,k)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ir.Transformer=I,I.isTransforming=()=>P>0;function q(A){return A instanceof Array||t.Util.warn("enabledAnchors value should be an array"),A instanceof Array&&A.forEach(function(k){E.indexOf(k)===-1&&t.Util.warn("Unknown anchor name: "+k+". Available names are: "+E.join(", "))}),A||[]}return I.prototype.className="Transformer",(0,h._registerNode)(I),e.Factory.addGetterSetter(I,"enabledAnchors",E,q),e.Factory.addGetterSetter(I,"flipEnabled",!0,(0,l.getBooleanValidator)()),e.Factory.addGetterSetter(I,"resizeEnabled",!0),e.Factory.addGetterSetter(I,"anchorSize",10,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"rotateEnabled",!0),e.Factory.addGetterSetter(I,"rotateLineVisible",!0),e.Factory.addGetterSetter(I,"rotationSnaps",[]),e.Factory.addGetterSetter(I,"rotateAnchorOffset",50,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(I,"rotationSnapTolerance",5,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"borderEnabled",!0),e.Factory.addGetterSetter(I,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(I,"anchorStrokeWidth",1,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"anchorFill","white"),e.Factory.addGetterSetter(I,"anchorCornerRadius",0,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(I,"borderStrokeWidth",1,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"borderDash"),e.Factory.addGetterSetter(I,"keepRatio",!0),e.Factory.addGetterSetter(I,"shiftBehavior","default"),e.Factory.addGetterSetter(I,"centeredScaling",!1),e.Factory.addGetterSetter(I,"ignoreStroke",!1),e.Factory.addGetterSetter(I,"padding",0,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(I,"nodes"),e.Factory.addGetterSetter(I,"node"),e.Factory.addGetterSetter(I,"boundBoxFunc"),e.Factory.addGetterSetter(I,"anchorDragBoundFunc"),e.Factory.addGetterSetter(I,"anchorStyleFunc"),e.Factory.addGetterSetter(I,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(I,"useSingleNodeRotation",!0),e.Factory.backCompat(I,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Ir}var Nr={},Ul;function Od(){if(Ul)return Nr;Ul=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.Wedge=void 0;const t=Yt(),e=_e(),i=zt(),s=Xt(),a=zt();let o=class extends e.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.radius(),0,i.Konva.getAngle(this.angle()),this.clockwise()),l.lineTo(0,0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(l){this.radius(l/2)}setHeight(l){this.radius(l/2)}};return Nr.Wedge=o,o.prototype.className="Wedge",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["radius"],(0,a._registerNode)(o),t.Factory.addGetterSetter(o,"radius",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"angle",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"clockwise",!1),t.Factory.backCompat(o,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Nr}var Dr={},Kl;function Md(){if(Kl)return Dr;Kl=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.Blur=void 0;const t=Yt(),e=de(),i=Xt();function s(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const a=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function c(h,g){const d=h.data,b=h.width,_=h.height;let p,v,S,E,O,y,f,w,P,I,q,A,k,F,M,K,W,J,z,ft;const C=g+g+1,R=b-1,G=_-1,L=g+1,j=L*(L+1)/2,ct=new s,$=a[g],vt=o[g];let St=null,ot=ct,B=null,at=null;for(let ht=1;ht<C;ht++)ot=ot.next=new s,ht===L&&(St=ot);ot.next=ct,S=v=0;for(let ht=0;ht<_;ht++){A=k=F=M=E=O=y=f=0,w=L*(K=d[v]),P=L*(W=d[v+1]),I=L*(J=d[v+2]),q=L*(z=d[v+3]),E+=j*K,O+=j*W,y+=j*J,f+=j*z,ot=ct;for(let At=0;At<L;At++)ot.r=K,ot.g=W,ot.b=J,ot.a=z,ot=ot.next;for(let At=1;At<L;At++)p=v+((R<At?R:At)<<2),E+=(ot.r=K=d[p])*(ft=L-At),O+=(ot.g=W=d[p+1])*ft,y+=(ot.b=J=d[p+2])*ft,f+=(ot.a=z=d[p+3])*ft,A+=K,k+=W,F+=J,M+=z,ot=ot.next;B=ct,at=St;for(let At=0;At<b;At++)d[v+3]=z=f*$>>vt,z!==0?(z=255/z,d[v]=(E*$>>vt)*z,d[v+1]=(O*$>>vt)*z,d[v+2]=(y*$>>vt)*z):d[v]=d[v+1]=d[v+2]=0,E-=w,O-=P,y-=I,f-=q,w-=B.r,P-=B.g,I-=B.b,q-=B.a,p=S+((p=At+g+1)<R?p:R)<<2,A+=B.r=d[p],k+=B.g=d[p+1],F+=B.b=d[p+2],M+=B.a=d[p+3],E+=A,O+=k,y+=F,f+=M,B=B.next,w+=K=at.r,P+=W=at.g,I+=J=at.b,q+=z=at.a,A-=K,k-=W,F-=J,M-=z,at=at.next,v+=4;S+=b}for(let ht=0;ht<b;ht++){k=F=M=A=O=y=f=E=0,v=ht<<2,w=L*(K=d[v]),P=L*(W=d[v+1]),I=L*(J=d[v+2]),q=L*(z=d[v+3]),E+=j*K,O+=j*W,y+=j*J,f+=j*z,ot=ct;for(let Dt=0;Dt<L;Dt++)ot.r=K,ot.g=W,ot.b=J,ot.a=z,ot=ot.next;let At=b;for(let Dt=1;Dt<=g;Dt++)v=At+ht<<2,E+=(ot.r=K=d[v])*(ft=L-Dt),O+=(ot.g=W=d[v+1])*ft,y+=(ot.b=J=d[v+2])*ft,f+=(ot.a=z=d[v+3])*ft,A+=K,k+=W,F+=J,M+=z,ot=ot.next,Dt<G&&(At+=b);v=ht,B=ct,at=St;for(let Dt=0;Dt<_;Dt++)p=v<<2,d[p+3]=z=f*$>>vt,z>0?(z=255/z,d[p]=(E*$>>vt)*z,d[p+1]=(O*$>>vt)*z,d[p+2]=(y*$>>vt)*z):d[p]=d[p+1]=d[p+2]=0,E-=w,O-=P,y-=I,f-=q,w-=B.r,P-=B.g,I-=B.b,q-=B.a,p=ht+((p=Dt+L)<G?p:G)*b<<2,E+=A+=B.r=d[p],O+=k+=B.g=d[p+1],y+=F+=B.b=d[p+2],f+=M+=B.a=d[p+3],B=B.next,w+=K=at.r,P+=W=at.g,I+=J=at.b,q+=z=at.a,A-=K,k-=W,F-=J,M-=z,at=at.next,v+=b}}const l=function(g){const d=Math.round(this.blurRadius());d>0&&c(g,d)};return Dr.Blur=l,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Dr}var Lr={},jl;function Fd(){if(jl)return Lr;jl=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.Brighten=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=this.brightness()*255,c=a.data,l=c.length;for(let h=0;h<l;h+=4)c[h]+=o,c[h+1]+=o,c[h+2]+=o};return Lr.Brighten=s,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Lr}var Gr={},Vl;function Id(){if(Vl)return Gr;Vl=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.Contrast=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=Math.pow((this.contrast()+100)/100,2),c=a.data,l=c.length;let h=150,g=150,d=150;for(let b=0;b<l;b+=4)h=c[b],g=c[b+1],d=c[b+2],h/=255,h-=.5,h*=o,h+=.5,h*=255,g/=255,g-=.5,g*=o,g+=.5,g*=255,d/=255,d-=.5,d*=o,d+=.5,d*=255,h=h<0?0:h>255?255:h,g=g<0?0:g>255?255:g,d=d<0?0:d>255?255:d,c[b]=h,c[b+1]=g,c[b+2]=d};return Gr.Contrast=s,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Gr}var Br={},ql;function Nd(){if(ql)return Br;ql=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.Emboss=void 0;const t=Yt(),e=de(),i=ce(),s=Xt(),a=function(o){const c=this.embossStrength()*10,l=this.embossWhiteLevel()*255,h=this.embossDirection(),g=this.embossBlend(),d=o.data,b=o.width,_=o.height,p=b*4;let v=0,S=0,E=_;switch(h){case"top-left":v=-1,S=-1;break;case"top":v=-1,S=0;break;case"top-right":v=-1,S=1;break;case"right":v=0,S=1;break;case"bottom-right":v=1,S=1;break;case"bottom":v=1,S=0;break;case"bottom-left":v=1,S=-1;break;case"left":v=0,S=-1;break;default:i.Util.error("Unknown emboss direction: "+h)}do{const O=(E-1)*p;let y=v;E+y<1&&(y=0),E+y>_&&(y=0);const f=(E-1+y)*b*4;let w=b;do{const P=O+(w-1)*4;let I=S;w+I<1&&(I=0),w+I>b&&(I=0);const q=f+(w-1+I)*4,A=d[P]-d[q],k=d[P+1]-d[q+1],F=d[P+2]-d[q+2];let M=A;const K=M>0?M:-M,W=k>0?k:-k,J=F>0?F:-F;if(W>K&&(M=k),J>K&&(M=F),M*=c,g){const z=d[P]+M,ft=d[P+1]+M,C=d[P+2]+M;d[P]=z>255?255:z<0?0:z,d[P+1]=ft>255?255:ft<0?0:ft,d[P+2]=C>255?255:C<0?0:C}else{let z=l-M;z<0?z=0:z>255&&(z=255),d[P]=d[P+1]=d[P+2]=z}}while(--w)}while(--E)};return Br.Emboss=a,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,s.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,s.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),Br}var Ur={},Hl;function Dd(){if(Hl)return Ur;Hl=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Enhance=void 0;const t=Yt(),e=de(),i=Xt();function s(o,c,l,h,g){const d=l-c,b=g-h;if(d===0)return h+b/2;if(b===0)return h;let _=(o-c)/d;return _=b*_+h,_}const a=function(o){const c=o.data,l=c.length;let h=c[0],g=h,d,b=c[1],_=b,p,v=c[2],S=v,E;const O=this.enhance();if(O===0)return;for(let A=0;A<l;A+=4)d=c[A+0],d<h?h=d:d>g&&(g=d),p=c[A+1],p<b?b=p:p>_&&(_=p),E=c[A+2],E<v?v=E:E>S&&(S=E);g===h&&(g=255,h=0),_===b&&(_=255,b=0),S===v&&(S=255,v=0);let y,f,w,P,I,q;if(O>0)y=g+O*(255-g),f=h-O*(h-0),w=_+O*(255-_),P=b-O*(b-0),I=S+O*(255-S),q=v-O*(v-0);else{const A=(g+h)*.5;y=g+O*(g-A),f=h+O*(h-A);const k=(_+b)*.5;w=_+O*(_-k),P=b+O*(b-k);const F=(S+v)*.5;I=S+O*(S-F),q=v+O*(v-F)}for(let A=0;A<l;A+=4)c[A+0]=s(c[A+0],h,g,f,y),c[A+1]=s(c[A+1],b,_,P,w),c[A+2]=s(c[A+2],v,S,q,I)};return Ur.Enhance=a,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Ur}var Kr={},Wl;function Ld(){if(Wl)return Kr;Wl=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.Grayscale=void 0;const t=function(e){const i=e.data,s=i.length;for(let a=0;a<s;a+=4){const o=.34*i[a]+.5*i[a+1]+.16*i[a+2];i[a]=o,i[a+1]=o,i[a+2]=o}};return Kr.Grayscale=t,Kr}var jr={},zl;function Gd(){if(zl)return jr;zl=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.HSL=void 0;const t=Yt(),e=de(),i=Xt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter);const s=function(a){const o=a.data,c=o.length,l=1,h=Math.pow(2,this.saturation()),g=Math.abs(this.hue()+360)%360,d=this.luminance()*127,b=l*h*Math.cos(g*Math.PI/180),_=l*h*Math.sin(g*Math.PI/180),p=.299*l+.701*b+.167*_,v=.587*l-.587*b+.33*_,S=.114*l-.114*b-.497*_,E=.299*l-.299*b-.328*_,O=.587*l+.413*b+.035*_,y=.114*l-.114*b+.293*_,f=.299*l-.3*b+1.25*_,w=.587*l-.586*b-1.05*_,P=.114*l+.886*b-.2*_;let I,q,A,k;for(let F=0;F<c;F+=4)I=o[F+0],q=o[F+1],A=o[F+2],k=o[F+3],o[F+0]=p*I+v*q+S*A+d,o[F+1]=E*I+O*q+y*A+d,o[F+2]=f*I+w*q+P*A+d,o[F+3]=k};return jr.HSL=s,jr}var Vr={},Yl;function Bd(){if(Yl)return Vr;Yl=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.HSV=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=a.data,c=o.length,l=Math.pow(2,this.value()),h=Math.pow(2,this.saturation()),g=Math.abs(this.hue()+360)%360,d=l*h*Math.cos(g*Math.PI/180),b=l*h*Math.sin(g*Math.PI/180),_=.299*l+.701*d+.167*b,p=.587*l-.587*d+.33*b,v=.114*l-.114*d-.497*b,S=.299*l-.299*d-.328*b,E=.587*l+.413*d+.035*b,O=.114*l-.114*d+.293*b,y=.299*l-.3*d+1.25*b,f=.587*l-.586*d-1.05*b,w=.114*l+.886*d-.2*b;for(let P=0;P<c;P+=4){const I=o[P+0],q=o[P+1],A=o[P+2],k=o[P+3];o[P+0]=_*I+p*q+v*A,o[P+1]=S*I+E*q+O*A,o[P+2]=y*I+f*q+w*A,o[P+3]=k}};return Vr.HSV=s,t.Factory.addGetterSetter(e.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Vr}var qr={},Xl;function Ud(){if(Xl)return qr;Xl=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Invert=void 0;const t=function(e){const i=e.data,s=i.length;for(let a=0;a<s;a+=4)i[a]=255-i[a],i[a+1]=255-i[a+1],i[a+2]=255-i[a+2]};return qr.Invert=t,qr}var Hr={},Ql;function Kd(){if(Ql)return Hr;Ql=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.Kaleidoscope=void 0;const t=Yt(),e=de(),i=ce(),s=Xt(),a=function(l,h,g){const d=l.data,b=h.data,_=l.width,p=l.height,v=g.polarCenterX||_/2,S=g.polarCenterY||p/2;let E=Math.sqrt(v*v+S*S),O=_-v,y=p-S;const f=Math.sqrt(O*O+y*y);E=f>E?f:E;const w=p,P=_,I=360/P*Math.PI/180;for(let q=0;q<P;q+=1){const A=Math.sin(q*I),k=Math.cos(q*I);for(let F=0;F<w;F+=1){O=Math.floor(v+E*F/w*k),y=Math.floor(S+E*F/w*A);let M=(y*_+O)*4;const K=d[M+0],W=d[M+1],J=d[M+2],z=d[M+3];M=(q+F*_)*4,b[M+0]=K,b[M+1]=W,b[M+2]=J,b[M+3]=z}}},o=function(l,h,g){const d=l.data,b=h.data,_=l.width,p=l.height,v=g.polarCenterX||_/2,S=g.polarCenterY||p/2;let E=Math.sqrt(v*v+S*S),O=_-v,y=p-S;const f=Math.sqrt(O*O+y*y);E=f>E?f:E;const w=p,P=_,I=0;let q,A;for(O=0;O<_;O+=1)for(y=0;y<p;y+=1){const k=O-v,F=y-S,M=Math.sqrt(k*k+F*F)*w/E;let K=(Math.atan2(F,k)*180/Math.PI+360+I)%360;K=K*P/360,q=Math.floor(K),A=Math.floor(M);let W=(A*_+q)*4;const J=d[W+0],z=d[W+1],ft=d[W+2],C=d[W+3];W=(y*_+O)*4,b[W+0]=J,b[W+1]=z,b[W+2]=ft,b[W+3]=C}},c=function(l){const h=l.width,g=l.height;let d,b,_,p,v,S,E,O,y,f,w=Math.round(this.kaleidoscopePower());const P=Math.round(this.kaleidoscopeAngle()),I=Math.floor(h*(P%360)/360);if(w<1)return;const q=i.Util.createCanvasElement();q.width=h,q.height=g;const A=q.getContext("2d").getImageData(0,0,h,g);i.Util.releaseCanvas(q),a(l,A,{polarCenterX:h/2,polarCenterY:g/2});let k=h/Math.pow(2,w);for(;k<=8;)k=k*2,w-=1;k=Math.ceil(k);let F=k,M=0,K=F,W=1;for(I+k>h&&(M=F,K=0,W=-1),b=0;b<g;b+=1)for(d=M;d!==K;d+=W)_=Math.round(d+I)%h,y=(h*b+_)*4,v=A.data[y+0],S=A.data[y+1],E=A.data[y+2],O=A.data[y+3],f=(h*b+d)*4,A.data[f+0]=v,A.data[f+1]=S,A.data[f+2]=E,A.data[f+3]=O;for(b=0;b<g;b+=1)for(F=Math.floor(k),p=0;p<w;p+=1){for(d=0;d<F+1;d+=1)y=(h*b+d)*4,v=A.data[y+0],S=A.data[y+1],E=A.data[y+2],O=A.data[y+3],f=(h*b+F*2-d-1)*4,A.data[f+0]=v,A.data[f+1]=S,A.data[f+2]=E,A.data[f+3]=O;F*=2}o(A,l,{})};return Hr.Kaleidoscope=c,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,s.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,s.getNumberValidator)(),t.Factory.afterSetFilter),Hr}var Wr={},Jl;function jd(){if(Jl)return Wr;Jl=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.Mask=void 0;const t=Yt(),e=de(),i=Xt();function s(_,p,v){let S=(v*_.width+p)*4;const E=[];return E.push(_.data[S++],_.data[S++],_.data[S++],_.data[S++]),E}function a(_,p){return Math.sqrt(Math.pow(_[0]-p[0],2)+Math.pow(_[1]-p[1],2)+Math.pow(_[2]-p[2],2))}function o(_){const p=[0,0,0];for(let v=0;v<_.length;v++)p[0]+=_[v][0],p[1]+=_[v][1],p[2]+=_[v][2];return p[0]/=_.length,p[1]/=_.length,p[2]/=_.length,p}function c(_,p){const v=s(_,0,0),S=s(_,_.width-1,0),E=s(_,0,_.height-1),O=s(_,_.width-1,_.height-1),y=p||10;if(a(v,S)<y&&a(S,O)<y&&a(O,E)<y&&a(E,v)<y){const f=o([S,v,O,E]),w=[];for(let P=0;P<_.width*_.height;P++){const I=a(f,[_.data[P*4],_.data[P*4+1],_.data[P*4+2]]);w[P]=I<y?0:255}return w}}function l(_,p){for(let v=0;v<_.width*_.height;v++)_.data[4*v+3]=p[v]}function h(_,p,v){const S=[1,1,1,1,0,1,1,1,1],E=Math.round(Math.sqrt(S.length)),O=Math.floor(E/2),y=[];for(let f=0;f<v;f++)for(let w=0;w<p;w++){const P=f*p+w;let I=0;for(let q=0;q<E;q++)for(let A=0;A<E;A++){const k=f+q-O,F=w+A-O;if(k>=0&&k<v&&F>=0&&F<p){const M=k*p+F,K=S[q*E+A];I+=_[M]*K}}y[P]=I===2040?255:0}return y}function g(_,p,v){const S=[1,1,1,1,1,1,1,1,1],E=Math.round(Math.sqrt(S.length)),O=Math.floor(E/2),y=[];for(let f=0;f<v;f++)for(let w=0;w<p;w++){const P=f*p+w;let I=0;for(let q=0;q<E;q++)for(let A=0;A<E;A++){const k=f+q-O,F=w+A-O;if(k>=0&&k<v&&F>=0&&F<p){const M=k*p+F,K=S[q*E+A];I+=_[M]*K}}y[P]=I>=1020?255:0}return y}function d(_,p,v){const S=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],E=Math.round(Math.sqrt(S.length)),O=Math.floor(E/2),y=[];for(let f=0;f<v;f++)for(let w=0;w<p;w++){const P=f*p+w;let I=0;for(let q=0;q<E;q++)for(let A=0;A<E;A++){const k=f+q-O,F=w+A-O;if(k>=0&&k<v&&F>=0&&F<p){const M=k*p+F,K=S[q*E+A];I+=_[M]*K}}y[P]=I}return y}const b=function(_){const p=this.threshold();let v=c(_,p);return v&&(v=h(v,_.width,_.height),v=g(v,_.width,_.height),v=d(v,_.width,_.height),l(_,v)),_};return Wr.Mask=b,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Wr}var zr={},$l;function Vd(){if($l)return zr;$l=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.Noise=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=this.noise()*255,c=a.data,l=c.length,h=o/2;for(let g=0;g<l;g+=4)c[g+0]+=h-2*h*Math.random(),c[g+1]+=h-2*h*Math.random(),c[g+2]+=h-2*h*Math.random()};return zr.Noise=s,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),zr}var Yr={},Zl;function qd(){if(Zl)return Yr;Zl=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.Pixelate=void 0;const t=Yt(),e=ce(),i=de(),s=Xt(),a=function(o){let c=Math.ceil(this.pixelSize()),l=o.width,h=o.height,g=Math.ceil(l/c),d=Math.ceil(h/c),b=o.data;if(c<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let _=0;_<g;_+=1)for(let p=0;p<d;p+=1){let v=0,S=0,E=0,O=0;const y=_*c,f=y+c,w=p*c,P=w+c;let I=0;for(let q=y;q<f;q+=1)if(!(q>=l))for(let A=w;A<P;A+=1){if(A>=h)continue;const k=(l*A+q)*4;v+=b[k+0],S+=b[k+1],E+=b[k+2],O+=b[k+3],I+=1}v=v/I,S=S/I,E=E/I,O=O/I;for(let q=y;q<f;q+=1)if(!(q>=l))for(let A=w;A<P;A+=1){if(A>=h)continue;const k=(l*A+q)*4;b[k+0]=v,b[k+1]=S,b[k+2]=E,b[k+3]=O}}};return Yr.Pixelate=a,t.Factory.addGetterSetter(i.Node,"pixelSize",8,(0,s.getNumberValidator)(),t.Factory.afterSetFilter),Yr}var Xr={},tc;function Hd(){if(tc)return Xr;tc=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.Posterize=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=Math.round(this.levels()*254)+1,c=a.data,l=c.length,h=255/o;for(let g=0;g<l;g+=1)c[g]=Math.floor(c[g]/h)*h};return Xr.Posterize=s,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Xr}var Qr={},ec;function Wd(){if(ec)return Qr;ec=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.RGB=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=a.data,c=o.length,l=this.red(),h=this.green(),g=this.blue();for(let d=0;d<c;d+=4){const b=(.34*o[d]+.5*o[d+1]+.16*o[d+2])/255;o[d]=b*l,o[d+1]=b*h,o[d+2]=b*g,o[d+3]=o[d+3]}};return Qr.RGB=s,t.Factory.addGetterSetter(e.Node,"red",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),t.Factory.addGetterSetter(e.Node,"green",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),t.Factory.addGetterSetter(e.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),Qr}var Jr={},nc;function zd(){if(nc)return Jr;nc=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.RGBA=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=a.data,c=o.length,l=this.red(),h=this.green(),g=this.blue(),d=this.alpha();for(let b=0;b<c;b+=4){const _=1-d;o[b]=l*d+o[b]*_,o[b+1]=h*d+o[b+1]*_,o[b+2]=g*d+o[b+2]*_}};return Jr.RGBA=s,t.Factory.addGetterSetter(e.Node,"red",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),t.Factory.addGetterSetter(e.Node,"green",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),t.Factory.addGetterSetter(e.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(a){return this._filterUpToDate=!1,a>1?1:a<0?0:a}),Jr}var $r={},rc;function Yd(){if(rc)return $r;rc=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.Sepia=void 0;const t=function(e){const i=e.data,s=i.length;for(let a=0;a<s;a+=4){const o=i[a+0],c=i[a+1],l=i[a+2];i[a+0]=Math.min(255,o*.393+c*.769+l*.189),i[a+1]=Math.min(255,o*.349+c*.686+l*.168),i[a+2]=Math.min(255,o*.272+c*.534+l*.131)}};return $r.Sepia=t,$r}var Zr={},ic;function Xd(){if(ic)return Zr;ic=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.Solarize=void 0;const t=function(e){const i=e.data,s=e.width,a=e.height,o=s*4;let c=a;do{const l=(c-1)*o;let h=s;do{const g=l+(h-1)*4;let d=i[g],b=i[g+1],_=i[g+2];d>127&&(d=255-d),b>127&&(b=255-b),_>127&&(_=255-_),i[g]=d,i[g+1]=b,i[g+2]=_}while(--h)}while(--c)};return Zr.Solarize=t,Zr}var ti={},sc;function Qd(){if(sc)return ti;sc=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Threshold=void 0;const t=Yt(),e=de(),i=Xt(),s=function(a){const o=this.threshold()*255,c=a.data,l=c.length;for(let h=0;h<l;h+=1)c[h]=c[h]<o?0:255};return ti.Threshold=s,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ti}var oc;function Jd(){if(oc)return gr;oc=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.Konva=void 0;const t=yd(),e=vd(),i=bd(),s=wd(),a=Sd(),o=xd(),c=Cd(),l=hu(),h=Jo(),g=fu(),d=Pd(),b=Td(),_=Ed(),p=Ad(),v=du(),S=Rd(),E=kd(),O=Od(),y=Md(),f=Fd(),w=Id(),P=Nd(),I=Dd(),q=Ld(),A=Gd(),k=Bd(),F=Ud(),M=Kd(),K=jd(),W=Vd(),J=qd(),z=Hd(),ft=Wd(),C=zd(),R=Yd(),G=Xd(),L=Qd();return gr.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:i.Arrow,Circle:s.Circle,Ellipse:a.Ellipse,Image:o.Image,Label:c.Label,Tag:c.Tag,Line:l.Line,Path:h.Path,Rect:g.Rect,RegularPolygon:d.RegularPolygon,Ring:b.Ring,Sprite:_.Sprite,Star:p.Star,Text:v.Text,TextPath:S.TextPath,Transformer:E.Transformer,Wedge:O.Wedge,Filters:{Blur:y.Blur,Brighten:f.Brighten,Contrast:w.Contrast,Emboss:P.Emboss,Enhance:I.Enhance,Grayscale:q.Grayscale,HSL:A.HSL,HSV:k.HSV,Invert:F.Invert,Kaleidoscope:M.Kaleidoscope,Mask:K.Mask,Noise:W.Noise,Pixelate:J.Pixelate,Posterize:z.Posterize,RGB:ft.RGB,RGBA:C.RGBA,Sepia:R.Sepia,Solarize:G.Solarize,Threshold:L.Threshold}}),gr}var $d=zi.exports,ac;function Zd(){if(ac)return zi.exports;ac=1,Object.defineProperty($d,"__esModule",{value:!0});const t=Jd();return zi.exports=t.Konva,zi.exports}var t0=Zd();const ge=au(t0);var Yi={exports:{}},e0=Yi.exports,lc;function n0(){return lc||(lc=1,(function(t,e){(function(i,s){t.exports=s()})(e0,function(){var i=function(n,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,m){u.__proto__=m}||function(u,m){for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(u[x]=m[x])})(n,r)},s=function(){return(s=Object.assign||function(n){for(var r,u=1,m=arguments.length;u<m;u++)for(var x in r=arguments[u])Object.prototype.hasOwnProperty.call(r,x)&&(n[x]=r[x]);return n}).apply(this,arguments)};function a(n,r,u){for(var m,x=0,T=r.length;x<T;x++)!m&&x in r||((m=m||Array.prototype.slice.call(r,0,x))[x]=r[x]);return n.concat(m||Array.prototype.slice.call(r))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:wo,c=Object.keys,l=Array.isArray;function h(n,r){return typeof r!="object"||c(r).forEach(function(u){n[u]=r[u]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var g=Object.getPrototypeOf,d={}.hasOwnProperty;function b(n,r){return d.call(n,r)}function _(n,r){typeof r=="function"&&(r=r(g(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(r).forEach(function(u){v(n,u,r[u])})}var p=Object.defineProperty;function v(n,r,u,m){p(n,r,h(u&&b(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},m))}function S(n){return{from:function(r){return n.prototype=Object.create(r.prototype),v(n.prototype,"constructor",n),{extend:_.bind(null,n.prototype)}}}}var E=Object.getOwnPropertyDescriptor,O=[].slice;function y(n,r,u){return O.call(n,r,u)}function f(n,r){return r(n)}function w(n){if(!n)throw new Error("Assertion Failed")}function P(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function I(n,r){if(typeof r=="string"&&b(n,r))return n[r];if(!r)return n;if(typeof r!="string"){for(var u=[],m=0,x=r.length;m<x;++m){var T=I(n,r[m]);u.push(T)}return u}var D=r.indexOf(".");if(D!==-1){var U=n[r.substr(0,D)];return U==null?void 0:I(U,r.substr(D+1))}}function q(n,r,u){if(n&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof r!="string"&&"length"in r){w(typeof u!="string"&&"length"in u);for(var m=0,x=r.length;m<x;++m)q(n,r[m],u[m])}else{var T,D,U=r.indexOf(".");U!==-1?(T=r.substr(0,U),(D=r.substr(U+1))===""?u===void 0?l(n)&&!isNaN(parseInt(T))?n.splice(T,1):delete n[T]:n[T]=u:q(U=!(U=n[T])||!b(n,T)?n[T]={}:U,D,u)):u===void 0?l(n)&&!isNaN(parseInt(r))?n.splice(r,1):delete n[r]:n[r]=u}}function A(n){var r,u={};for(r in n)b(n,r)&&(u[r]=n[r]);return u}var k=[].concat;function F(n){return k.apply([],n)}var Gt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(F([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(r){return r+n+"Array"})}))).filter(function(n){return o[n]}),M=new Set(Gt.map(function(n){return o[n]})),K=null;function W(n){return K=new WeakMap,n=(function r(u){if(!u||typeof u!="object")return u;var m=K.get(u);if(m)return m;if(l(u)){m=[],K.set(u,m);for(var x=0,T=u.length;x<T;++x)m.push(r(u[x]))}else if(M.has(u.constructor))m=u;else{var D,U=g(u);for(D in m=U===Object.prototype?{}:Object.create(U),K.set(u,m),u)b(u,D)&&(m[D]=r(u[D]))}return m})(n),K=null,n}var J={}.toString;function z(n){return J.call(n).slice(8,-1)}var ft=typeof Symbol<"u"?Symbol.iterator:"@@iterator",C=typeof ft=="symbol"?function(n){var r;return n!=null&&(r=n[ft])&&r.apply(n)}:function(){return null};function R(n,r){return r=n.indexOf(r),0<=r&&n.splice(r,1),0<=r}var G={};function L(n){var r,u,m,x;if(arguments.length===1){if(l(n))return n.slice();if(this===G&&typeof n=="string")return[n];if(x=C(n)){for(u=[];!(m=x.next()).done;)u.push(m.value);return u}if(n==null)return[n];if(typeof(r=n.length)!="number")return[n];for(u=new Array(r);r--;)u[r]=n[r];return u}for(r=arguments.length,u=new Array(r);r--;)u[r]=arguments[r];return u}var j=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Lt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ge=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Lt),ct={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function $(n,r){this.name=n,this.message=r}function vt(n,r){return n+". Errors: "+Object.keys(r).map(function(u){return r[u].toString()}).filter(function(u,m,x){return x.indexOf(u)===m}).join(`
`)}function St(n,r,u,m){this.failures=r,this.failedKeys=m,this.successCount=u,this.message=vt(n,r)}function ot(n,r){this.name="BulkError",this.failures=Object.keys(r).map(function(u){return r[u]}),this.failuresByPos=r,this.message=vt(n,this.failures)}S($).from(Error).extend({toString:function(){return this.name+": "+this.message}}),S(St).from($),S(ot).from($);var B=Ge.reduce(function(n,r){return n[r]=r+"Error",n},{}),at=$,ht=Ge.reduce(function(n,r){var u=r+"Error";function m(x,T){this.name=u,x?typeof x=="string"?(this.message="".concat(x).concat(T?`
 `+T:""),this.inner=T||null):typeof x=="object"&&(this.message="".concat(x.name," ").concat(x.message),this.inner=x):(this.message=ct[r]||u,this.inner=null)}return S(m).from(at),n[r]=m,n},{});ht.Syntax=SyntaxError,ht.Type=TypeError,ht.Range=RangeError;var At=Lt.reduce(function(n,r){return n[r+"Error"]=ht[r],n},{}),Dt=Ge.reduce(function(n,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(n[r+"Error"]=ht[r]),n},{});function N(){}function V(n){return n}function st(n,r){return n==null||n===V?r:function(u){return r(n(u))}}function ut(n,r){return function(){n.apply(this,arguments),r.apply(this,arguments)}}function pt(n,r){return n===N?r:function(){var u=n.apply(this,arguments);u!==void 0&&(arguments[0]=u);var m=this.onsuccess,x=this.onerror;this.onsuccess=null,this.onerror=null;var T=r.apply(this,arguments);return m&&(this.onsuccess=this.onsuccess?ut(m,this.onsuccess):m),x&&(this.onerror=this.onerror?ut(x,this.onerror):x),T!==void 0?T:u}}function dt(n,r){return n===N?r:function(){n.apply(this,arguments);var u=this.onsuccess,m=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?ut(u,this.onsuccess):u),m&&(this.onerror=this.onerror?ut(m,this.onerror):m)}}function bt(n,r){return n===N?r:function(u){var m=n.apply(this,arguments);h(u,m);var x=this.onsuccess,T=this.onerror;return this.onsuccess=null,this.onerror=null,u=r.apply(this,arguments),x&&(this.onsuccess=this.onsuccess?ut(x,this.onsuccess):x),T&&(this.onerror=this.onerror?ut(T,this.onerror):T),m===void 0?u===void 0?void 0:u:h(m,u)}}function xt(n,r){return n===N?r:function(){return r.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function _t(n,r){return n===N?r:function(){var u=n.apply(this,arguments);if(u&&typeof u.then=="function"){for(var m=this,x=arguments.length,T=new Array(x);x--;)T[x]=arguments[x];return u.then(function(){return r.apply(m,T)})}return r.apply(this,arguments)}}Dt.ModifyError=St,Dt.DexieError=$,Dt.BulkError=ot;var mt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function kt(n){mt=n}var Ct={},Nt=100,Gt=typeof Promise>"u"?[]:(function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,g(n),n];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,g(r),n]})(),Lt=Gt[0],Ge=Gt[1],Gt=Gt[2],Ge=Ge&&Ge.then,Ut=Lt&&Lt.constructor,Bt=!!Gt,Zt=function(n,r){un.push([n,r]),te&&(queueMicrotask(pu),te=!1)},Jt=!0,te=!0,oe=[],Ie=[],Be=V,ae={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:N,pgp:!1,env:{},finalize:N},Ft=ae,un=[],je=0,yi=[];function Mt(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=Ft;if(typeof n!="function"){if(n!==Ct)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ds(this,this._value))}this._state=null,this._value=null,++r.ref,(function u(m,x){try{x(function(T){if(m._state===null){if(T===m)throw new TypeError("A promise cannot be resolved with itself.");var D=m._lib&&Bn();T&&typeof T.then=="function"?u(m,function(U,Y){T instanceof Mt?T._then(U,Y):T.then(U,Y)}):(m._state=!0,m._value=T,Zo(m)),D&&Un()}},ds.bind(null,m))}catch(T){ds(m,T)}})(this,n)}var fs={get:function(){var n=Ft,r=wi;function u(m,x){var T=this,D=!n.global&&(n!==Ft||r!==wi),U=D&&!fn(),Y=new Mt(function(X,et){gs(T,new $o(ea(m,n,D,U),ea(x,n,D,U),X,et,n))});return this._consoleTask&&(Y._consoleTask=this._consoleTask),Y}return u.prototype=Ct,u},set:function(n){v(this,"then",n&&n.prototype===Ct?fs:{get:function(){return n},set:fs.set})}};function $o(n,r,u,m,x){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof r=="function"?r:null,this.resolve=u,this.reject=m,this.psd=x}function ds(n,r){var u,m;Ie.push(r),n._state===null&&(u=n._lib&&Bn(),r=Be(r),n._state=!1,n._value=r,m=n,oe.some(function(x){return x._value===m._value})||oe.push(m),Zo(n),u&&Un())}function Zo(n){var r=n._listeners;n._listeners=[];for(var u=0,m=r.length;u<m;++u)gs(n,r[u]);var x=n._PSD;--x.ref||x.finalize(),je===0&&(++je,Zt(function(){--je==0&&ps()},[]))}function gs(n,r){if(n._state!==null){var u=n._state?r.onFulfilled:r.onRejected;if(u===null)return(n._state?r.resolve:r.reject)(n._value);++r.psd.ref,++je,Zt(gu,[u,n,r])}else n._listeners.push(r)}function gu(n,r,u){try{var m,x=r._value;!r._state&&Ie.length&&(Ie=[]),m=mt&&r._consoleTask?r._consoleTask.run(function(){return n(x)}):n(x),r._state||Ie.indexOf(x)!==-1||(function(T){for(var D=oe.length;D;)if(oe[--D]._value===T._value)return oe.splice(D,1)})(r),u.resolve(m)}catch(T){u.reject(T)}finally{--je==0&&ps(),--u.psd.ref||u.psd.finalize()}}function pu(){En(ae,function(){Bn()&&Un()})}function Bn(){var n=Jt;return te=Jt=!1,n}function Un(){var n,r,u;do for(;0<un.length;)for(n=un,un=[],u=n.length,r=0;r<u;++r){var m=n[r];m[0].apply(null,m[1])}while(0<un.length);te=Jt=!0}function ps(){var n=oe;oe=[],n.forEach(function(m){m._PSD.onunhandled.call(null,m._value,m)});for(var r=yi.slice(0),u=r.length;u;)r[--u]()}function vi(n){return new Mt(Ct,!1,n)}function le(n,r){var u=Ft;return function(){var m=Bn(),x=Ft;try{return dn(u,!0),n.apply(this,arguments)}catch(T){r&&r(T)}finally{dn(x,!1),m&&Un()}}}_(Mt.prototype,{then:fs,_then:function(n,r){gs(this,new $o(null,null,n,r,Ft))},catch:function(n){if(arguments.length===1)return this.then(null,n);var r=n,u=arguments[1];return typeof r=="function"?this.then(null,function(m){return(m instanceof r?u:vi)(m)}):this.then(null,function(m){return(m&&m.name===r?u:vi)(m)})},finally:function(n){return this.then(function(r){return Mt.resolve(n()).then(function(){return r})},function(r){return Mt.resolve(n()).then(function(){return vi(r)})})},timeout:function(n,r){var u=this;return n<1/0?new Mt(function(m,x){var T=setTimeout(function(){return x(new ht.Timeout(r))},n);u.then(m,x).finally(clearTimeout.bind(null,T))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&v(Mt.prototype,Symbol.toStringTag,"Dexie.Promise"),ae.env=ta(),_(Mt,{all:function(){var n=L.apply(null,arguments).map(Si);return new Mt(function(r,u){n.length===0&&r([]);var m=n.length;n.forEach(function(x,T){return Mt.resolve(x).then(function(D){n[T]=D,--m||r(n)},u)})})},resolve:function(n){return n instanceof Mt?n:n&&typeof n.then=="function"?new Mt(function(r,u){n.then(r,u)}):new Mt(Ct,!0,n)},reject:vi,race:function(){var n=L.apply(null,arguments).map(Si);return new Mt(function(r,u){n.map(function(m){return Mt.resolve(m).then(r,u)})})},PSD:{get:function(){return Ft},set:function(n){return Ft=n}},totalEchoes:{get:function(){return wi}},newPSD:hn,usePSD:En,scheduler:{get:function(){return Zt},set:function(n){Zt=n}},rejectionMapper:{get:function(){return Be},set:function(n){Be=n}},follow:function(n,r){return new Mt(function(u,m){return hn(function(x,T){var D=Ft;D.unhandleds=[],D.onunhandled=T,D.finalize=ut(function(){var U,Y=this;U=function(){Y.unhandleds.length===0?x():T(Y.unhandleds[0])},yi.push(function X(){U(),yi.splice(yi.indexOf(X),1)}),++je,Zt(function(){--je==0&&ps()},[])},D.finalize),n()},r,u,m)})}}),Ut&&(Ut.allSettled&&v(Mt,"allSettled",function(){var n=L.apply(null,arguments).map(Si);return new Mt(function(r){n.length===0&&r([]);var u=n.length,m=new Array(u);n.forEach(function(x,T){return Mt.resolve(x).then(function(D){return m[T]={status:"fulfilled",value:D}},function(D){return m[T]={status:"rejected",reason:D}}).then(function(){return--u||r(m)})})})}),Ut.any&&typeof AggregateError<"u"&&v(Mt,"any",function(){var n=L.apply(null,arguments).map(Si);return new Mt(function(r,u){n.length===0&&u(new AggregateError([]));var m=n.length,x=new Array(m);n.forEach(function(T,D){return Mt.resolve(T).then(function(U){return r(U)},function(U){x[D]=U,--m||u(new AggregateError(x))})})})}),Ut.withResolvers&&(Mt.withResolvers=Ut.withResolvers));var me={awaits:0,echoes:0,id:0},mu=0,_i=[],bi=0,wi=0,yu=0;function hn(n,r,u,m){var x=Ft,T=Object.create(x);return T.parent=x,T.ref=0,T.global=!1,T.id=++yu,ae.env,T.env=Bt?{Promise:Mt,PromiseProp:{value:Mt,configurable:!0,writable:!0},all:Mt.all,race:Mt.race,allSettled:Mt.allSettled,any:Mt.any,resolve:Mt.resolve,reject:Mt.reject}:{},r&&h(T,r),++x.ref,T.finalize=function(){--this.parent.ref||this.parent.finalize()},m=En(T,n,u,m),T.ref===0&&T.finalize(),m}function Kn(){return me.id||(me.id=++mu),++me.awaits,me.echoes+=Nt,me.id}function fn(){return!!me.awaits&&(--me.awaits==0&&(me.id=0),me.echoes=me.awaits*Nt,!0)}function Si(n){return me.echoes&&n&&n.constructor===Ut?(Kn(),n.then(function(r){return fn(),r},function(r){return fn(),ue(r)})):n}function vu(){var n=_i[_i.length-1];_i.pop(),dn(n,!1)}function dn(n,r){var u,m=Ft;(r?!me.echoes||bi++&&n===Ft:!bi||--bi&&n===Ft)||queueMicrotask(r?(function(x){++wi,me.echoes&&--me.echoes!=0||(me.echoes=me.awaits=me.id=0),_i.push(Ft),dn(x,!0)}).bind(null,n):vu),n!==Ft&&(Ft=n,m===ae&&(ae.env=ta()),Bt&&(u=ae.env.Promise,r=n.env,(m.global||n.global)&&(Object.defineProperty(o,"Promise",r.PromiseProp),u.all=r.all,u.race=r.race,u.resolve=r.resolve,u.reject=r.reject,r.allSettled&&(u.allSettled=r.allSettled),r.any&&(u.any=r.any))))}function ta(){var n=o.Promise;return Bt?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function En(n,r,u,m,x){var T=Ft;try{return dn(n,!0),r(u,m,x)}finally{dn(T,!1)}}function ea(n,r,u,m){return typeof n!="function"?n:function(){var x=Ft;u&&Kn(),dn(r,!0);try{return n.apply(this,arguments)}finally{dn(x,!1),m&&queueMicrotask(fn)}}}function ms(n){Promise===Ut&&me.echoes===0?bi===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Ge).indexOf("[native code]")===-1&&(Kn=fn=N);var ue=Mt.reject,An="",Je="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",na="String expected.",jn=[],xi="__dbnames",ys="readonly",vs="readwrite";function Rn(n,r){return n?r?function(){return n.apply(this,arguments)&&r.apply(this,arguments)}:n:r}var ra={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ci(n){return typeof n!="string"||/\./.test(n)?function(r){return r}:function(r){return r[n]===void 0&&n in r&&delete(r=W(r))[n],r}}function ia(){throw ht.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Qt(n,r){try{var u=sa(n),m=sa(r);if(u!==m)return u==="Array"?1:m==="Array"?-1:u==="binary"?1:m==="binary"?-1:u==="string"?1:m==="string"?-1:u==="Date"?1:m!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return r<n?1:n<r?-1:0;case"binary":return(function(x,T){for(var D=x.length,U=T.length,Y=D<U?D:U,X=0;X<Y;++X)if(x[X]!==T[X])return x[X]<T[X]?-1:1;return D===U?0:D<U?-1:1})(oa(n),oa(r));case"Array":return(function(x,T){for(var D=x.length,U=T.length,Y=D<U?D:U,X=0;X<Y;++X){var et=Qt(x[X],T[X]);if(et!==0)return et}return D===U?0:D<U?-1:1})(n,r)}}catch{}return NaN}function sa(n){var r=typeof n;return r!="object"?r:ArrayBuffer.isView(n)?"binary":(n=z(n),n==="ArrayBuffer"?"binary":n)}function oa(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Pi(n,r,u){var m=n.schema.yProps;return m?(r&&0<u.numFailures&&(r=r.filter(function(x,T){return!u.failures[T]})),Promise.all(m.map(function(x){return x=x.updatesTable,r?n.db.table(x).where("k").anyOf(r).delete():n.db.table(x).clear()})).then(function(){return u})):u}var rr=(aa.prototype.execute=function(n){var r=this["@@propmod"];if(r.add!==void 0){var u=r.add;if(l(u))return a(a([],l(n)?n:[],!0),u).sort();if(typeof u=="number")return(Number(n)||0)+u;if(typeof u=="bigint")try{return BigInt(n)+u}catch{return BigInt(0)+u}throw new TypeError("Invalid term ".concat(u))}if(r.remove!==void 0){var m=r.remove;if(l(m))return l(n)?n.filter(function(x){return!m.includes(x)}).sort():[];if(typeof m=="number")return Number(n)-m;if(typeof m=="bigint")try{return BigInt(n)-m}catch{return BigInt(0)-m}throw new TypeError("Invalid subtrahend ".concat(m))}return u=(u=r.replacePrefix)===null||u===void 0?void 0:u[0],u&&typeof n=="string"&&n.startsWith(u)?r.replacePrefix[1]+n.substring(u.length):n},aa);function aa(n){this["@@propmod"]=n}function la(n,r){for(var u=c(r),m=u.length,x=!1,T=0;T<m;++T){var D=u[T],U=r[D],Y=I(n,D);U instanceof rr?(q(n,D,U.execute(Y)),x=!0):Y!==U&&(q(n,D,U),x=!0)}return x}var ca=(re.prototype._trans=function(n,r,u){var m=this._tx||Ft.trans,x=this.name,T=mt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function D(X,et,H){if(!H.schema[x])throw new ht.NotFound("Table "+x+" not part of transaction");return r(H.idbtrans,H)}var U=Bn();try{var Y=m&&m.db._novip===this.db._novip?m===Ft.trans?m._promise(n,D,u):hn(function(){return m._promise(n,D,u)},{trans:m,transless:Ft.transless||Ft}):(function X(et,H,rt,Q){if(et.idbdb&&(et._state.openComplete||Ft.letThrough||et._vip)){var Z=et._createTransaction(H,rt,et._dbSchema);try{Z.create(),et._state.PR1398_maxLoop=3}catch(tt){return tt.name===B.InvalidState&&et.isOpen()&&0<--et._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),et.close({disableAutoOpen:!1}),et.open().then(function(){return X(et,H,rt,Q)})):ue(tt)}return Z._promise(H,function(tt,nt){return hn(function(){return Ft.trans=Z,Q(tt,nt,Z)})}).then(function(tt){if(H==="readwrite")try{Z.idbtrans.commit()}catch{}return H==="readonly"?tt:Z._completion.then(function(){return tt})})}if(et._state.openComplete)return ue(new ht.DatabaseClosed(et._state.dbOpenError));if(!et._state.isBeingOpened){if(!et._state.autoOpen)return ue(new ht.DatabaseClosed);et.open().catch(N)}return et._state.dbReadyPromise.then(function(){return X(et,H,rt,Q)})})(this.db,n,[this.name],D);return T&&(Y._consoleTask=T,Y=Y.catch(function(X){return console.trace(X),ue(X)})),Y}finally{U&&Un()}},re.prototype.get=function(n,r){var u=this;return n&&n.constructor===Object?this.where(n).first(r):n==null?ue(new ht.Type("Invalid argument to Table.get()")):this._trans("readonly",function(m){return u.core.get({trans:m,key:n}).then(function(x){return u.hook.reading.fire(x)})}).then(r)},re.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(l(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var r=c(n);if(r.length===1)return this.where(r[0]).equals(n[r[0]]);var u=this.schema.indexes.concat(this.schema.primKey).filter(function(U){if(U.compound&&r.every(function(X){return 0<=U.keyPath.indexOf(X)})){for(var Y=0;Y<r.length;++Y)if(r.indexOf(U.keyPath[Y])===-1)return!1;return!0}return!1}).sort(function(U,Y){return U.keyPath.length-Y.keyPath.length})[0];if(u&&this.db._maxKey!==An){var T=u.keyPath.slice(0,r.length);return this.where(T).equals(T.map(function(Y){return n[Y]}))}!u&&mt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var m=this.schema.idxByName;function x(U,Y){return Qt(U,Y)===0}var D=r.reduce(function(H,Y){var X=H[0],et=H[1],H=m[Y],rt=n[Y];return[X||H,X||!H?Rn(et,H&&H.multi?function(Q){return Q=I(Q,Y),l(Q)&&Q.some(function(Z){return x(rt,Z)})}:function(Q){return x(rt,I(Q,Y))}):et]},[null,null]),T=D[0],D=D[1];return T?this.where(T.name).equals(n[T.keyPath]).filter(D):u?this.filter(D):this.where(r).equals("")},re.prototype.filter=function(n){return this.toCollection().and(n)},re.prototype.count=function(n){return this.toCollection().count(n)},re.prototype.offset=function(n){return this.toCollection().offset(n)},re.prototype.limit=function(n){return this.toCollection().limit(n)},re.prototype.each=function(n){return this.toCollection().each(n)},re.prototype.toArray=function(n){return this.toCollection().toArray(n)},re.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},re.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,l(n)?"[".concat(n.join("+"),"]"):n))},re.prototype.reverse=function(){return this.toCollection().reverse()},re.prototype.mapToClass=function(n){var r,u=this.db,m=this.name;function x(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof ia&&((function(Y,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");function et(){this.constructor=Y}i(Y,X),Y.prototype=X===null?Object.create(X):(et.prototype=X.prototype,new et)})(x,r=n),Object.defineProperty(x.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),x.prototype.table=function(){return m},n=x);for(var T=new Set,D=n.prototype;D;D=g(D))Object.getOwnPropertyNames(D).forEach(function(Y){return T.add(Y)});function U(Y){if(!Y)return Y;var X,et=Object.create(n.prototype);for(X in Y)if(!T.has(X))try{et[X]=Y[X]}catch{}return et}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=U,this.hook("reading",U),n},re.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},re.prototype.add=function(n,r){var u=this,m=this.schema.primKey,x=m.auto,T=m.keyPath,D=n;return T&&x&&(D=Ci(T)(n)),this._trans("readwrite",function(U){return u.core.mutate({trans:U,type:"add",keys:r!=null?[r]:null,values:[D]})}).then(function(U){return U.numFailures?Mt.reject(U.failures[0]):U.lastResult}).then(function(U){if(T)try{q(n,T,U)}catch{}return U})},re.prototype.upsert=function(n,r){var u=this,m=this.schema.primKey.keyPath;return this._trans("readwrite",function(x){return u.core.get({trans:x,key:n}).then(function(T){var D=T??{};return la(D,r),m&&q(D,m,n),u.core.mutate({trans:x,type:"put",values:[D],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[r]}}).then(function(U){return U.numFailures?Mt.reject(U.failures[0]):!!T})})})},re.prototype.update=function(n,r){return typeof n!="object"||l(n)?this.where(":id").equals(n).modify(r):(n=I(n,this.schema.primKey.keyPath),n===void 0?ue(new ht.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(r))},re.prototype.put=function(n,r){var u=this,m=this.schema.primKey,x=m.auto,T=m.keyPath,D=n;return T&&x&&(D=Ci(T)(n)),this._trans("readwrite",function(U){return u.core.mutate({trans:U,type:"put",values:[D],keys:r!=null?[r]:null})}).then(function(U){return U.numFailures?Mt.reject(U.failures[0]):U.lastResult}).then(function(U){if(T)try{q(n,T,U)}catch{}return U})},re.prototype.delete=function(n){var r=this;return this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"delete",keys:[n]}).then(function(m){return Pi(r,[n],m)}).then(function(m){return m.numFailures?Mt.reject(m.failures[0]):void 0})})},re.prototype.clear=function(){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"deleteRange",range:ra}).then(function(u){return Pi(n,null,u)})}).then(function(r){return r.numFailures?Mt.reject(r.failures[0]):void 0})},re.prototype.bulkGet=function(n){var r=this;return this._trans("readonly",function(u){return r.core.getMany({keys:n,trans:u}).then(function(m){return m.map(function(x){return r.hook.reading.fire(x)})})})},re.prototype.bulkAdd=function(n,r,u){var m=this,x=Array.isArray(r)?r:void 0,T=(u=u||(x?void 0:r))?u.allKeys:void 0;return this._trans("readwrite",function(D){var X=m.schema.primKey,U=X.auto,X=X.keyPath;if(X&&x)throw new ht.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(x&&x.length!==n.length)throw new ht.InvalidArgument("Arguments objects and keys must have the same length");var Y=n.length,X=X&&U?n.map(Ci(X)):n;return m.core.mutate({trans:D,type:"add",keys:x,values:X,wantResults:T}).then(function(Z){var H=Z.numFailures,rt=Z.results,Q=Z.lastResult,Z=Z.failures;if(H===0)return T?rt:Q;throw new ot("".concat(m.name,".bulkAdd(): ").concat(H," of ").concat(Y," operations failed"),Z)})})},re.prototype.bulkPut=function(n,r,u){var m=this,x=Array.isArray(r)?r:void 0,T=(u=u||(x?void 0:r))?u.allKeys:void 0;return this._trans("readwrite",function(D){var X=m.schema.primKey,U=X.auto,X=X.keyPath;if(X&&x)throw new ht.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(x&&x.length!==n.length)throw new ht.InvalidArgument("Arguments objects and keys must have the same length");var Y=n.length,X=X&&U?n.map(Ci(X)):n;return m.core.mutate({trans:D,type:"put",keys:x,values:X,wantResults:T}).then(function(Z){var H=Z.numFailures,rt=Z.results,Q=Z.lastResult,Z=Z.failures;if(H===0)return T?rt:Q;throw new ot("".concat(m.name,".bulkPut(): ").concat(H," of ").concat(Y," operations failed"),Z)})})},re.prototype.bulkUpdate=function(n){var r=this,u=this.core,m=n.map(function(D){return D.key}),x=n.map(function(D){return D.changes}),T=[];return this._trans("readwrite",function(D){return u.getMany({trans:D,keys:m,cache:"clone"}).then(function(U){var Y=[],X=[];n.forEach(function(H,rt){var Q=H.key,Z=H.changes,tt=U[rt];if(tt){for(var nt=0,it=Object.keys(Z);nt<it.length;nt++){var lt=it[nt],gt=Z[lt];if(lt===r.schema.primKey.keyPath){if(Qt(gt,Q)!==0)throw new ht.Constraint("Cannot update primary key in bulkUpdate()")}else q(tt,lt,gt)}T.push(rt),Y.push(Q),X.push(tt)}});var et=Y.length;return u.mutate({trans:D,type:"put",keys:Y,values:X,updates:{keys:m,changeSpecs:x}}).then(function(H){var rt=H.numFailures,Q=H.failures;if(rt===0)return et;for(var Z=0,tt=Object.keys(Q);Z<tt.length;Z++){var nt,it=tt[Z],lt=T[Number(it)];lt!=null&&(nt=Q[it],delete Q[it],Q[lt]=nt)}throw new ot("".concat(r.name,".bulkUpdate(): ").concat(rt," of ").concat(et," operations failed"),Q)})})})},re.prototype.bulkDelete=function(n){var r=this,u=n.length;return this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"delete",keys:n}).then(function(x){return Pi(r,n,x)})}).then(function(D){var x=D.numFailures,T=D.lastResult,D=D.failures;if(x===0)return T;throw new ot("".concat(r.name,".bulkDelete(): ").concat(x," of ").concat(u," operations failed"),D)})},re);function re(){}function ir(n){function r(D,U){if(U){for(var Y=arguments.length,X=new Array(Y-1);--Y;)X[Y-1]=arguments[Y];return u[D].subscribe.apply(null,X),n}if(typeof D=="string")return u[D]}var u={};r.addEventType=T;for(var m=1,x=arguments.length;m<x;++m)T(arguments[m]);return r;function T(D,U,Y){if(typeof D!="object"){var X;U=U||xt;var et={subscribers:[],fire:Y=Y||N,subscribe:function(H){et.subscribers.indexOf(H)===-1&&(et.subscribers.push(H),et.fire=U(et.fire,H))},unsubscribe:function(H){et.subscribers=et.subscribers.filter(function(rt){return rt!==H}),et.fire=et.subscribers.reduce(U,Y)}};return u[D]=r[D]=et}c(X=D).forEach(function(H){var rt=X[H];if(l(rt))T(H,X[H][0],X[H][1]);else{if(rt!=="asap")throw new ht.InvalidArgument("Invalid event config");var Q=T(H,V,function(){for(var Z=arguments.length,tt=new Array(Z);Z--;)tt[Z]=arguments[Z];Q.subscribers.forEach(function(nt){P(function(){nt.apply(null,tt)})})})}})}}function sr(n,r){return S(r).from({prototype:n}),r}function Vn(n,r){return!(n.filter||n.algorithm||n.or)&&(r?n.justLimit:!n.replayFilter)}function _s(n,r){n.filter=Rn(n.filter,r)}function bs(n,r,u){var m=n.replayFilter;n.replayFilter=m?function(){return Rn(m(),r())}:r,n.justLimit=u&&!m}function Ti(n,r){if(n.isPrimKey)return r.primaryKey;var u=r.getIndexByKeyPath(n.index);if(!u)throw new ht.Schema("KeyPath "+n.index+" on object store "+r.name+" is not indexed");return u}function ua(n,r,u){var m=Ti(n,r.schema);return r.openCursor({trans:u,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:m,range:n.range}})}function Ei(n,r,u,m){var x=n.replayFilter?Rn(n.filter,n.replayFilter()):n.filter;if(n.or){var T={},D=function(U,Y,X){var et,H;x&&!x(Y,X,function(rt){return Y.stop(rt)},function(rt){return Y.fail(rt)})||((H=""+(et=Y.primaryKey))=="[object ArrayBuffer]"&&(H=""+new Uint8Array(et)),b(T,H)||(T[H]=!0,r(U,Y,X)))};return Promise.all([n.or._iterate(D,u),ha(ua(n,m,u),n.algorithm,D,!n.keysOnly&&n.valueMapper)])}return ha(ua(n,m,u),Rn(n.algorithm,x),r,!n.keysOnly&&n.valueMapper)}function ha(n,r,u,m){var x=le(m?function(T,D,U){return u(m(T),D,U)}:u);return n.then(function(T){if(T)return T.start(function(){var D=function(){return T.continue()};r&&!r(T,function(U){return D=U},function(U){T.stop(U),D=N},function(U){T.fail(U),D=N})||x(T.value,T,function(U){return D=U}),D()})})}var _u=($t.prototype._read=function(n,r){var u=this._ctx;return u.error?u.table._trans(null,ue.bind(null,u.error)):u.table._trans("readonly",n).then(r)},$t.prototype._write=function(n){var r=this._ctx;return r.error?r.table._trans(null,ue.bind(null,r.error)):r.table._trans("readwrite",n,"locked")},$t.prototype._addAlgorithm=function(n){var r=this._ctx;r.algorithm=Rn(r.algorithm,n)},$t.prototype._iterate=function(n,r){return Ei(this._ctx,n,r,this._ctx.table.core)},$t.prototype.clone=function(n){var r=Object.create(this.constructor.prototype),u=Object.create(this._ctx);return n&&h(u,n),r._ctx=u,r},$t.prototype.raw=function(){return this._ctx.valueMapper=null,this},$t.prototype.each=function(n){var r=this._ctx;return this._read(function(u){return Ei(r,n,u,r.table.core)})},$t.prototype.count=function(n){var r=this;return this._read(function(u){var m=r._ctx,x=m.table.core;if(Vn(m,!0))return x.count({trans:u,query:{index:Ti(m,x.schema),range:m.range}}).then(function(D){return Math.min(D,m.limit)});var T=0;return Ei(m,function(){return++T,!1},u,x).then(function(){return T})}).then(n)},$t.prototype.sortBy=function(n,r){var u=n.split(".").reverse(),m=u[0],x=u.length-1;function T(Y,X){return X?T(Y[u[X]],X-1):Y[m]}var D=this._ctx.dir==="next"?1:-1;function U(Y,X){return Qt(T(Y,x),T(X,x))*D}return this.toArray(function(Y){return Y.sort(U)}).then(r)},$t.prototype.toArray=function(n){var r=this;return this._read(function(u){var m=r._ctx;if(m.dir==="next"&&Vn(m,!0)&&0<m.limit){var x=m.valueMapper,T=Ti(m,m.table.core.schema);return m.table.core.query({trans:u,limit:m.limit,values:!0,query:{index:T,range:m.range}}).then(function(U){return U=U.result,x?U.map(x):U})}var D=[];return Ei(m,function(U){return D.push(U)},u,m.table.core).then(function(){return D})},n)},$t.prototype.offset=function(n){var r=this._ctx;return n<=0||(r.offset+=n,Vn(r)?bs(r,function(){var u=n;return function(m,x){return u===0||(u===1?--u:x(function(){m.advance(u),u=0}),!1)}}):bs(r,function(){var u=n;return function(){return--u<0}})),this},$t.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),bs(this._ctx,function(){var r=n;return function(u,m,x){return--r<=0&&m(x),0<=r}},!0),this},$t.prototype.until=function(n,r){return _s(this._ctx,function(u,m,x){return!n(u.value)||(m(x),r)}),this},$t.prototype.first=function(n){return this.limit(1).toArray(function(r){return r[0]}).then(n)},$t.prototype.last=function(n){return this.reverse().first(n)},$t.prototype.filter=function(n){var r;return _s(this._ctx,function(u){return n(u.value)}),(r=this._ctx).isMatch=Rn(r.isMatch,n),this},$t.prototype.and=function(n){return this.filter(n)},$t.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},$t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},$t.prototype.desc=function(){return this.reverse()},$t.prototype.eachKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(u,m){n(m.key,m)})},$t.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},$t.prototype.eachPrimaryKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(u,m){n(m.primaryKey,m)})},$t.prototype.keys=function(n){var r=this._ctx;r.keysOnly=!r.isMatch;var u=[];return this.each(function(m,x){u.push(x.key)}).then(function(){return u}).then(n)},$t.prototype.primaryKeys=function(n){var r=this._ctx;if(r.dir==="next"&&Vn(r,!0)&&0<r.limit)return this._read(function(m){var x=Ti(r,r.table.core.schema);return r.table.core.query({trans:m,values:!1,limit:r.limit,query:{index:x,range:r.range}})}).then(function(m){return m.result}).then(n);r.keysOnly=!r.isMatch;var u=[];return this.each(function(m,x){u.push(x.primaryKey)}).then(function(){return u}).then(n)},$t.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},$t.prototype.firstKey=function(n){return this.limit(1).keys(function(r){return r[0]}).then(n)},$t.prototype.lastKey=function(n){return this.reverse().firstKey(n)},$t.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var r={};return _s(this._ctx,function(x){var m=x.primaryKey.toString(),x=b(r,m);return r[m]=!0,!x}),this},$t.prototype.modify=function(n){var r=this,u=this._ctx;return this._write(function(m){var x=typeof n=="function"?n:function(tt){return la(tt,n)},T=u.table.core,X=T.schema.primaryKey,D=X.outbound,U=X.extractKey,Y=200,X=r.db._options.modifyChunkSize;X&&(Y=typeof X=="object"?X[T.name]||X["*"]||200:X);function et(tt,lt){var it=lt.failures,lt=lt.numFailures;rt+=tt-lt;for(var gt=0,yt=c(it);gt<yt.length;gt++){var Pt=yt[gt];H.push(it[Pt])}}var H=[],rt=0,Q=[],Z=n===fa;return r.clone().primaryKeys().then(function(tt){function nt(lt){var gt=Math.min(Y,tt.length-lt),yt=tt.slice(lt,lt+gt);return(Z?Promise.resolve([]):T.getMany({trans:m,keys:yt,cache:"immutable"})).then(function(Pt){var Rt=[],wt=[],Tt=D?[]:null,Ot=Z?yt:[];if(!Z)for(var Et=0;Et<gt;++Et){var It=Pt[Et],jt={value:W(It),primKey:tt[lt+Et]};x.call(jt,jt.value,jt)!==!1&&(jt.value==null?Ot.push(tt[lt+Et]):D||Qt(U(It),U(jt.value))===0?(wt.push(jt.value),D&&Tt.push(tt[lt+Et])):(Ot.push(tt[lt+Et]),Rt.push(jt.value)))}return Promise.resolve(0<Rt.length&&T.mutate({trans:m,type:"add",values:Rt}).then(function(Vt){for(var Wt in Vt.failures)Ot.splice(parseInt(Wt),1);et(Rt.length,Vt)})).then(function(){return(0<wt.length||it&&typeof n=="object")&&T.mutate({trans:m,type:"put",keys:Tt,values:wt,criteria:it,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<lt}).then(function(Vt){return et(wt.length,Vt)})}).then(function(){return(0<Ot.length||it&&Z)&&T.mutate({trans:m,type:"delete",keys:Ot,criteria:it,isAdditionalChunk:0<lt}).then(function(Vt){return Pi(u.table,Ot,Vt)}).then(function(Vt){return et(Ot.length,Vt)})}).then(function(){return tt.length>lt+gt&&nt(lt+Y)})})}var it=Vn(u)&&u.limit===1/0&&(typeof n!="function"||Z)&&{index:u.index,range:u.range};return nt(0).then(function(){if(0<H.length)throw new St("Error modifying one or more objects",H,rt,Q);return tt.length})})})},$t.prototype.delete=function(){var n=this._ctx,r=n.range;return!Vn(n)||n.table.schema.yProps||!n.isPrimKey&&r.type!==3?this.modify(fa):this._write(function(u){var m=n.table.core.schema.primaryKey,x=r;return n.table.core.count({trans:u,query:{index:m,range:x}}).then(function(T){return n.table.core.mutate({trans:u,type:"deleteRange",range:x}).then(function(Y){var U=Y.failures,Y=Y.numFailures;if(Y)throw new St("Could not delete some values",Object.keys(U).map(function(X){return U[X]}),T-Y);return T-Y})})})},$t);function $t(){}var fa=function(n,r){return r.value=null};function bu(n,r){return n<r?-1:n===r?0:1}function wu(n,r){return r<n?-1:n===r?0:1}function Ne(n,r,u){return n=n instanceof ga?new n.Collection(n):n,n._ctx.error=new(u||TypeError)(r),n}function qn(n){return new n.Collection(n,function(){return da("")}).limit(0)}function Ai(n,r,u,m){var x,T,D,U,Y,X,et,H=u.length;if(!u.every(function(Z){return typeof Z=="string"}))return Ne(n,na);function rt(Z){x=Z==="next"?function(nt){return nt.toUpperCase()}:function(nt){return nt.toLowerCase()},T=Z==="next"?function(nt){return nt.toLowerCase()}:function(nt){return nt.toUpperCase()},D=Z==="next"?bu:wu;var tt=u.map(function(nt){return{lower:T(nt),upper:x(nt)}}).sort(function(nt,it){return D(nt.lower,it.lower)});U=tt.map(function(nt){return nt.upper}),Y=tt.map(function(nt){return nt.lower}),et=(X=Z)==="next"?"":m}rt("next"),n=new n.Collection(n,function(){return gn(U[0],Y[H-1]+m)}),n._ondirectionchange=function(Z){rt(Z)};var Q=0;return n._addAlgorithm(function(Z,tt,nt){var it=Z.key;if(typeof it!="string")return!1;var lt=T(it);if(r(lt,Y,Q))return!0;for(var gt=null,yt=Q;yt<H;++yt){var Pt=(function(Rt,wt,Tt,Ot,Et,It){for(var jt=Math.min(Rt.length,Ot.length),Vt=-1,Wt=0;Wt<jt;++Wt){var De=wt[Wt];if(De!==Ot[Wt])return Et(Rt[Wt],Tt[Wt])<0?Rt.substr(0,Wt)+Tt[Wt]+Tt.substr(Wt+1):Et(Rt[Wt],Ot[Wt])<0?Rt.substr(0,Wt)+Ot[Wt]+Tt.substr(Wt+1):0<=Vt?Rt.substr(0,Vt)+wt[Vt]+Tt.substr(Vt+1):null;Et(Rt[Wt],De)<0&&(Vt=Wt)}return jt<Ot.length&&It==="next"?Rt+Tt.substr(Rt.length):jt<Rt.length&&It==="prev"?Rt.substr(0,Tt.length):Vt<0?null:Rt.substr(0,Vt)+Ot[Vt]+Tt.substr(Vt+1)})(it,lt,U[yt],Y[yt],D,X);Pt===null&&gt===null?Q=yt+1:(gt===null||0<D(gt,Pt))&&(gt=Pt)}return tt(gt!==null?function(){Z.continue(gt+et)}:nt),!1}),n}function gn(n,r,u,m){return{type:2,lower:n,upper:r,lowerOpen:u,upperOpen:m}}function da(n){return{type:1,lower:n,upper:n}}var ga=(Object.defineProperty(ye.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ye.prototype.between=function(n,r,u,m){u=u!==!1,m=m===!0;try{return 0<this._cmp(n,r)||this._cmp(n,r)===0&&(u||m)&&(!u||!m)?qn(this):new this.Collection(this,function(){return gn(n,r,!u,!m)})}catch{return Ne(this,Je)}},ye.prototype.equals=function(n){return n==null?Ne(this,Je):new this.Collection(this,function(){return da(n)})},ye.prototype.above=function(n){return n==null?Ne(this,Je):new this.Collection(this,function(){return gn(n,void 0,!0)})},ye.prototype.aboveOrEqual=function(n){return n==null?Ne(this,Je):new this.Collection(this,function(){return gn(n,void 0,!1)})},ye.prototype.below=function(n){return n==null?Ne(this,Je):new this.Collection(this,function(){return gn(void 0,n,!1,!0)})},ye.prototype.belowOrEqual=function(n){return n==null?Ne(this,Je):new this.Collection(this,function(){return gn(void 0,n)})},ye.prototype.startsWith=function(n){return typeof n!="string"?Ne(this,na):this.between(n,n+An,!0,!0)},ye.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ai(this,function(r,u){return r.indexOf(u[0])===0},[n],An)},ye.prototype.equalsIgnoreCase=function(n){return Ai(this,function(r,u){return r===u[0]},[n],"")},ye.prototype.anyOfIgnoreCase=function(){var n=L.apply(G,arguments);return n.length===0?qn(this):Ai(this,function(r,u){return u.indexOf(r)!==-1},n,"")},ye.prototype.startsWithAnyOfIgnoreCase=function(){var n=L.apply(G,arguments);return n.length===0?qn(this):Ai(this,function(r,u){return u.some(function(m){return r.indexOf(m)===0})},n,An)},ye.prototype.anyOf=function(){var n=this,r=L.apply(G,arguments),u=this._cmp;try{r.sort(u)}catch{return Ne(this,Je)}if(r.length===0)return qn(this);var m=new this.Collection(this,function(){return gn(r[0],r[r.length-1])});m._ondirectionchange=function(T){u=T==="next"?n._ascending:n._descending,r.sort(u)};var x=0;return m._addAlgorithm(function(T,D,U){for(var Y=T.key;0<u(Y,r[x]);)if(++x===r.length)return D(U),!1;return u(Y,r[x])===0||(D(function(){T.continue(r[x])}),!1)}),m},ye.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ye.prototype.noneOf=function(){var n=L.apply(G,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Ne(this,Je)}var r=n.reduce(function(u,m){return u?u.concat([[u[u.length-1][1],m]]):[[-1/0,m]]},null);return r.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},ye.prototype.inAnyRange=function(it,r){var u=this,m=this._cmp,x=this._ascending,T=this._descending,D=this._min,U=this._max;if(it.length===0)return qn(this);if(!it.every(function(lt){return lt[0]!==void 0&&lt[1]!==void 0&&x(lt[0],lt[1])<=0}))return Ne(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ht.InvalidArgument);var Y=!r||r.includeLowers!==!1,X=r&&r.includeUppers===!0,et,H=x;function rt(lt,gt){return H(lt[0],gt[0])}try{(et=it.reduce(function(lt,gt){for(var yt=0,Pt=lt.length;yt<Pt;++yt){var Rt=lt[yt];if(m(gt[0],Rt[1])<0&&0<m(gt[1],Rt[0])){Rt[0]=D(Rt[0],gt[0]),Rt[1]=U(Rt[1],gt[1]);break}}return yt===Pt&&lt.push(gt),lt},[])).sort(rt)}catch{return Ne(this,Je)}var Q=0,Z=X?function(lt){return 0<x(lt,et[Q][1])}:function(lt){return 0<=x(lt,et[Q][1])},tt=Y?function(lt){return 0<T(lt,et[Q][0])}:function(lt){return 0<=T(lt,et[Q][0])},nt=Z,it=new this.Collection(this,function(){return gn(et[0][0],et[et.length-1][1],!Y,!X)});return it._ondirectionchange=function(lt){H=lt==="next"?(nt=Z,x):(nt=tt,T),et.sort(rt)},it._addAlgorithm(function(lt,gt,yt){for(var Pt,Rt=lt.key;nt(Rt);)if(++Q===et.length)return gt(yt),!1;return!Z(Pt=Rt)&&!tt(Pt)||(u._cmp(Rt,et[Q][1])===0||u._cmp(Rt,et[Q][0])===0||gt(function(){H===x?lt.continue(et[Q][0]):lt.continue(et[Q][1])}),!1)}),it},ye.prototype.startsWithAnyOf=function(){var n=L.apply(G,arguments);return n.every(function(r){return typeof r=="string"})?n.length===0?qn(this):this.inAnyRange(n.map(function(r){return[r,r+An]})):Ne(this,"startsWithAnyOf() only works with strings")},ye);function ye(){}function Ve(n){return le(function(r){return or(r),n(r.target.error),!1})}function or(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ar="storagemutated",ws="x-storagemutated-1",pn=ir(null,ar),Su=(qe.prototype._lock=function(){return w(!Ft.global),++this._reculock,this._reculock!==1||Ft.global||(Ft.lockOwnerFor=this),this},qe.prototype._unlock=function(){if(w(!Ft.global),--this._reculock==0)for(Ft.global||(Ft.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{En(n[1],n[0])}catch{}}return this},qe.prototype._locked=function(){return this._reculock&&Ft.lockOwnerFor!==this},qe.prototype.create=function(n){var r=this;if(!this.mode)return this;var u=this.db.idbdb,m=this.db._state.dbOpenError;if(w(!this.idbtrans),!n&&!u)switch(m&&m.name){case"DatabaseClosedError":throw new ht.DatabaseClosed(m);case"MissingAPIError":throw new ht.MissingAPI(m.message,m);default:throw new ht.OpenFailed(m)}if(!this.active)throw new ht.TransactionInactive;return w(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||u).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=le(function(x){or(x),r._reject(n.error)}),n.onabort=le(function(x){or(x),r.active&&r._reject(new ht.Abort(n.error)),r.active=!1,r.on("abort").fire(x)}),n.oncomplete=le(function(){r.active=!1,r._resolve(),"mutatedParts"in n&&pn.storagemutated.fire(n.mutatedParts)}),this},qe.prototype._promise=function(n,r,u){var m=this;if(n==="readwrite"&&this.mode!=="readwrite")return ue(new ht.ReadOnly("Transaction is readonly"));if(!this.active)return ue(new ht.TransactionInactive);if(this._locked())return new Mt(function(T,D){m._blockedFuncs.push([function(){m._promise(n,r,u).then(T,D)},Ft])});if(u)return hn(function(){var T=new Mt(function(D,U){m._lock();var Y=r(D,U,m);Y&&Y.then&&Y.then(D,U)});return T.finally(function(){return m._unlock()}),T._lib=!0,T});var x=new Mt(function(T,D){var U=r(T,D,m);U&&U.then&&U.then(T,D)});return x._lib=!0,x},qe.prototype._root=function(){return this.parent?this.parent._root():this},qe.prototype.waitFor=function(n){var r,u=this._root(),m=Mt.resolve(n);u._waitingFor?u._waitingFor=u._waitingFor.then(function(){return m}):(u._waitingFor=m,u._waitingQueue=[],r=u.idbtrans.objectStore(u.storeNames[0]),(function T(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(r.get(-1/0).onsuccess=T)})());var x=u._waitingFor;return new Mt(function(T,D){m.then(function(U){return u._waitingQueue.push(le(T.bind(null,U)))},function(U){return u._waitingQueue.push(le(D.bind(null,U)))}).finally(function(){u._waitingFor===x&&(u._waitingFor=null)})})},qe.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ht.Abort))},qe.prototype.table=function(n){var r=this._memoizedTables||(this._memoizedTables={});if(b(r,n))return r[n];var u=this.schema[n];if(!u)throw new ht.NotFound("Table "+n+" not part of transaction");return u=new this.db.Table(n,u,this),u.core=this.db.core.table(n),r[n]=u},qe);function qe(){}function Ss(n,r,u,m,x,T,D,U){return{name:n,keyPath:r,unique:u,multi:m,auto:x,compound:T,src:(u&&!D?"&":"")+(m?"*":"")+(x?"++":"")+pa(r),type:U}}function pa(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function xs(n,r,u){return{name:n,primKey:r,indexes:u,mappedClass:null,idxByName:(m=function(x){return[x.name,x]},u.reduce(function(x,T,D){return D=m(T,D),D&&(x[D[0]]=D[1]),x},{}))};var m}var lr=function(n){try{return n.only([[]]),lr=function(){return[[]]},[[]]}catch{return lr=function(){return An},An}};function Cs(n){return n==null?function(){}:typeof n=="string"?(r=n).split(".").length===1?function(u){return u[r]}:function(u){return I(u,r)}:function(u){return I(u,n)};var r}function ma(n){return[].slice.call(n)}var xu=0;function cr(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Cu(n,r,Y){function m(nt){if(nt.type===3)return null;if(nt.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Q=nt.lower,Z=nt.upper,tt=nt.lowerOpen,nt=nt.upperOpen;return Q===void 0?Z===void 0?null:r.upperBound(Z,!!nt):Z===void 0?r.lowerBound(Q,!!tt):r.bound(Q,Z,!!tt,!!nt)}function x(rt){var Q,Z=rt.name;return{name:Z,schema:rt,mutate:function(tt){var nt=tt.trans,it=tt.type,lt=tt.keys,gt=tt.values,yt=tt.range;return new Promise(function(Pt,Rt){Pt=le(Pt);var wt=nt.objectStore(Z),Tt=wt.keyPath==null,Ot=it==="put"||it==="add";if(!Ot&&it!=="delete"&&it!=="deleteRange")throw new Error("Invalid operation type: "+it);var Et,It=(lt||gt||{length:1}).length;if(lt&&gt&&lt.length!==gt.length)throw new Error("Given keys array must have same length as given values array.");if(It===0)return Pt({numFailures:0,failures:{},results:[],lastResult:void 0});function jt(Ee){++De,or(Ee)}var Vt=[],Wt=[],De=0;if(it==="deleteRange"){if(yt.type===4)return Pt({numFailures:De,failures:Wt,results:[],lastResult:void 0});yt.type===3?Vt.push(Et=wt.clear()):Vt.push(Et=wt.delete(m(yt)))}else{var Tt=Ot?Tt?[gt,lt]:[gt,null]:[lt,null],Kt=Tt[0],Se=Tt[1];if(Ot)for(var xe=0;xe<It;++xe)Vt.push(Et=Se&&Se[xe]!==void 0?wt[it](Kt[xe],Se[xe]):wt[it](Kt[xe])),Et.onerror=jt;else for(xe=0;xe<It;++xe)Vt.push(Et=wt[it](Kt[xe])),Et.onerror=jt}function Ui(Ee){Ee=Ee.target.result,Vt.forEach(function(Mn,js){return Mn.error!=null&&(Wt[js]=Mn.error)}),Pt({numFailures:De,failures:Wt,results:it==="delete"?lt:Vt.map(function(Mn){return Mn.result}),lastResult:Ee})}Et.onerror=function(Ee){jt(Ee),Ui(Ee)},Et.onsuccess=Ui})},getMany:function(tt){var nt=tt.trans,it=tt.keys;return new Promise(function(lt,gt){lt=le(lt);for(var yt,Pt=nt.objectStore(Z),Rt=it.length,wt=new Array(Rt),Tt=0,Ot=0,Et=function(Vt){Vt=Vt.target,wt[Vt._pos]=Vt.result,++Ot===Tt&&lt(wt)},It=Ve(gt),jt=0;jt<Rt;++jt)it[jt]!=null&&((yt=Pt.get(it[jt]))._pos=jt,yt.onsuccess=Et,yt.onerror=It,++Tt);Tt===0&&lt(wt)})},get:function(tt){var nt=tt.trans,it=tt.key;return new Promise(function(lt,gt){lt=le(lt);var yt=nt.objectStore(Z).get(it);yt.onsuccess=function(Pt){return lt(Pt.target.result)},yt.onerror=Ve(gt)})},query:(Q=X,function(tt){return new Promise(function(nt,it){nt=le(nt);var lt,gt,yt,Tt=tt.trans,Pt=tt.values,Rt=tt.limit,Et=tt.query,wt=Rt===1/0?void 0:Rt,Ot=Et.index,Et=Et.range,Tt=Tt.objectStore(Z),Ot=Ot.isPrimaryKey?Tt:Tt.index(Ot.name),Et=m(Et);if(Rt===0)return nt({result:[]});Q?((wt=Pt?Ot.getAll(Et,wt):Ot.getAllKeys(Et,wt)).onsuccess=function(It){return nt({result:It.target.result})},wt.onerror=Ve(it)):(lt=0,gt=!Pt&&"openKeyCursor"in Ot?Ot.openKeyCursor(Et):Ot.openCursor(Et),yt=[],gt.onsuccess=function(It){var jt=gt.result;return jt?(yt.push(Pt?jt.value:jt.primaryKey),++lt===Rt?nt({result:yt}):void jt.continue()):nt({result:yt})},gt.onerror=Ve(it))})}),openCursor:function(tt){var nt=tt.trans,it=tt.values,lt=tt.query,gt=tt.reverse,yt=tt.unique;return new Promise(function(Pt,Rt){Pt=le(Pt);var Ot=lt.index,wt=lt.range,Tt=nt.objectStore(Z),Tt=Ot.isPrimaryKey?Tt:Tt.index(Ot.name),Ot=gt?yt?"prevunique":"prev":yt?"nextunique":"next",Et=!it&&"openKeyCursor"in Tt?Tt.openKeyCursor(m(wt),Ot):Tt.openCursor(m(wt),Ot);Et.onerror=Ve(Rt),Et.onsuccess=le(function(It){var jt,Vt,Wt,De,Kt=Et.result;Kt?(Kt.___id=++xu,Kt.done=!1,jt=Kt.continue.bind(Kt),Vt=(Vt=Kt.continuePrimaryKey)&&Vt.bind(Kt),Wt=Kt.advance.bind(Kt),De=function(){throw new Error("Cursor not stopped")},Kt.trans=nt,Kt.stop=Kt.continue=Kt.continuePrimaryKey=Kt.advance=function(){throw new Error("Cursor not started")},Kt.fail=le(Rt),Kt.next=function(){var Se=this,xe=1;return this.start(function(){return xe--?Se.continue():Se.stop()}).then(function(){return Se})},Kt.start=function(Se){function xe(){if(Et.result)try{Se()}catch(Ee){Kt.fail(Ee)}else Kt.done=!0,Kt.start=function(){throw new Error("Cursor behind last entry")},Kt.stop()}var Ui=new Promise(function(Ee,Mn){Ee=le(Ee),Et.onerror=Ve(Mn),Kt.fail=Mn,Kt.stop=function(js){Kt.stop=Kt.continue=Kt.continuePrimaryKey=Kt.advance=De,Ee(js)}});return Et.onsuccess=le(function(Ee){Et.onsuccess=xe,xe()}),Kt.continue=jt,Kt.continuePrimaryKey=Vt,Kt.advance=Wt,xe(),Ui},Pt(Kt)):Pt(null)},Rt)})},count:function(tt){var nt=tt.query,it=tt.trans,lt=nt.index,gt=nt.range;return new Promise(function(yt,Pt){var Rt=it.objectStore(Z),wt=lt.isPrimaryKey?Rt:Rt.index(lt.name),Rt=m(gt),wt=Rt?wt.count(Rt):wt.count();wt.onsuccess=le(function(Tt){return yt(Tt.target.result)}),wt.onerror=Ve(Pt)})}}}var T,D,U,et=(D=Y,U=ma((T=n).objectStoreNames),{schema:{name:T.name,tables:U.map(function(rt){return D.objectStore(rt)}).map(function(rt){var Q=rt.keyPath,nt=rt.autoIncrement,Z=l(Q),tt={},nt={name:rt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Q==null,compound:Z,keyPath:Q,autoIncrement:nt,unique:!0,extractKey:Cs(Q)},indexes:ma(rt.indexNames).map(function(it){return rt.index(it)}).map(function(yt){var lt=yt.name,gt=yt.unique,Pt=yt.multiEntry,yt=yt.keyPath,Pt={name:lt,compound:l(yt),keyPath:yt,unique:gt,multiEntry:Pt,extractKey:Cs(yt)};return tt[cr(yt)]=Pt}),getIndexByKeyPath:function(it){return tt[cr(it)]}};return tt[":id"]=nt.primaryKey,Q!=null&&(tt[cr(Q)]=nt.primaryKey),nt})},hasGetAll:0<U.length&&"getAll"in D.objectStore(U[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Y=et.schema,X=et.hasGetAll,et=Y.tables.map(x),H={};return et.forEach(function(rt){return H[rt.name]=rt}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(rt){if(!H[rt])throw new Error("Table '".concat(rt,"' not found"));return H[rt]},MIN_KEY:-1/0,MAX_KEY:lr(r),schema:Y}}function Pu(n,r,u,m){var x=u.IDBKeyRange;return u.indexedDB,{dbcore:(m=Cu(r,x,m),n.dbcore.reduce(function(T,D){return D=D.create,s(s({},T),D(T))},m))}}function Ri(n,m){var u=m.db,m=Pu(n._middlewares,u,n._deps,m);n.core=m.dbcore,n.tables.forEach(function(x){var T=x.name;n.core.schema.tables.some(function(D){return D.name===T})&&(x.core=n.core.table(T),n[T]instanceof n.Table&&(n[T].core=x.core))})}function ki(n,r,u,m){u.forEach(function(x){var T=m[x];r.forEach(function(D){var U=(function Y(X,et){return E(X,et)||(X=g(X))&&Y(X,et)})(D,x);(!U||"value"in U&&U.value===void 0)&&(D===n.Transaction.prototype||D instanceof n.Transaction?v(D,x,{get:function(){return this.table(x)},set:function(Y){p(this,x,{value:Y,writable:!0,configurable:!0,enumerable:!0})}}):D[x]=new n.Table(x,T))})})}function Ps(n,r){r.forEach(function(u){for(var m in u)u[m]instanceof n.Table&&delete u[m]})}function Tu(n,r){return n._cfg.version-r._cfg.version}function Eu(n,r,u,m){var x=n._dbSchema;u.objectStoreNames.contains("$meta")&&!x.$meta&&(x.$meta=xs("$meta",va("")[0],[]),n._storeNames.push("$meta"));var T=n._createTransaction("readwrite",n._storeNames,x);T.create(u),T._completion.catch(m);var D=T._reject.bind(T),U=Ft.transless||Ft;hn(function(){return Ft.trans=T,Ft.transless=U,r!==0?(Ri(n,u),X=r,((Y=T).storeNames.includes("$meta")?Y.table("$meta").get("version").then(function(et){return et??X}):Mt.resolve(X)).then(function(et){return rt=et,Q=T,Z=u,tt=[],et=(H=n)._versions,nt=H._dbSchema=Mi(0,H.idbdb,Z),(et=et.filter(function(it){return it._cfg.version>=rt})).length!==0?(et.forEach(function(it){tt.push(function(){var lt=nt,gt=it._cfg.dbschema;Fi(H,lt,Z),Fi(H,gt,Z),nt=H._dbSchema=gt;var yt=Ts(lt,gt);yt.add.forEach(function(Ot){Es(Z,Ot[0],Ot[1].primKey,Ot[1].indexes)}),yt.change.forEach(function(Ot){if(Ot.recreate)throw new ht.Upgrade("Not yet support for changing primary key");var Et=Z.objectStore(Ot.name);Ot.add.forEach(function(It){return Oi(Et,It)}),Ot.change.forEach(function(It){Et.deleteIndex(It.name),Oi(Et,It)}),Ot.del.forEach(function(It){return Et.deleteIndex(It)})});var Pt=it._cfg.contentUpgrade;if(Pt&&it._cfg.version>rt){Ri(H,Z),Q._memoizedTables={};var Rt=A(gt);yt.del.forEach(function(Ot){Rt[Ot]=lt[Ot]}),Ps(H,[H.Transaction.prototype]),ki(H,[H.Transaction.prototype],c(Rt),Rt),Q.schema=Rt;var wt,Tt=j(Pt);return Tt&&Kn(),yt=Mt.follow(function(){var Ot;(wt=Pt(Q))&&Tt&&(Ot=fn.bind(null,null),wt.then(Ot,Ot))}),wt&&typeof wt.then=="function"?Mt.resolve(wt):yt.then(function(){return wt})}}),tt.push(function(lt){var gt,yt,Pt=it._cfg.dbschema;gt=Pt,yt=lt,[].slice.call(yt.db.objectStoreNames).forEach(function(Rt){return gt[Rt]==null&&yt.db.deleteObjectStore(Rt)}),Ps(H,[H.Transaction.prototype]),ki(H,[H.Transaction.prototype],H._storeNames,H._dbSchema),Q.schema=H._dbSchema}),tt.push(function(lt){H.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(H.idbdb.version/10)===it._cfg.version?(H.idbdb.deleteObjectStore("$meta"),delete H._dbSchema.$meta,H._storeNames=H._storeNames.filter(function(gt){return gt!=="$meta"})):lt.objectStore("$meta").put(it._cfg.version,"version"))})}),(function it(){return tt.length?Mt.resolve(tt.shift()(Q.idbtrans)).then(it):Mt.resolve()})().then(function(){ya(nt,Z)})):Mt.resolve();var H,rt,Q,Z,tt,nt}).catch(D)):(c(x).forEach(function(et){Es(u,et,x[et].primKey,x[et].indexes)}),Ri(n,u),void Mt.follow(function(){return n.on.populate.fire(T)}).catch(D));var Y,X})}function Au(n,r){ya(n._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var u=Mi(0,n.idbdb,r);Fi(n,n._dbSchema,r);for(var m=0,x=Ts(u,n._dbSchema).change;m<x.length;m++){var T=(function(D){if(D.change.length||D.recreate)return console.warn("Unable to patch indexes of table ".concat(D.name," because it has changes on the type of index or primary key.")),{value:void 0};var U=r.objectStore(D.name);D.add.forEach(function(Y){mt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(D.name,".").concat(Y.src)),Oi(U,Y)})})(x[m]);if(typeof T=="object")return T.value}}function Ts(n,r){var u,m={del:[],add:[],change:[]};for(u in n)r[u]||m.del.push(u);for(u in r){var x=n[u],T=r[u];if(x){var D={name:u,def:T,recreate:!1,del:[],add:[],change:[]};if(""+(x.primKey.keyPath||"")!=""+(T.primKey.keyPath||"")||x.primKey.auto!==T.primKey.auto)D.recreate=!0,m.change.push(D);else{var U=x.idxByName,Y=T.idxByName,X=void 0;for(X in U)Y[X]||D.del.push(X);for(X in Y){var et=U[X],H=Y[X];et?et.src!==H.src&&D.change.push(H):D.add.push(H)}(0<D.del.length||0<D.add.length||0<D.change.length)&&m.change.push(D)}}else m.add.push([u,T])}return m}function Es(n,r,u,m){var x=n.db.createObjectStore(r,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});return m.forEach(function(T){return Oi(x,T)}),x}function ya(n,r){c(n).forEach(function(u){r.db.objectStoreNames.contains(u)||(mt&&console.debug("Dexie: Creating missing table",u),Es(r,u,n[u].primKey,n[u].indexes))})}function Oi(n,r){n.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function Mi(n,r,u){var m={};return y(r.objectStoreNames,0).forEach(function(x){for(var T=u.objectStore(x),D=Ss(pa(X=T.keyPath),X||"",!0,!1,!!T.autoIncrement,X&&typeof X!="string",!0),U=[],Y=0;Y<T.indexNames.length;++Y){var et=T.index(T.indexNames[Y]),X=et.keyPath,et=Ss(et.name,X,!!et.unique,!!et.multiEntry,!1,X&&typeof X!="string",!1);U.push(et)}m[x]=xs(x,D,U)}),m}function Fi(n,r,u){for(var m=u.db.objectStoreNames,x=0;x<m.length;++x){var T=m[x],D=u.objectStore(T);n._hasGetAll="getAll"in D;for(var U=0;U<D.indexNames.length;++U){var Y=D.indexNames[U],X=D.index(Y).keyPath,et=typeof X=="string"?X:"["+y(X).join("+")+"]";!r[T]||(X=r[T].idxByName[et])&&(X.name=Y,delete r[T].idxByName[et],r[T].idxByName[Y]=X)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function va(n){return n.split(",").map(function(r,u){var T=r.split(":"),m=(x=T[1])===null||x===void 0?void 0:x.trim(),x=(r=T[0].trim()).replace(/([&*]|\+\+)/g,""),T=/^\[/.test(x)?x.match(/^\[(.*)\]$/)[1].split("+"):x;return Ss(x,T||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),l(T),u===0,m)})}var Ru=(Hn.prototype._createTableSchema=xs,Hn.prototype._parseIndexSyntax=va,Hn.prototype._parseStoresSpec=function(n,r){var u=this;c(n).forEach(function(m){if(n[m]!==null){var x=u._parseIndexSyntax(n[m]),T=x.shift();if(!T)throw new ht.Schema("Invalid schema for table "+m+": "+n[m]);if(T.unique=!0,T.multi)throw new ht.Schema("Primary key cannot be multiEntry*");x.forEach(function(D){if(D.auto)throw new ht.Schema("Only primary key can be marked as autoIncrement (++)");if(!D.keyPath)throw new ht.Schema("Index must have a name and cannot be an empty string")}),x=u._createTableSchema(m,T,x),r[m]=x}})},Hn.prototype.stores=function(u){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,u):u;var u=r._versions,m={},x={};return u.forEach(function(T){h(m,T._cfg.storesSource),x=T._cfg.dbschema={},T._parseStoresSpec(m,x)}),r._dbSchema=x,Ps(r,[r._allTables,r,r.Transaction.prototype]),ki(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],c(x),x),r._storeNames=c(x),this},Hn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=_t(this._cfg.contentUpgrade||N,n),this},Hn);function Hn(){}function As(n,r){var u=n._dbNamesDB;return u||(u=n._dbNamesDB=new $e(xi,{addons:[],indexedDB:n,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),u.table("dbnames")}function Rs(n){return n&&typeof n.databases=="function"}function ks(n){return hn(function(){return Ft.letThrough=!0,n()})}function Os(n){return!("from"in n)}var we=function(n,r){if(!this){var u=new we;return n&&"d"in n&&h(u,n),u}h(this,arguments.length?{d:1,from:n,to:1<arguments.length?r:n}:{d:0})};function ur(n,r,u){var m=Qt(r,u);if(!isNaN(m)){if(0<m)throw RangeError();if(Os(n))return h(n,{from:r,to:u,d:1});var x=n.l,m=n.r;if(Qt(u,n.from)<0)return x?ur(x,r,u):n.l={from:r,to:u,d:1,l:null,r:null},ba(n);if(0<Qt(r,n.to))return m?ur(m,r,u):n.r={from:r,to:u,d:1,l:null,r:null},ba(n);Qt(r,n.from)<0&&(n.from=r,n.l=null,n.d=m?m.d+1:1),0<Qt(u,n.to)&&(n.to=u,n.r=null,n.d=n.l?n.l.d+1:1),u=!n.r,x&&!n.l&&hr(n,x),m&&u&&hr(n,m)}}function hr(n,r){Os(r)||(function u(m,Y){var T=Y.from,D=Y.to,U=Y.l,Y=Y.r;ur(m,T,D),U&&u(m,U),Y&&u(m,Y)})(n,r)}function _a(n,r){var u=Ii(r),m=u.next();if(m.done)return!1;for(var x=m.value,T=Ii(n),D=T.next(x.from),U=D.value;!m.done&&!D.done;){if(Qt(U.from,x.to)<=0&&0<=Qt(U.to,x.from))return!0;Qt(x.from,U.from)<0?x=(m=u.next(U.from)).value:U=(D=T.next(x.from)).value}return!1}function Ii(n){var r=Os(n)?null:{s:0,n};return{next:function(u){for(var m=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,m)for(;r.n.l&&Qt(u,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!m||Qt(u,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function ba(n){var r,u,m=(((r=n.r)===null||r===void 0?void 0:r.d)||0)-(((u=n.l)===null||u===void 0?void 0:u.d)||0),x=1<m?"r":m<-1?"l":"";x&&(r=x=="r"?"l":"r",u=s({},n),m=n[x],n.from=m.from,n.to=m.to,n[x]=m[x],u[x]=m[r],(n[r]=u).d=wa(u)),n.d=wa(n)}function wa(u){var r=u.r,u=u.l;return(r?u?Math.max(r.d,u.d):r.d:u?u.d:0)+1}function Ni(n,r){return c(r).forEach(function(u){n[u]?hr(n[u],r[u]):n[u]=(function m(x){var T,D,U={};for(T in x)b(x,T)&&(D=x[T],U[T]=!D||typeof D!="object"||M.has(D.constructor)?D:m(D));return U})(r[u])}),n}function Ms(n,r){return n.all||r.all||Object.keys(n).some(function(u){return r[u]&&_a(r[u],n[u])})}_(we.prototype,((Ge={add:function(n){return hr(this,n),this},addKey:function(n){return ur(this,n,n),this},addKeys:function(n){var r=this;return n.forEach(function(u){return ur(r,u,u)}),this},hasKey:function(n){var r=Ii(this).next(n).value;return r&&Qt(r.from,n)<=0&&0<=Qt(r.to,n)}})[ft]=function(){return Ii(this)},Ge));var kn={},Fs={},Is=!1;function Di(n){Ni(Fs,n),Is||(Is=!0,setTimeout(function(){Is=!1,Ns(Fs,!(Fs={}))},0))}function Ns(n,r){r===void 0&&(r=!1);var u=new Set;if(n.all)for(var m=0,x=Object.values(kn);m<x.length;m++)Sa(D=x[m],n,u,r);else for(var T in n){var D,U=/^idb\:\/\/(.*)\/(.*)\//.exec(T);U&&(T=U[1],U=U[2],(D=kn["idb://".concat(T,"/").concat(U)])&&Sa(D,n,u,r))}u.forEach(function(Y){return Y()})}function Sa(n,r,u,m){for(var x=[],T=0,D=Object.entries(n.queries.query);T<D.length;T++){for(var U=D[T],Y=U[0],X=[],et=0,H=U[1];et<H.length;et++){var rt=H[et];Ms(r,rt.obsSet)?rt.subscribers.forEach(function(nt){return u.add(nt)}):m&&X.push(rt)}m&&x.push([Y,X])}if(m)for(var Q=0,Z=x;Q<Z.length;Q++){var tt=Z[Q],Y=tt[0],X=tt[1];n.queries.query[Y]=X}}function ku(n){var r=n._state,u=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?ue(r.dbOpenError):n});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var m=r.openCanceller,x=Math.round(10*n.verno),T=!1;function D(){if(r.openCanceller!==m)throw new ht.DatabaseClosed("db.open() was cancelled")}function U(){return new Mt(function(rt,Q){if(D(),!u)throw new ht.MissingAPI;var Z=n.name,tt=r.autoSchema||!x?u.open(Z):u.open(Z,x);if(!tt)throw new ht.MissingAPI;tt.onerror=Ve(Q),tt.onblocked=le(n._fireOnBlocked),tt.onupgradeneeded=le(function(nt){var it;et=tt.transaction,r.autoSchema&&!n._options.allowEmptyDB?(tt.onerror=or,et.abort(),tt.result.close(),(it=u.deleteDatabase(Z)).onsuccess=it.onerror=le(function(){Q(new ht.NoSuchDatabase("Database ".concat(Z," doesnt exist")))})):(et.onerror=Ve(Q),nt=nt.oldVersion>Math.pow(2,62)?0:nt.oldVersion,H=nt<1,n.idbdb=tt.result,T&&Au(n,et),Eu(n,nt/10,et,Q))},Q),tt.onsuccess=le(function(){et=null;var nt,it,lt,gt,yt,Pt=n.idbdb=tt.result,Rt=y(Pt.objectStoreNames);if(0<Rt.length)try{var wt=Pt.transaction((gt=Rt).length===1?gt[0]:gt,"readonly");if(r.autoSchema)it=Pt,lt=wt,(nt=n).verno=it.version/10,lt=nt._dbSchema=Mi(0,it,lt),nt._storeNames=y(it.objectStoreNames,0),ki(nt,[nt._allTables],c(lt),lt);else if(Fi(n,n._dbSchema,wt),((yt=Ts(Mi(0,(yt=n).idbdb,wt),yt._dbSchema)).add.length||yt.change.some(function(Tt){return Tt.add.length||Tt.change.length}))&&!T)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Pt.close(),x=Pt.version+1,T=!0,rt(U());Ri(n,wt)}catch{}jn.push(n),Pt.onversionchange=le(function(Tt){r.vcFired=!0,n.on("versionchange").fire(Tt)}),Pt.onclose=le(function(){n.close({disableAutoOpen:!1})}),H&&(yt=n._deps,wt=Z,Pt=yt.indexedDB,yt=yt.IDBKeyRange,Rs(Pt)||wt===xi||As(Pt,yt).put({name:wt}).catch(N)),rt()},Q)}).catch(function(rt){switch(rt==null?void 0:rt.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),U();break;case"VersionError":if(0<x)return x=0,U()}return Mt.reject(rt)})}var Y,X=r.dbReadyResolve,et=null,H=!1;return Mt.race([m,(typeof navigator>"u"?Mt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(rt){function Q(){return indexedDB.databases().finally(rt)}Y=setInterval(Q,100),Q()}).finally(function(){return clearInterval(Y)}):Promise.resolve()).then(U)]).then(function(){return D(),r.onReadyBeingFired=[],Mt.resolve(ks(function(){return n.on.ready.fire(n.vip)})).then(function rt(){if(0<r.onReadyBeingFired.length){var Q=r.onReadyBeingFired.reduce(_t,N);return r.onReadyBeingFired=[],Mt.resolve(ks(function(){return Q(n.vip)})).then(rt)}})}).finally(function(){r.openCanceller===m&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(rt){r.dbOpenError=rt;try{et&&et.abort()}catch{}return m===r.openCanceller&&n._close(),ue(rt)}).finally(function(){r.openComplete=!0,X()}).then(function(){var rt;return H&&(rt={},n.tables.forEach(function(Q){Q.schema.indexes.forEach(function(Z){Z.name&&(rt["idb://".concat(n.name,"/").concat(Q.name,"/").concat(Z.name)]=new we(-1/0,[[[]]]))}),rt["idb://".concat(n.name,"/").concat(Q.name,"/")]=rt["idb://".concat(n.name,"/").concat(Q.name,"/:dels")]=new we(-1/0,[[[]]])}),pn(ar).fire(rt),Ns(rt,!0)),n})}function Ds(n){function r(T){return n.next(T)}var u=x(r),m=x(function(T){return n.throw(T)});function x(T){return function(Y){var U=T(Y),Y=U.value;return U.done?Y:Y&&typeof Y.then=="function"?Y.then(u,m):l(Y)?Promise.all(Y).then(u,m):u(Y)}}return x(r)()}function Li(n,r,u){for(var m=l(n)?n.slice():[n],x=0;x<u;++x)m.push(r);return m}var Ou={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return s(s({},n),{table:function(r){var u=n.table(r),m=u.schema,x={},T=[];function D(H,rt,Q){var Z=cr(H),tt=x[Z]=x[Z]||[],nt=H==null?0:typeof H=="string"?1:H.length,it=0<rt,it=s(s({},Q),{name:it?"".concat(Z,"(virtual-from:").concat(Q.name,")"):Q.name,lowLevelIndex:Q,isVirtual:it,keyTail:rt,keyLength:nt,extractKey:Cs(H),unique:!it&&Q.unique});return tt.push(it),it.isPrimaryKey||T.push(it),1<nt&&D(nt===2?H[0]:H.slice(0,nt-1),rt+1,Q),tt.sort(function(lt,gt){return lt.keyTail-gt.keyTail}),it}r=D(m.primaryKey.keyPath,0,m.primaryKey),x[":id"]=[r];for(var U=0,Y=m.indexes;U<Y.length;U++){var X=Y[U];D(X.keyPath,0,X)}function et(H){var rt,Q=H.query.index;return Q.isVirtual?s(s({},H),{query:{index:Q.lowLevelIndex,range:(rt=H.query.range,Q=Q.keyTail,{type:rt.type===1?2:rt.type,lower:Li(rt.lower,rt.lowerOpen?n.MAX_KEY:n.MIN_KEY,Q),lowerOpen:!0,upper:Li(rt.upper,rt.upperOpen?n.MIN_KEY:n.MAX_KEY,Q),upperOpen:!0})}}):H}return s(s({},u),{schema:s(s({},m),{primaryKey:r,indexes:T,getIndexByKeyPath:function(H){return(H=x[cr(H)])&&H[0]}}),count:function(H){return u.count(et(H))},query:function(H){return u.query(et(H))},openCursor:function(H){var rt=H.query.index,Q=rt.keyTail,Z=rt.isVirtual,tt=rt.keyLength;return Z?u.openCursor(et(H)).then(function(it){return it&&nt(it)}):u.openCursor(H);function nt(it){return Object.create(it,{continue:{value:function(lt){lt!=null?it.continue(Li(lt,H.reverse?n.MAX_KEY:n.MIN_KEY,Q)):H.unique?it.continue(it.key.slice(0,tt).concat(H.reverse?n.MIN_KEY:n.MAX_KEY,Q)):it.continue()}},continuePrimaryKey:{value:function(lt,gt){it.continuePrimaryKey(Li(lt,n.MAX_KEY,Q),gt)}},primaryKey:{get:function(){return it.primaryKey}},key:{get:function(){var lt=it.key;return tt===1?lt[0]:lt.slice(0,tt)}},value:{get:function(){return it.value}}})}}})}})}};function Ls(n,r,u,m){return u=u||{},m=m||"",c(n).forEach(function(x){var T,D,U;b(r,x)?(T=n[x],D=r[x],typeof T=="object"&&typeof D=="object"&&T&&D?(U=z(T))!==z(D)?u[m+x]=r[x]:U==="Object"?Ls(T,D,u,m+x+"."):T!==D&&(u[m+x]=r[x]):T!==D&&(u[m+x]=r[x])):u[m+x]=void 0}),c(r).forEach(function(x){b(n,x)||(u[m+x]=r[x])}),u}function Gs(n,r){return r.type==="delete"?r.keys:r.keys||r.values.map(n.extractKey)}var Mu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return s(s({},n),{table:function(r){var u=n.table(r),m=u.schema.primaryKey;return s(s({},u),{mutate:function(x){var T=Ft.trans,D=T.table(r).hook,U=D.deleting,Y=D.creating,X=D.updating;switch(x.type){case"add":if(Y.fire===N)break;return T._promise("readwrite",function(){return et(x)},!0);case"put":if(Y.fire===N&&X.fire===N)break;return T._promise("readwrite",function(){return et(x)},!0);case"delete":if(U.fire===N)break;return T._promise("readwrite",function(){return et(x)},!0);case"deleteRange":if(U.fire===N)break;return T._promise("readwrite",function(){return(function H(rt,Q,Z){return u.query({trans:rt,values:!1,query:{index:m,range:Q},limit:Z}).then(function(tt){var nt=tt.result;return et({type:"delete",keys:nt,trans:rt}).then(function(it){return 0<it.numFailures?Promise.reject(it.failures[0]):nt.length<Z?{failures:[],numFailures:0,lastResult:void 0}:H(rt,s(s({},Q),{lower:nt[nt.length-1],lowerOpen:!0}),Z)})})})(x.trans,x.range,1e4)},!0)}return u.mutate(x);function et(H){var rt,Q,Z,tt=Ft.trans,nt=H.keys||Gs(m,H);if(!nt)throw new Error("Keys missing");return(H=H.type==="add"||H.type==="put"?s(s({},H),{keys:nt}):s({},H)).type!=="delete"&&(H.values=a([],H.values)),H.keys&&(H.keys=a([],H.keys)),rt=u,Z=nt,((Q=H).type==="add"?Promise.resolve([]):rt.getMany({trans:Q.trans,keys:Z,cache:"immutable"})).then(function(it){var lt=nt.map(function(gt,yt){var Pt,Rt,wt,Tt=it[yt],Ot={onerror:null,onsuccess:null};return H.type==="delete"?U.fire.call(Ot,gt,Tt,tt):H.type==="add"||Tt===void 0?(Pt=Y.fire.call(Ot,gt,H.values[yt],tt),gt==null&&Pt!=null&&(H.keys[yt]=gt=Pt,m.outbound||q(H.values[yt],m.keyPath,gt))):(Pt=Ls(Tt,H.values[yt]),(Rt=X.fire.call(Ot,Pt,gt,Tt,tt))&&(wt=H.values[yt],Object.keys(Rt).forEach(function(Et){b(wt,Et)?wt[Et]=Rt[Et]:q(wt,Et,Rt[Et])}))),Ot});return u.mutate(H).then(function(gt){for(var yt=gt.failures,Pt=gt.results,Rt=gt.numFailures,gt=gt.lastResult,wt=0;wt<nt.length;++wt){var Tt=(Pt||nt)[wt],Ot=lt[wt];Tt==null?Ot.onerror&&Ot.onerror(yt[wt]):Ot.onsuccess&&Ot.onsuccess(H.type==="put"&&it[wt]?H.values[wt]:Tt)}return{failures:yt,results:Pt,numFailures:Rt,lastResult:gt}}).catch(function(gt){return lt.forEach(function(yt){return yt.onerror&&yt.onerror(gt)}),Promise.reject(gt)})})}}})}})}};function xa(n,r,u){try{if(!r||r.keys.length<n.length)return null;for(var m=[],x=0,T=0;x<r.keys.length&&T<n.length;++x)Qt(r.keys[x],n[T])===0&&(m.push(u?W(r.values[x]):r.values[x]),++T);return m.length===n.length?m:null}catch{return null}}var Fu={stack:"dbcore",level:-1,create:function(n){return{table:function(r){var u=n.table(r);return s(s({},u),{getMany:function(m){if(!m.cache)return u.getMany(m);var x=xa(m.keys,m.trans._cache,m.cache==="clone");return x?Mt.resolve(x):u.getMany(m).then(function(T){return m.trans._cache={keys:m.keys,values:m.cache==="clone"?W(T):T},T})},mutate:function(m){return m.type!=="add"&&(m.trans._cache=null),u.mutate(m)}})}}}};function Ca(n,r){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function Pa(n,r){switch(n){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Iu={stack:"dbcore",level:0,name:"Observability",create:function(n){var r=n.schema.name,u=new we(n.MIN_KEY,n.MAX_KEY);return s(s({},n),{transaction:function(m,x,T){if(Ft.subscr&&x!=="readonly")throw new ht.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ft.querier));return n.transaction(m,x,T)},table:function(m){var x=n.table(m),T=x.schema,D=T.primaryKey,H=T.indexes,U=D.extractKey,Y=D.outbound,X=D.autoIncrement&&H.filter(function(Q){return Q.compound&&Q.keyPath.includes(D.keyPath)}),et=s(s({},x),{mutate:function(Q){function Z(Et){return Et="idb://".concat(r,"/").concat(m,"/").concat(Et),gt[Et]||(gt[Et]=new we)}var tt,nt,it,lt=Q.trans,gt=Q.mutatedParts||(Q.mutatedParts={}),yt=Z(""),Pt=Z(":dels"),Rt=Q.type,Ot=Q.type==="deleteRange"?[Q.range]:Q.type==="delete"?[Q.keys]:Q.values.length<50?[Gs(D,Q).filter(function(Et){return Et}),Q.values]:[],wt=Ot[0],Tt=Ot[1],Ot=Q.trans._cache;return l(wt)?(yt.addKeys(wt),(Ot=Rt==="delete"||wt.length===Tt.length?xa(wt,Ot):null)||Pt.addKeys(wt),(Ot||Tt)&&(tt=Z,nt=Ot,it=Tt,T.indexes.forEach(function(Et){var It=tt(Et.name||"");function jt(Wt){return Wt!=null?Et.extractKey(Wt):null}function Vt(Wt){return Et.multiEntry&&l(Wt)?Wt.forEach(function(De){return It.addKey(De)}):It.addKey(Wt)}(nt||it).forEach(function(Wt,Se){var Kt=nt&&jt(nt[Se]),Se=it&&jt(it[Se]);Qt(Kt,Se)!==0&&(Kt!=null&&Vt(Kt),Se!=null&&Vt(Se))})}))):wt?(Tt={from:(Tt=wt.lower)!==null&&Tt!==void 0?Tt:n.MIN_KEY,to:(Tt=wt.upper)!==null&&Tt!==void 0?Tt:n.MAX_KEY},Pt.add(Tt),yt.add(Tt)):(yt.add(u),Pt.add(u),T.indexes.forEach(function(Et){return Z(Et.name).add(u)})),x.mutate(Q).then(function(Et){return!wt||Q.type!=="add"&&Q.type!=="put"||(yt.addKeys(Et.results),X&&X.forEach(function(It){for(var jt=Q.values.map(function(Kt){return It.extractKey(Kt)}),Vt=It.keyPath.findIndex(function(Kt){return Kt===D.keyPath}),Wt=0,De=Et.results.length;Wt<De;++Wt)jt[Wt][Vt]=Et.results[Wt];Z(It.name).addKeys(jt)})),lt.mutatedParts=Ni(lt.mutatedParts||{},gt),Et})}}),H=function(Z){var tt=Z.query,Z=tt.index,tt=tt.range;return[Z,new we((Z=tt.lower)!==null&&Z!==void 0?Z:n.MIN_KEY,(tt=tt.upper)!==null&&tt!==void 0?tt:n.MAX_KEY)]},rt={get:function(Q){return[D,new we(Q.key)]},getMany:function(Q){return[D,new we().addKeys(Q.keys)]},count:H,query:H,openCursor:H};return c(rt).forEach(function(Q){et[Q]=function(Z){var tt=Ft.subscr,nt=!!tt,it=Ca(Ft,x)&&Pa(Q,Z)?Z.obsSet={}:tt;if(nt){var lt=function(Tt){return Tt="idb://".concat(r,"/").concat(m,"/").concat(Tt),it[Tt]||(it[Tt]=new we)},gt=lt(""),yt=lt(":dels"),tt=rt[Q](Z),nt=tt[0],tt=tt[1];if((Q==="query"&&nt.isPrimaryKey&&!Z.values?yt:lt(nt.name||"")).add(tt),!nt.isPrimaryKey){if(Q!=="count"){var Pt=Q==="query"&&Y&&Z.values&&x.query(s(s({},Z),{values:!1}));return x[Q].apply(this,arguments).then(function(Tt){if(Q==="query"){if(Y&&Z.values)return Pt.then(function(jt){return jt=jt.result,gt.addKeys(jt),Tt});var Ot=Z.values?Tt.result.map(U):Tt.result;(Z.values?gt:yt).addKeys(Ot)}else if(Q==="openCursor"){var Et=Tt,It=Z.values;return Et&&Object.create(Et,{key:{get:function(){return yt.addKey(Et.primaryKey),Et.key}},primaryKey:{get:function(){var jt=Et.primaryKey;return yt.addKey(jt),jt}},value:{get:function(){return It&&gt.addKey(Et.primaryKey),Et.value}}})}return Tt})}yt.add(u)}}return x[Q].apply(this,arguments)}}),et}})}};function Ta(n,r,u){if(u.numFailures===0)return r;if(r.type==="deleteRange")return null;var m=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return u.numFailures===m?null:(r=s({},r),l(r.keys)&&(r.keys=r.keys.filter(function(x,T){return!(T in u.failures)})),"values"in r&&l(r.values)&&(r.values=r.values.filter(function(x,T){return!(T in u.failures)})),r)}function Bs(n,r){return u=n,((m=r).lower===void 0||(m.lowerOpen?0<Qt(u,m.lower):0<=Qt(u,m.lower)))&&(n=n,(r=r).upper===void 0||(r.upperOpen?Qt(n,r.upper)<0:Qt(n,r.upper)<=0));var u,m}function Ea(n,r,rt,m,x,T){if(!rt||rt.length===0)return n;var D=r.query.index,U=D.multiEntry,Y=r.query.range,X=m.schema.primaryKey.extractKey,et=D.extractKey,H=(D.lowLevelIndex||D).extractKey,rt=rt.reduce(function(Q,Z){var tt=Q,nt=[];if(Z.type==="add"||Z.type==="put")for(var it=new we,lt=Z.values.length-1;0<=lt;--lt){var gt,yt=Z.values[lt],Pt=X(yt);it.hasKey(Pt)||(gt=et(yt),(U&&l(gt)?gt.some(function(Et){return Bs(Et,Y)}):Bs(gt,Y))&&(it.addKey(Pt),nt.push(yt)))}switch(Z.type){case"add":var Rt=new we().addKeys(r.values?Q.map(function(It){return X(It)}):Q),tt=Q.concat(r.values?nt.filter(function(It){return It=X(It),!Rt.hasKey(It)&&(Rt.addKey(It),!0)}):nt.map(function(It){return X(It)}).filter(function(It){return!Rt.hasKey(It)&&(Rt.addKey(It),!0)}));break;case"put":var wt=new we().addKeys(Z.values.map(function(It){return X(It)}));tt=Q.filter(function(It){return!wt.hasKey(r.values?X(It):It)}).concat(r.values?nt:nt.map(function(It){return X(It)}));break;case"delete":var Tt=new we().addKeys(Z.keys);tt=Q.filter(function(It){return!Tt.hasKey(r.values?X(It):It)});break;case"deleteRange":var Ot=Z.range;tt=Q.filter(function(It){return!Bs(X(It),Ot)})}return tt},n);return rt===n?n:(rt.sort(function(Q,Z){return Qt(H(Q),H(Z))||Qt(X(Q),X(Z))}),r.limit&&r.limit<1/0&&(rt.length>r.limit?rt.length=r.limit:n.length===r.limit&&rt.length<r.limit&&(x.dirty=!0)),T?Object.freeze(rt):rt)}function Aa(n,r){return Qt(n.lower,r.lower)===0&&Qt(n.upper,r.upper)===0&&!!n.lowerOpen==!!r.lowerOpen&&!!n.upperOpen==!!r.upperOpen}function Nu(n,r){return(function(u,m,x,T){if(u===void 0)return m!==void 0?-1:0;if(m===void 0)return 1;if((m=Qt(u,m))===0){if(x&&T)return 0;if(x)return 1;if(T)return-1}return m})(n.lower,r.lower,n.lowerOpen,r.lowerOpen)<=0&&0<=(function(u,m,x,T){if(u===void 0)return m!==void 0?1:0;if(m===void 0)return-1;if((m=Qt(u,m))===0){if(x&&T)return 0;if(x)return-1;if(T)return 1}return m})(n.upper,r.upper,n.upperOpen,r.upperOpen)}function Du(n,r,u,m){n.subscribers.add(u),m.addEventListener("abort",function(){var x,T;n.subscribers.delete(u),n.subscribers.size===0&&(x=n,T=r,setTimeout(function(){x.subscribers.size===0&&R(T,x)},3e3))})}var Lu={stack:"dbcore",level:0,name:"Cache",create:function(n){var r=n.schema.name;return s(s({},n),{transaction:function(u,m,x){var T,D,U=n.transaction(u,m,x);return m==="readwrite"&&(D=(T=new AbortController).signal,x=function(Y){return function(){if(T.abort(),m==="readwrite"){for(var X=new Set,et=0,H=u;et<H.length;et++){var rt=H[et],Q=kn["idb://".concat(r,"/").concat(rt)];if(Q){var Z=n.table(rt),tt=Q.optimisticOps.filter(function(It){return It.trans===U});if(U._explicit&&Y&&U.mutatedParts)for(var nt=0,it=Object.values(Q.queries.query);nt<it.length;nt++)for(var lt=0,gt=(Rt=it[nt]).slice();lt<gt.length;lt++)Ms((wt=gt[lt]).obsSet,U.mutatedParts)&&(R(Rt,wt),wt.subscribers.forEach(function(It){return X.add(It)}));else if(0<tt.length){Q.optimisticOps=Q.optimisticOps.filter(function(It){return It.trans!==U});for(var yt=0,Pt=Object.values(Q.queries.query);yt<Pt.length;yt++)for(var Rt,wt,Tt,Ot=0,Et=(Rt=Pt[yt]).slice();Ot<Et.length;Ot++)(wt=Et[Ot]).res!=null&&U.mutatedParts&&(Y&&!wt.dirty?(Tt=Object.isFrozen(wt.res),Tt=Ea(wt.res,wt.req,tt,Z,wt,Tt),wt.dirty?(R(Rt,wt),wt.subscribers.forEach(function(It){return X.add(It)})):Tt!==wt.res&&(wt.res=Tt,wt.promise=Mt.resolve({result:Tt}))):(wt.dirty&&R(Rt,wt),wt.subscribers.forEach(function(It){return X.add(It)})))}}}X.forEach(function(It){return It()})}}},U.addEventListener("abort",x(!1),{signal:D}),U.addEventListener("error",x(!1),{signal:D}),U.addEventListener("complete",x(!0),{signal:D})),U},table:function(u){var m=n.table(u),x=m.schema.primaryKey;return s(s({},m),{mutate:function(T){var D=Ft.trans;if(x.outbound||D.db._options.cache==="disabled"||D.explicit||D.idbtrans.mode!=="readwrite")return m.mutate(T);var U=kn["idb://".concat(r,"/").concat(u)];return U?(D=m.mutate(T),T.type!=="add"&&T.type!=="put"||!(50<=T.values.length||Gs(x,T).some(function(Y){return Y==null}))?(U.optimisticOps.push(T),T.mutatedParts&&Di(T.mutatedParts),D.then(function(Y){0<Y.numFailures&&(R(U.optimisticOps,T),(Y=Ta(0,T,Y))&&U.optimisticOps.push(Y),T.mutatedParts&&Di(T.mutatedParts))}),D.catch(function(){R(U.optimisticOps,T),T.mutatedParts&&Di(T.mutatedParts)})):D.then(function(Y){var X=Ta(0,s(s({},T),{values:T.values.map(function(et,H){var rt;return Y.failures[H]?et:(et=(rt=x.keyPath)!==null&&rt!==void 0&&rt.includes(".")?W(et):s({},et),q(et,x.keyPath,Y.results[H]),et)})}),Y);U.optimisticOps.push(X),queueMicrotask(function(){return T.mutatedParts&&Di(T.mutatedParts)})}),D):m.mutate(T)},query:function(T){if(!Ca(Ft,m)||!Pa("query",T))return m.query(T);var D=((X=Ft.trans)===null||X===void 0?void 0:X.db._options.cache)==="immutable",H=Ft,U=H.requery,Y=H.signal,X=(function(Z,tt,nt,it){var lt=kn["idb://".concat(Z,"/").concat(tt)];if(!lt)return[];if(!(tt=lt.queries[nt]))return[null,!1,lt,null];var gt=tt[(it.query?it.query.index.name:null)||""];if(!gt)return[null,!1,lt,null];switch(nt){case"query":var yt=gt.find(function(Pt){return Pt.req.limit===it.limit&&Pt.req.values===it.values&&Aa(Pt.req.query.range,it.query.range)});return yt?[yt,!0,lt,gt]:[gt.find(function(Pt){return("limit"in Pt.req?Pt.req.limit:1/0)>=it.limit&&(!it.values||Pt.req.values)&&Nu(Pt.req.query.range,it.query.range)}),!1,lt,gt];case"count":return yt=gt.find(function(Pt){return Aa(Pt.req.query.range,it.query.range)}),[yt,!!yt,lt,gt]}})(r,u,"query",T),et=X[0],H=X[1],rt=X[2],Q=X[3];return et&&H?et.obsSet=T.obsSet:(H=m.query(T).then(function(Z){var tt=Z.result;if(et&&(et.res=tt),D){for(var nt=0,it=tt.length;nt<it;++nt)Object.freeze(tt[nt]);Object.freeze(tt)}else Z.result=W(tt);return Z}).catch(function(Z){return Q&&et&&R(Q,et),Promise.reject(Z)}),et={obsSet:T.obsSet,promise:H,subscribers:new Set,type:"query",req:T,dirty:!1},Q?Q.push(et):(Q=[et],(rt=rt||(kn["idb://".concat(r,"/").concat(u)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[T.query.index.name||""]=Q)),Du(et,Q,U,Y),et.promise.then(function(Z){return{result:Ea(Z.result,T,rt==null?void 0:rt.optimisticOps,m,et,D)}})}})}})}};function Gi(n,r){return new Proxy(n,{get:function(u,m,x){return m==="db"?r:Reflect.get(u,m,x)}})}var $e=(he.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ht.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ht.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var r=this._versions,u=r.filter(function(m){return m._cfg.version===n})[0];return u||(u=new this.Version(n),r.push(u),r.sort(Tu),u.stores({}),this._state.autoSchema=!1,u)},he.prototype._whenReady=function(n){var r=this;return this.idbdb&&(this._state.openComplete||Ft.letThrough||this._vip)?n():new Mt(function(u,m){if(r._state.openComplete)return m(new ht.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void m(new ht.DatabaseClosed);r.open().catch(N)}r._state.dbReadyPromise.then(u,m)}).then(n)},he.prototype.use=function(n){var r=n.stack,u=n.create,m=n.level,x=n.name;return x&&this.unuse({stack:r,name:x}),n=this._middlewares[r]||(this._middlewares[r]=[]),n.push({stack:r,create:u,level:m??10,name:x}),n.sort(function(T,D){return T.level-D.level}),this},he.prototype.unuse=function(n){var r=n.stack,u=n.name,m=n.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(x){return m?x.create!==m:!!u&&x.name!==u})),this},he.prototype.open=function(){var n=this;return En(ae,function(){return ku(n)})},he.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,r=jn.indexOf(this);if(0<=r&&jn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Mt(function(u){n.dbReadyResolve=u}),n.openCanceller=new Mt(function(u,m){n.cancelOpen=m}))},he.prototype.close=function(u){var r=(u===void 0?{disableAutoOpen:!0}:u).disableAutoOpen,u=this._state;r?(u.isBeingOpened&&u.cancelOpen(new ht.DatabaseClosed),this._close(),u.autoOpen=!1,u.dbOpenError=new ht.DatabaseClosed):(this._close(),u.autoOpen=this._options.autoOpen||u.isBeingOpened,u.openComplete=!1,u.dbOpenError=null)},he.prototype.delete=function(n){var r=this;n===void 0&&(n={disableAutoOpen:!0});var u=0<arguments.length&&typeof arguments[0]!="object",m=this._state;return new Mt(function(x,T){function D(){r.close(n);var U=r._deps.indexedDB.deleteDatabase(r.name);U.onsuccess=le(function(){var Y,X,et;Y=r._deps,X=r.name,et=Y.indexedDB,Y=Y.IDBKeyRange,Rs(et)||X===xi||As(et,Y).delete(X).catch(N),x()}),U.onerror=Ve(T),U.onblocked=r._fireOnBlocked}if(u)throw new ht.InvalidArgument("Invalid closeOptions argument to db.delete()");m.isBeingOpened?m.dbReadyPromise.then(D):D()})},he.prototype.backendDB=function(){return this.idbdb},he.prototype.isOpen=function(){return this.idbdb!==null},he.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},he.prototype.hasFailed=function(){return this._state.dbOpenError!==null},he.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(he.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(r){return n._allTables[r]})},enumerable:!1,configurable:!0}),he.prototype.transaction=function(){var n=(function(r,u,m){var x=arguments.length;if(x<2)throw new ht.InvalidArgument("Too few arguments");for(var T=new Array(x-1);--x;)T[x-1]=arguments[x];return m=T.pop(),[r,F(T),m]}).apply(this,arguments);return this._transaction.apply(this,n)},he.prototype._transaction=function(n,r,u){var m=this,x=Ft.trans;x&&x.db===this&&n.indexOf("!")===-1||(x=null);var T,D,U=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(D=r.map(function(X){if(X=X instanceof m.Table?X.name:X,typeof X!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return X}),n=="r"||n===ys)T=ys;else{if(n!="rw"&&n!=vs)throw new ht.InvalidArgument("Invalid transaction mode: "+n);T=vs}if(x){if(x.mode===ys&&T===vs){if(!U)throw new ht.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");x=null}x&&D.forEach(function(X){if(x&&x.storeNames.indexOf(X)===-1){if(!U)throw new ht.SubTransaction("Table "+X+" not included in parent transaction.");x=null}}),U&&x&&!x.active&&(x=null)}}catch(X){return x?x._promise(null,function(et,H){H(X)}):ue(X)}var Y=(function X(et,H,rt,Q,Z){return Mt.resolve().then(function(){var tt=Ft.transless||Ft,nt=et._createTransaction(H,rt,et._dbSchema,Q);if(nt.explicit=!0,tt={trans:nt,transless:tt},Q)nt.idbtrans=Q.idbtrans;else try{nt.create(),nt.idbtrans._explicit=!0,et._state.PR1398_maxLoop=3}catch(gt){return gt.name===B.InvalidState&&et.isOpen()&&0<--et._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),et.close({disableAutoOpen:!1}),et.open().then(function(){return X(et,H,rt,null,Z)})):ue(gt)}var it,lt=j(Z);return lt&&Kn(),tt=Mt.follow(function(){var gt;(it=Z.call(nt,nt))&&(lt?(gt=fn.bind(null,null),it.then(gt,gt)):typeof it.next=="function"&&typeof it.throw=="function"&&(it=Ds(it)))},tt),(it&&typeof it.then=="function"?Mt.resolve(it).then(function(gt){return nt.active?gt:ue(new ht.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):tt.then(function(){return it})).then(function(gt){return Q&&nt._resolve(),nt._completion.then(function(){return gt})}).catch(function(gt){return nt._reject(gt),ue(gt)})})}).bind(null,this,T,D,x,u);return x?x._promise(T,Y,"lock"):Ft.trans?En(Ft.transless,function(){return m._whenReady(Y)}):this._whenReady(Y)},he.prototype.table=function(n){if(!b(this._allTables,n))throw new ht.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},he);function he(n,r){var u=this;this._middlewares={},this.verno=0;var m=he.dependencies;this._options=r=s({addons:he.addons,autoOpen:!0,indexedDB:m.indexedDB,IDBKeyRange:m.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},m=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var x,T,D,U,Y,X={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:N,dbReadyPromise:null,cancelOpen:N,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};X.dbReadyPromise=new Mt(function(H){X.dbReadyResolve=H}),X.openCanceller=new Mt(function(H,rt){X.cancelOpen=rt}),this._state=X,this.name=n,this.on=ir(this,"populate","blocked","versionchange","close",{ready:[_t,N]}),this.once=function(H,rt){var Q=function(){for(var Z=[],tt=0;tt<arguments.length;tt++)Z[tt]=arguments[tt];u.on(H).unsubscribe(Q),rt.apply(u,Z)};return u.on(H,Q)},this.on.ready.subscribe=f(this.on.ready.subscribe,function(H){return function(rt,Q){he.vip(function(){var Z,tt=u._state;tt.openComplete?(tt.dbOpenError||Mt.resolve().then(rt),Q&&H(rt)):tt.onReadyBeingFired?(tt.onReadyBeingFired.push(rt),Q&&H(rt)):(H(rt),Z=u,Q||H(function nt(){Z.on.ready.unsubscribe(rt),Z.on.ready.unsubscribe(nt)}))})}}),this.Collection=(x=this,sr(_u.prototype,function(it,nt){this.db=x;var Q=ra,Z=null;if(nt)try{Q=nt()}catch(lt){Z=lt}var tt=it._ctx,nt=tt.table,it=nt.hook.reading.fire;this._ctx={table:nt,index:tt.index,isPrimKey:!tt.index||nt.schema.primKey.keyPath&&tt.index===nt.schema.primKey.name,range:Q,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Z,or:tt.or,valueMapper:it!==V?it:null}})),this.Table=(T=this,sr(ca.prototype,function(H,rt,Q){this.db=T,this._tx=Q,this.name=H,this.schema=rt,this.hook=T._allTables[H]?T._allTables[H].hook:ir(null,{creating:[pt,N],reading:[st,V],updating:[bt,N],deleting:[dt,N]})})),this.Transaction=(D=this,sr(Su.prototype,function(H,rt,Q,Z,tt){var nt=this;H!=="readonly"&&rt.forEach(function(it){it=(it=Q[it])===null||it===void 0?void 0:it.yProps,it&&(rt=rt.concat(it.map(function(lt){return lt.updatesTable})))}),this.db=D,this.mode=H,this.storeNames=rt,this.schema=Q,this.chromeTransactionDurability=Z,this.idbtrans=null,this.on=ir(this,"complete","error","abort"),this.parent=tt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Mt(function(it,lt){nt._resolve=it,nt._reject=lt}),this._completion.then(function(){nt.active=!1,nt.on.complete.fire()},function(it){var lt=nt.active;return nt.active=!1,nt.on.error.fire(it),nt.parent?nt.parent._reject(it):lt&&nt.idbtrans&&nt.idbtrans.abort(),ue(it)})})),this.Version=(U=this,sr(Ru.prototype,function(H){this.db=U,this._cfg={version:H,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Y=this,sr(ga.prototype,function(H,rt,Q){if(this.db=Y,this._ctx={table:H,index:rt===":id"?null:rt,or:Q},this._cmp=this._ascending=Qt,this._descending=function(Z,tt){return Qt(tt,Z)},this._max=function(Z,tt){return 0<Qt(Z,tt)?Z:tt},this._min=function(Z,tt){return Qt(Z,tt)<0?Z:tt},this._IDBKeyRange=Y._deps.IDBKeyRange,!this._IDBKeyRange)throw new ht.MissingAPI})),this.on("versionchange",function(H){0<H.newVersion?console.warn("Another connection wants to upgrade database '".concat(u.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(u.name,"'. Closing db now to resume the delete request.")),u.close({disableAutoOpen:!1})}),this.on("blocked",function(H){!H.newVersion||H.newVersion<H.oldVersion?console.warn("Dexie.delete('".concat(u.name,"') was blocked")):console.warn("Upgrade '".concat(u.name,"' blocked by other connection holding version ").concat(H.oldVersion/10))}),this._maxKey=lr(r.IDBKeyRange),this._createTransaction=function(H,rt,Q,Z){return new u.Transaction(H,rt,Q,u._options.chromeTransactionDurability,Z)},this._fireOnBlocked=function(H){u.on("blocked").fire(H),jn.filter(function(rt){return rt.name===u.name&&rt!==u&&!rt._state.vcFired}).map(function(rt){return rt.on("versionchange").fire(H)})},this.use(Fu),this.use(Lu),this.use(Iu),this.use(Ou),this.use(Mu);var et=new Proxy(this,{get:function(H,rt,Q){if(rt==="_vip")return!0;if(rt==="table")return function(tt){return Gi(u.table(tt),et)};var Z=Reflect.get(H,rt,Q);return Z instanceof ca?Gi(Z,et):rt==="tables"?Z.map(function(tt){return Gi(tt,et)}):rt==="_createTransaction"?function(){return Gi(Z.apply(this,arguments),et)}:Z}});this.vip=et,m.forEach(function(H){return H(u)})}var Bi,Ge=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Gu=(Us.prototype.subscribe=function(n,r,u){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:r,complete:u})},Us.prototype[Ge]=function(){return this},Us);function Us(n){this._subscribe=n}try{Bi={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Bi={indexedDB:null,IDBKeyRange:null}}function Ra(n){var r,u=!1,m=new Gu(function(x){var T=j(n),D,U=!1,Y={},X={},et={get closed(){return U},unsubscribe:function(){U||(U=!0,D&&D.abort(),H&&pn.storagemutated.unsubscribe(Q))}};x.start&&x.start(et);var H=!1,rt=function(){return ms(Z)},Q=function(tt){Ni(Y,tt),Ms(X,Y)&&rt()},Z=function(){var tt,nt,it;!U&&Bi.indexedDB&&(Y={},tt={},D&&D.abort(),D=new AbortController,it=(function(lt){var gt=Bn();try{T&&Kn();var yt=hn(n,lt);return yt=T?yt.finally(fn):yt}finally{gt&&Un()}})(nt={subscr:tt,signal:D.signal,requery:rt,querier:n,trans:null}),Promise.resolve(it).then(function(lt){u=!0,r=lt,U||nt.signal.aborted||(Y={},(function(gt){for(var yt in gt)if(b(gt,yt))return;return 1})(X=tt)||H||(pn(ar,Q),H=!0),ms(function(){return!U&&x.next&&x.next(lt)}))},function(lt){u=!1,["DatabaseClosedError","AbortError"].includes(lt==null?void 0:lt.name)||U||ms(function(){U||x.error&&x.error(lt)})}))};return setTimeout(rt,0),et});return m.hasValue=function(){return u},m.getValue=function(){return r},m}var On=$e;function Ks(n){var r=mn;try{mn=!0,pn.storagemutated.fire(n),Ns(n,!0)}finally{mn=r}}_(On,s(s({},Dt),{delete:function(n){return new On(n,{addons:[]}).delete()},exists:function(n){return new On(n,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return r=On.dependencies,u=r.indexedDB,r=r.IDBKeyRange,(Rs(u)?Promise.resolve(u.databases()).then(function(m){return m.map(function(x){return x.name}).filter(function(x){return x!==xi})}):As(u,r).toCollection().primaryKeys()).then(n)}catch{return ue(new ht.MissingAPI)}var r,u},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return Ft.trans?En(Ft.transless,n):n()},vip:ks,async:function(n){return function(){try{var r=Ds(n.apply(this,arguments));return r&&typeof r.then=="function"?r:Mt.resolve(r)}catch(u){return ue(u)}}},spawn:function(n,r,u){try{var m=Ds(n.apply(u,r||[]));return m&&typeof m.then=="function"?m:Mt.resolve(m)}catch(x){return ue(x)}},currentTransaction:{get:function(){return Ft.trans||null}},waitFor:function(n,r){return r=Mt.resolve(typeof n=="function"?On.ignoreTransaction(n):n).timeout(r||6e4),Ft.trans?Ft.trans.waitFor(r):r},Promise:Mt,debug:{get:function(){return mt},set:function(n){kt(n)}},derive:S,extend:h,props:_,override:f,Events:ir,on:pn,liveQuery:Ra,extendObservabilitySet:Ni,getByKeyPath:I,setByKeyPath:q,delByKeyPath:function(n,r){typeof r=="string"?q(n,r,void 0):"length"in r&&[].map.call(r,function(u){q(n,u,void 0)})},shallowClone:A,deepClone:W,getObjectDiff:Ls,cmp:Qt,asap:P,minKey:-1/0,addons:[],connections:jn,errnames:B,dependencies:Bi,cache:kn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(n){return parseInt(n)}).reduce(function(n,r,u){return n+r/Math.pow(10,2*u)})})),On.maxKey=lr(On.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(pn(ar,function(n){mn||(n=new CustomEvent(ws,{detail:n}),mn=!0,dispatchEvent(n),mn=!1)}),addEventListener(ws,function(n){n=n.detail,mn||Ks(n)}));var Wn,mn=!1,ka=function(){};return typeof BroadcastChannel<"u"&&((ka=function(){(Wn=new BroadcastChannel(ws)).onmessage=function(n){return n.data&&Ks(n.data)}})(),typeof Wn.unref=="function"&&Wn.unref(),pn(ar,function(n){mn||Wn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!$e.disableBfCache&&n.persisted){mt&&console.debug("Dexie: handling persisted pagehide"),Wn!=null&&Wn.close();for(var r=0,u=jn;r<u.length;r++)u[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!$e.disableBfCache&&n.persisted&&(mt&&console.debug("Dexie: handling persisted pageshow"),ka(),Ks({all:new we(-1/0,[[]])}))})),Mt.rejectionMapper=function(n,r){return!n||n instanceof $||n instanceof TypeError||n instanceof SyntaxError||!n.name||!At[n.name]?n:(r=new At[n.name](r||n.message,n),"stack"in n&&v(r,"stack",{get:function(){return this.inner.stack}}),r)},kt(mt),s($e,Object.freeze({__proto__:null,Dexie:$e,liveQuery:Ra,Entity:ia,cmp:Qt,PropModification:rr,replacePrefix:function(n,r){return new rr({replacePrefix:[n,r]})},add:function(n){return new rr({add:n})},remove:function(n){return new rr({remove:n})},default:$e,RangeSet:we,mergeRanges:hr,rangesOverlap:_a}),{default:$e}),$e})})(Yi)),Yi.exports}var r0=n0();const xo=au(r0),cc=Symbol.for("Dexie"),es=globalThis[cc]||(globalThis[cc]=xo);if(xo.semVer!==es.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${xo.semVer} and ${es.semVer}`);const{liveQuery:T0,mergeRanges:E0,rangesOverlap:A0,RangeSet:R0,cmp:k0,Entity:O0,PropModification:M0,replacePrefix:F0,add:I0,remove:N0,DexieYProvider:D0}=es,vn=new es("ImageMetaDatabase");vn.version(1).stores({image_metas:"imageId, url, labelMeta"});const i0=Lh({name:"ImageLabeling",setup(){const t=be(),e=be(),i=be(!1),s=be(),a=be("MoveImage"),o=be([]),c=be(4),l=be(6),h=be(),g=be(),d=be(0),b=be(null),_=be(),p=be([]),v=be([{id:"tagid-1",name:"",color:ge.Util.getRandomColor()},{id:"tagid-2",name:"",color:ge.Util.getRandomColor()},{id:"tagid-3",name:"",color:ge.Util.getRandomColor()}]),S=be([{imageId:"ddadfe6d-0a4c-487d-a1b6-e7b0675626db",url:"https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg"},{imageId:"563e9543-74f6-4e32-a8ef-825601a29617",url:"https://images.pexels.com/photos/31173342/pexels-photo-31173342.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b86c",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b866",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b865",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b864",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b863",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b862",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"},{imageId:"8b5304a0-297d-45e1-a9b7-26e2ebd7b861",url:"https://images.pexels.com/photos/31308278/pexels-photo-31308278.jpeg"}]),E=be([{color:"unset",name:"",value:"Rect"},{color:"unset",name:"",value:"Polygon"},{color:"unset",name:"",value:"MoveImage"},{color:"unset",name:"",value:"ZoomInImage"},{color:"unset",name:"",value:"ResetImageSize"},{color:"unset",name:"",value:"ZoomOutImage"},{color:"unset",name:"",value:"PrevImage",clickfn:async()=>{var K,W,J;if(d.value>0){S.value[d.value]?vn.image_metas.put({imageId:S.value[d.value].imageId,url:S.value[d.value].url,labelMeta:(K=t.value)==null?void 0:K.toJSON()}):vn.image_metas.add({imageId:S.value[d.value].imageId,url:S.value[d.value].url,labelMeta:(W=t.value)==null?void 0:W.toJSON()}),(J=y())==null||J.getChildren(R=>!(R instanceof ge.Image)).forEach(R=>{R.destroy()}),d.value--;const ft=S.value[d.value],C=await vn.image_metas.get(ft.imageId);C&&C.labelMeta&&(t.value=ge.Node.create(C.labelMeta,"container"),k());var M=new Image;M.src=S.value[d.value].url,M.onload=function(){var R=f();R.image(M),t.value.draw()}}}},{color:"unset",name:"",value:"NextImage",clickfn:async()=>{var K,W,J;if(d.value<S.value.length-1){const z=S.value[d.value],ft=await vn.image_metas.get(z.imageId);console.log(ft),ft?await vn.image_metas.put({imageId:S.value[d.value].imageId,url:S.value[d.value].url,labelMeta:(K=t.value)==null?void 0:K.toJSON()}):await vn.image_metas.add({imageId:S.value[d.value].imageId,url:S.value[d.value].url,labelMeta:(W=t.value)==null?void 0:W.toJSON()}),(J=y())==null||J.getChildren(G=>!(G instanceof ge.Image)).forEach(G=>{G.destroy()}),d.value++;const C=S.value[d.value],R=await vn.image_metas.get(C.imageId);R&&R.labelMeta&&(t.value=ge.Node.create(R.labelMeta,"container"),k());var M=new Image;M.src=S.value[d.value].url,M.onload=function(){var G=f();G.image(M),t.value.draw()}}}}]),O=(M,K,W,J,z=3)=>Math.sqrt(Math.pow(W-M,2)+Math.pow(J-K,2))<z,y=()=>{var M;return(M=t.value)==null?void 0:M.findOne("#labelImageGroup")},f=()=>{var M;return(M=t.value)==null?void 0:M.findOne("#labelImage")},w=()=>{var M;return(M=t.value)==null?void 0:M.findOne("#polygonGroup")},P=()=>v.value.find(M=>M.id==_.value)||void 0,I=M=>v.value.find(K=>K.id==M),q=M=>{const{r:K,g:W,b:J}=ge.Util.getRGB(M);return`rgba(${K},${W},${J}, 0.3)`},A=()=>new ge.Group({id:"labelImageGroup",draggable:!1}),k=()=>{t.value.on("mousedown",()=>{var K,W,J;if(console.log(1),a.value=="Rect"){if(i.value=!0,!_.value)return alert(""),!1;const z=(K=t.value)==null?void 0:K.getPointerPosition();var M=(W=f())==null?void 0:W.getClientRect();if(z&&M){const ft=new Date().getTime(),C=new ge.Rect({id:ft+"",name:"rect",x:z.x-M.x,y:z.y-M.y,width:0,height:0,fill:"rgba(0, 100, 255, 0.5)",stroke:"red",strokeScaleEnabled:!1,strokeWidth:1,dash:[5,5],dashEnabled:!0,draggable:!1});s.value=C,(J=y())==null||J.add(s.value)}}}),t.value.on("mousemove",()=>{var K,W,J,z,ft,C;if(a.value=="Rect"){if(!i.value)return;t.value.container().style.cursor="crosshair";const R=(K=t.value)==null?void 0:K.getPointerPosition();var M=(W=f())==null?void 0:W.getClientRect();R&&s.value&&M&&(s.value.setAttrs({width:R.x-M.x-s.value.x(),height:R.y-M.y-s.value.y()}),(J=t.value)==null||J.batchDraw())}if(a.value=="Polygon"){t.value.container().style.cursor="default";const R=(z=t.value)==null?void 0:z.getPointerPosition();var M=(ft=f())==null?void 0:ft.getClientRect();if(R&&h.value&&M&&g.value){const L=R.x-M.x,j=R.y-M.y;O(L,j,(C=g.value)==null?void 0:C.x(),g.value.y())?g.value.radius(l.value):g.value.radius(c.value)}}a.value=="MoveImage"&&(t.value.container().style.cursor="move")}),t.value.on("mouseup",()=>{var M,K,W;if(a.value=="Rect"&&(i.value=!1,s.value&&_.value)){t.value.container().style.cursor="default";const J=s.value.x(),z=s.value.y(),ft=s.value.width(),C=s.value.height();if(Math.abs(ft)<5||Math.abs(C)<5){s.value.destroy(),s.value=void 0,(M=e.value)==null||M.batchDraw();return}p.value.push({labelId:s.value.id()+"",imageId:S.value[d.value].imageId,tagId:_.value,type:"RECT"});const R=((K=P())==null?void 0:K.color)||"#000";s.value.setAttrs({dashEnabled:!1,stroke:R,fill:q(R)}),[[J,z],[J+ft,z],[J,z+C],[J+ft,z+C]].forEach(L=>{var j,ct;(ct=y())==null||ct.add(new ge.Circle({name:`dot${(j=s.value)==null?void 0:j.id()}`,x:L[0],y:L[1],radius:c.value,fill:"#fff",stroke:"red",visible:!1,draggable:!1}))}),(W=t.value)==null||W.batchDraw()}}),t.value.on("click",()=>{var W,J,z,ft,C,R,G,L,j;const M=(W=t.value)==null?void 0:W.getPointerPosition(),K=(J=f())==null?void 0:J.getClientRect();if(M&&a.value=="Polygon"&&K){if(!_.value)return alert(""),!1;const ct=M.x-K.x,$=M.y-K.y;if(o.value.push(ct,$),h.value&&w()&&g.value){if(O(ct,$,(z=g.value)==null?void 0:z.x(),g.value.y())){p.value.push({labelId:h.value.id()+"",imageId:S.value[d.value].imageId,tagId:_.value,type:"Polygon"}),(ft=w())==null||ft.getChildren(St=>St instanceof ge.Circle).forEach(St=>{St.setAttrs({visible:!1})}),g.value.setAttrs({visible:!1,radius:c.value}),o.value.push(o.value[0],o.value[1]),h.value.points([...o.value]),h.value.closed(!0);const vt=((C=P())==null?void 0:C.color)||"#000";h.value.setAttrs({stroke:vt,fill:q(vt)}),h.value=void 0,o.value=[];return}(R=w())==null||R.add(new ge.Circle({name:`dot${h.value.id()}`,x:ct,y:$,radius:c.value,fill:"#fff",stroke:"red",strokeWidth:1,visible:!0})),h.value.points([...o.value]),(G=e.value)==null||G.batchDraw()}else{const vt=new Date().getTime();g.value=new ge.Circle({name:`dot${vt}`,x:ct,y:$,radius:c.value,fill:"#fff",stroke:"red",strokeWidth:1,visible:!0});const St=new ge.Line({id:vt+"",points:[...o.value],fill:"rgba(0, 0, 255, 0.5)",stroke:"red",strokeWidth:2,closed:!1});h.value=St;const ot=new ge.Group({draggable:!1,id:"polygonGroup"});ot.add(g.value),ot.add(h.value),(L=y())==null||L.add(ot),(j=t.value)==null||j.batchDraw()}}})},F=M=>{var K;(K=t.value)==null||K.find(`.dot${M.labelId}`).forEach(W=>{console.log(W),W.visible(!W.visible())})};return Gc(()=>{var J,z,ft;const M=localStorage.getItem("imgaejson");if(M){const C=JSON.parse(M);t.value=ge.Node.create(JSON.parse(M),"container"),(J=t.value)==null||J.width(800),(z=t.value)==null||z.height(800);var K=C.imageUrl,W=new Image;W.src=K,W.onload=function(){var R=f();R.image(W),t.value.draw()},console.log(M)}else{t.value=new ge.Stage({container:"container",width:800,height:800}),e.value=new ge.Layer({}),(ft=t.value)==null||ft.add(e.value),e.value.add(A());const C=new Image;C.src=S.value[d.value].url,C.onload=()=>{var G,L;const R=new ge.Image({id:"labelImage",image:C,width:C.width,height:C.height,draggable:!1});(G=y())==null||G.add(R),(L=y())==null||L.setAttrs({width:C.width,height:C.height})}}k()}),Ko(()=>{var M;(M=t.value)==null||M.destroy()}),lf(()=>{var M,K;if((M=t.value)!=null&&M.container()&&(t.value.container().style.cursor="default"),(K=y())==null||K.setDraggable(a.value=="MoveImage"),E.value.forEach(W=>W.color=W.value==a.value?"red":"unset"),b.value){const W=b.value;W.scrollTop=d.value*100}}),()=>pe("div",{style:{display:"flex"}},[pe("div",{ref:b,style:{marginRight:"20px",minWidth:"220px",display:"flex",flexDirection:"column",gap:"10px",maxHeight:"800px",overflow:"auto",marginTop:"26px",scrollMargin:"20px",scrollBehavior:"smooth"}},[S.value.length&&S.value.map(M=>pe("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},[pe("img",{src:M.url,width:150,height:150,alt:"",style:{border:`${M.imageId===S.value[d.value].imageId?"3px dashed red":"None"}`}},null)]))]),pe("div",null,[pe("div",null,[E.value.length&&E.value.map(M=>pe("button",{style:{cursor:"pointer",border:`${M.color!=="unset"?"2px dashed red":""}`},onClick:()=>typeof M.clickfn=="function"?M.clickfn():a.value=M.value},[M.name])),pe("div",{id:"container",ref:"stageRef",style:{backgroundColor:"transparent",border:"1px dashed black",width:"800px",height:"800px"}},null)]),pe("div",null,[v.value.length&&v.value.map(M=>pe("button",{style:{border:`2px dashed ${M.color}`,borderLeftWidth:"4px",cursor:"pointer",backgroundColor:`${_.value==M.id?M.color:""}`},onClick:()=>_.value=M.id},[M.name]))])]),pe("div",{style:{marginTop:"26px",marginLeft:"20px",display:"flex",flexDirection:"column"}},[p.value.length>0&&p.value.map(M=>{var K;return pe("div",null,[pe("button",{style:{borderColor:"none",backgroundColor:`${q(((K=I(M.tagId))==null?void 0:K.color)||"#000")}`},onClick:()=>F(M)},[M.type,ru(" "),M.labelId])])})])])}});hd(i0).mount("#app");
